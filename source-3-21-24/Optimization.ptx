<chapter xmlns:xi="http://www.w3.org/2001/XInclude"  xml:id="CHAPTERwhat-deriv-tells">
 <title>Optimization: Going to Extremes</title>

<section xml:id="SECTIONintroduction">
<title>Introduction</title>

<p>
While it would not be correct to say that Calculus was invented solely
to solve optimization problems, it's pretty close\aside{Once it was
  invented, of course, Calculus turned out to be a very useful tool
  for lots of other problems as well.}. Recall that one of the
fundamental tenets of modern science is that nature is lazy. Light
follows the fastest (minimal) path between two points. Soap bubbles
are spherical because that is the shape that encloses the most
(maximal) volume for a given surface area. Alternatively, a soap
bubble uses the least (minimal) surface area to enclose a particular
volume\aside{Actually, a physicist would say that soap bubbles are
  spherical because that is the shape the minimizes the potential
  energy contained in the soap film. It all comes to the same
  end. Something must be optimized.}. Nature optimizes.
</p>

<p>
Mathematically speaking all optimization starts in the same place: We
have some quantity (revenue, tax liability, temperature, resource
consumption, travel time, potential energy, volume, surface area,
whatever), which depends on one or more variables. The variables are
(usually) constrained in some way, and we need to find conditions that
make the quantity as large, or as small as possible within those
constraints.  The <q>thing to be optimized</q> is called the
<term>objective function</term> and the constraints on the variables are
called .\ .\ .\ well, they're called the <term>constraints</term>.
</p>

<p>
When we looked at Fermat's Method of Adequality in
<xref ref="SECTIONFermMethAedeq">Section</xref> we observed that if <m>f(x)</m> is a
(continuous) function then near an optimal point <m>f(x+h)\approx f(x)</m>
as long as <m>h</m> is not too big.  Loosely speaking, this says that near
an extremum the graph of the function is practically horizontal. More
formally we have:
</p>

<theorem xml:id="THEOREMFermatsTheorem">
<title>Fermat's Theorem</title>
<p>
  If a function, <m>f(x)</m>, is differentiable at <m>x=a</m> and
  <m>f(a)</m> is either a maximum or a minimum then
  <m>\eval{\dfdx{f}{x}}{x}{a}=0</m>.
</p>
</theorem>

<p>
In view of Fermat's Theorem it appears that a likely strategy for
attacking optimization problems is to find an expression, say <m>f(x)</m>,
for the objective function and then solve the equation
<m>\dfdx{f}{x} = 0</m>. In fact, this is precisely the strategy we used in
<xref ref="SECTIONrates-change">Section</xref> to find the maximal height attained by
a tossed ball. If we toss a ball upward we know that it will reach a
maximal height.  At the top of its flight, when the ball transitions
from upward movement to downward movement, there is a moment when its
velocity is zero. Thus we saw that if <m>p(t)</m> is a formula that gives
the height of the ball at any time, setting <m> \dfdx{p}{t}=0</m> and
solving for <m>t</m> will yield the time when the ball is at the top of its
flight.
</p>

<exercise>
<statement>
<p>
  Suppose a ball is tossed vertically from the surface of the earth
  with an initial velocity of <m>20
  \frac{\text{meters}}{\text{sec}}</m>. Show that the ball reaches its
  maximum
  height when <m>t=\frac{20}{9.8}\approx 2</m> seconds.
</p>
</statement>
<hint>
<p>
You may want to review
    <xref ref="PROBLEMGeneralFallingBalls">Problem~\</xref>.
</p>
</hint>

</exercise>

<p>
At their simplest, optimization problems really are just that
straightforward. But <q>straightforward</q> does not necessarily mean
easy. There are several nuances that, if not clearly understood, can
cause much confusion and difficulty. We will proceed carefully.
</p>

<p>
To begin, take careful note of what Fermat's Theorem says and, just as
important, what it does not say: It says that if <m>(a, f(a))</m> is a
point on the graph of a differentiable function <m>f(x)</m>, and if <m>f(a)</m>
is known to be an extremum (either a maximum or a minimum) then
<m>\eval{\dfdx{f}{x}}{x}{a}=0</m>.
</p>

<p>
Fermat's Theorem does not say that if <m>\eval{\dfdx{f}{x}}{x}{a}=0</m>
then <m>f(a)</m> must be an extremum. In fact, that is not necessarily
true.  For example, if <m>f(x)=x^3</m> then <m>\eval{\dfdx{f}{x}}{x}{0}=0</m>
but the graph has neither a maximum or a minimum at <m>(0, f(0))</m>.
Confirm this by graphing it.
</p>

<p>
We have a lifetime of experience with tossed balls telling us
that a tossed ball will reach a maximum height.  Fermat's Theorem tells us
that whenever that maximum height is attained, <m>\dfdx{p}{t}</m> will be
zero. So all we had to do for this problem is find the one and only
time when <m>\dfdx{p}{t}=0</m>. This is the time when the maximum height is
reached.
But suppose after the ball is released there are forces other than gravity  involved.  Suppose,
for example, that our tossed ball is being buffeted by the wind on a
blustery day is such a way that the height of the ball is given by
<me>
p(t)=(t-1)^4+(t-1)^3+5.
</me>
We  have no experience, hence no intuition, with a ball moving in
this fashion so we have no way to decide if there even is a maximum,
let alone what it might be.  We also have no tools to help us find the
maximum height of the ball if it does exist.  Fermat's Theorem doesn't help because it
tells us what happens at an extremum <m>\left(\dfdx{p}{t}=0\right)</m>, not
how to find it.  In this chapter we will build up some tools to help
us find extrema.
</p>

<exercise xml:id="DRILLNonTrivialMaxExample">
<introduction>
<p>
  Let <m> p(t)=(t-1)^4+(t-1)^3+5.</m>
</p>
</introduction>
<task>
<statement>
<p>
 Show that <m>\dfdx{p}{t}=0</m> when <m>t=1</m> and when <m>t=\frac14</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Graph <m>p(t)</m>. Does it have a maximum? Explain.
  </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
<!--   <!-\- \label{drill:NonTrivialMaxExample} -\-> -->
<!--   Let $ p(t)=(t-1)^4+(t-1)^3+5.$ -->
<!--   \begin{enumerate}[label={  (\alph*)}]  -->
<!--   \item Show that $\dfdx{p}{t}=0$ when $t=1$ and when $t=\frac14$. -->
<!--   \item Graph $p(t)$. Does it have a maximum? Explain. -->
<!--   \end{enumerate} -->
<!-- \end{ProficiencyDrill} -->


</section>
<section xml:id="SECTIONfive-simil-probl">
<title>Preliminaries: Some Simple Optimizations</title>

<p>
To begin we will consider problems that will allow us to use our
intuition. Our goal is to build a set of tools. By the end of this
chapter we will be able to rely more on the tools of Calculus and less
on intuition to solve a wide variety of optimization problems. This
does not mean that you should stop using your intuition, only that you
will have a set of tools that will allow you to either confirm your
instincts, or refute them.
</p>

<p>
Many of the examples in this section can be solved by more elementary
methods than Calculus. If you can see a more fundamental way to solve
these problems and examples, that's great!  Do that. But keep the goal
in mind. We're interested in these examples as a means to elucidate
the subtleties inherent in optimization problems. These problems are a
means to that end, not an end in themselves.
</p>


<example xml:id="EXAMPLESqOnLine">
<title>Constructing A Square on a Line</title>
<p>
  What is the area of the smallest possible square having one corner
  at the point <m>(2,3)</m> and an adjacent corner on the line
  <me>
    5x+3y=2.\label{eq:SqOptConst}
</me>
</p>
  <figure>
<caption>
<url href="https://echengphoto.com/" visual="https://echengphoto.com/">This figure needs a caption.</url>
</caption>
<image source="images/LineDist1.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[]{r}{1.7in} -->
<!--     \captionsetup{labelformat=empty} -->
<!--     \centerline{\includegraphics*[height=1.6in,width=1.7in]{../Figures/LineDist1}} -->
<!--     \label{fig:LineDist1} -->
<!--   \end{wrapfigure} -->
<p>

  The diagram at the right is a visualization of this problem. We can
  imagine the blue square growing and shrinking as we move the point
  <m>(a,b)</m> along the line. It seems clear that the square having the least
  area is the one pictured in black (when <m>(a,b)</m> is at <m>(x,y)</m>. It is
  worth taking a moment to notice this explicitly because not all
  optimization problems are solvable. If we had asked for the largest
  possible square there would be no solution because the blue square
  in our diagram can always be make larger by moving the point <m>(a,b)</m>
  further to the left on the graph of <xref ref="EQSqOptConst">Equation~</xref>).
</p>
<p>

  But a convincing picture is not a solution. To complete the solution
  we'll need to compute the coordinates of the point <m>(x,y)</m> in our
  sketch and compute the minimal area.
</p>
<p>
  
  In any optimization problem the first question to ask is, <q>What do
  we need to optimize?</q> In other words, <q>What is our objective
  function?</q>  For this problem the length of the line segment between
  the point <m>(2,3)</m> and any point <m>(x,y)</m> is given by the
  Distance Formula: <m>\sqrt{(x-2)^2+(y-3)^2}</m>.  Therefore the area of
  the square constructed from this line segment is given by the
  function:
  <me>
  A(x)=\left(\sqrt{(x-2)^2+(y-3)^2}\right)^2=(x-2)^2+(y-3)^2.
  </me>
  So our objective function is <m>A(x)</m>.
  Since the point <m>(x,y)</m> is constrained to lie on the line
  <m> 5x+3y=2</m>, <xref ref="EQSqOptConst">Equation~</xref>), is our constraint.
</p>
<p>

  Notice that we've abused our notation a bit. Although the notation
  <m>A(x)</m> indicates that <m>A</m> depends on <m>x</m> alone, we've given <m>A</m> in
  terms of both <m>x</m> and <m>y</m>. But solving
  <xref ref="EQSqOptConst">Equation~</xref>) gives\aside{If we make this
    substitution immediately we can get the objective function solely
    in terms of <m>x</m>: <m>A(x)=(x-2)^2+\left(\frac13(2-5x)-3\right)^2</m>,
    But does that really help? Either way we're going to have to
    differentiate <m>A(x)</m>. Which form of <m>A(x)</m> would you rather use?
    We think using two variables makes this objective function a bit
    <q>easier on the eyes.</q>  } <m>y=\frac13(2-5x)</m> so it should be clear
  that <m>A</m> really depends only on <m>x</m>.
</p>
<p>
  
  We've seen visually that this problem has a solution and Fermat's
  Theorem tells us that the derivative of our objective function will
  be zero at that solution.  So we differentiate both sides of
  \begin{align*}
    A\amp =(x-2)^2+(y-3)^2\\
    \intertext{which gives}
    \dx{A}\amp =2(x-2)\dx{x} + 2(y-3)\textcolor{red}{\dx{y}}.
    \intertext{
    But recall that <m>x</m> and <m>y</m> are constrained by the
    <xref ref="EQSqOptConst">Equation~</xref>) from which we see that
    <m>\textcolor{red}{\dx{y}= -\frac{5}{3}\dx{x}}</m>.  Therefore
    }
    \dx{A}\amp = 2(x-2)\dx{x} +
    2(y-3)\left(\textcolor{red}{-\frac{5}{3}\dx{x}}\right)\\
    \amp = \left[2(x-2) +
    2(y-3)\left(-\frac{5}{3}\right)\right]\dx{x}\\
    \intertext{or}
    \dfdx{A}{x} \amp = 2(x-2) +
    2(y-3)\left(-\frac{5}{3}\right).
  \end{align*}
  Setting <m>\dfdx{A}{x}</m> equal to zero we have
  \begin{align}
    \nonumber    \textcolor{red}{2}(x-2) + \textcolor{red}{2}(y-3)\left(-\frac{5}{3}\right) \amp = 0.\\
    \nonumber    (x-2) + (y-3)\left(-\frac{5}{3}\right) \amp = 0.\\
    \nonumber    x-2-\frac53y+5\amp =0.\\
    \label{eq:LineDist1}    x+3-\frac53\textcolor{red}{y}\amp =0.\\
    \intertext{From our constraint we have
    <m>\textcolor{red}{y=\frac13(2-5x)}</m>. Inserting this into
    <xref ref="EQLineDist1">Equation~</xref>) we see that}
    \nonumber
    x+3-\frac53\left(\textcolor{red}{\frac13(2-5x)}\right)\amp =0.\\
    \intertext{Solving for <m>x</m> gives}
    \nonumber    x+3-\frac53\left(\frac23-\frac{5}{3}x)\right)\amp =0,\\
    \nonumber    x+3-\frac{10}{9}+\frac{25}{9}x\amp =0,\\
    \nonumber    \frac{9x+27-10+25x}{9}\amp =0,\\
    \nonumber    \frac{34x+17}{9}\amp =0,\\
    \nonumber    34x\amp =-17\\
    \label{eq:LineDist2}    x\amp =-\frac12.
  \end{align}
</p>
<p>
  
  To find <m>y</m> we use our constraint and the value of <m>x</m> from
  <xref ref="EQLineDist2">Equation~</xref>,
  <me> \bigeval{y}{x}{-1/2}=\bigeval{\frac13(2-5x)}{x}{-1/2}=\frac32.</me>
</p>
<p>

  So we have found that the minimal square occurs when <m>x=-\frac12</m>,
  and <m>y=\frac32</m> and it feels like we're done, doesn't it? We're not.
  The question asked was <q>What is the area of the smallest possible
  square?</q> To find the area we need to put <m>(x,y)=(-1/2, 3/2)</m> into
  our area formula which yields
  \begin{align*}
    \bigeval{A(x,y)}
    {(x,y)}
    {\left(-\frac12, \frac32\right)}
    \amp =\bigeval{(x-2)^2+(y-3)^2}
    {(x,y)}
    {\left(-\frac{1}{2},\frac32\right)}\\
    \amp =\left(-\frac12-2\right)^2+\left(\frac12-3\right)^2=\frac{17}{2}\text{ square units.}
  \end{align*}
  Always remember to check that you have actually answered the
  question asked before you stop.
</p>
</example>


  <problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Do you see that the point <m>(x,y)</m> which minimizes the area
      of our square also minimizes the length of the line segment from
      <m>(2,3)</m> to <m>(x,y)</m>? What objective function would we get if we
      tried to minimize the length of the segment instead of the area
      of the square. Does this change the problem? If so, how?
    </p>
</statement>
</task>
<task>
<statement>
<p>
 This example specified that <m>(2,3)</m> and <m>(x,y)</m> were
      adjacent corners of the square. What would the objective
      function look like if those points were diagonally opposite each
      other.  Does this change the problem? If so, how?
    </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate} -->
  <!--   \begin{enumerate}[label={  (\alph*)}] -->
  <!--   \item Do you see that the point <m>(x,y)</m> which minimizes the area -->
  <!--     of our square also minimizes the length of the line segment from -->
  <!--     <m>(2,3)</m> to <m>(x,y)</m>? What objective function would we get if we -->
  <!--     tried to minimize the length of the segment instead of the area -->
  <!--     of the square. Does this change the problem? If so, how? -->
  <!--   \item This example specified that <m>(2,3)</m> and <m>(x,y)</m> were -->
  <!--     adjacent corners of the square. What would the objective -->
  <!--     function look like if those points were diagonally opposite each -->
  <!--     other.  Does this change the problem? If so, how? -->
  <!--   \end{enumerate} -->
  <!-- \end{embeddedproblem-enumerate} -->

  
  <problem xml:id="PROBLEMMinSqLine">
<introduction>
<p>
    It seems fairly intuitively clear that the minimal square occurs
    when the line through <m>(2,3)</m> is orthogonal\aside{<q>Orthogonal</q>
      is the word mathematicians use when everyone else would say
      <q>perpendicular.</q> The reasons for this are abstruse.}  to the
    graph of the line <m>5x+3y=2</m>.
</p>
</introduction>
<task>
<statement>
<p>
 Verify that our intuition is correct.
    </p>
</statement>
</task>
<task>
<statement>
<p>
 Does this remain true if the point on the line and <m>(2,3)</m>
      are not adjacent corners of the square?
    </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
  <!--   <!-\- \label{problem:MinSqLine} -\-> -->
  <!--   It seems fairly intuitively clear that the minimal square occurs -->
  <!--   when the line through <m>(2,3)</m> is orthogonal\aside{<q>Orthogonal</q> -->
  <!--     is the word mathematicians use when everyone else would say -->
  <!--     <q>perpendicular.</q> The reasons for this are abstruse.}  to the -->
  <!--   graph of the line <m>5x+3y=2</m>. -->
  <!--   \begin{enumerate}[label={  (\alph*)}] -->
  <!--   \item Verify that our intuition is correct. -->
  <!--   \item Does this remain true if the point on the line and <m>(2,3)</m> -->
  <!--     are not adjacent corners of the square? -->
  <!--   \end{enumerate} -->
  <!-- \end{embeddedproblem} -->

<p>
We have  a few general comments regarding <xref ref="EXAMPLESqOnLine">Example</xref><xref ref="EXAMPLESqOnLine">Example</xref> in no particular order.
<ul>
<li>
<p>
The first step in any optimization problem is to identify the
  objective function. Sometimes more than one will work. In that case
  use the simplest one, but without an objective function we can't
  even get started.
</p>
</li>
<li>
<p>
The first step in any optimization problem is to identify the
  objective function. Sometimes more than one will work. In that case
  use the simplest one, but without an objective function we can't
  even get started.
</p>
</li>
<li>
<p>
We need to identify constraint(s) as well, if any exist. (Not
  all optimization problems will have constraints. Some will have more
  than one.)  We may not need these immediately, but we will need them
  sooner or later.
</p>
</li>
<li>
<p>
It was intuitively clear from our sketch that there actually is
  a minimal square in this example; that a solution exists. This will
  be true often enough that it will be easy to start believing that
  you can rely on your intuition alone to solve optimization
  problems. This is a mistake.

  Intuition is important and we encourage you to use it, especially
  when you first start thinking about a new problem.  But intuition is
  based on past experience. It is a way of saying that you expect
  today to go pretty much the same way yesterday did. Most of the time
  this is true, but you never know when things will go awry so you
  must always verify that your intuition is correct by some other
  means\aside{Calculus, in this case.}.
</p>
</li>
<li>
<p>
Most of the heavy lifting in this problem was done in the
  Algebra, not the Calculus. This will be true of many of the
  mathematics problems you will encounter from now on.  There is a
  strong tendency to think of algebraic manipulations as <q>just
  algebra</q> and to be careless with them. This is also a
  mistake. Every step toward solving a problem is just as important as
  every other step, whether it is Algebra, Calculus, Geometry,
  Arithmetic, or just <q>thinking about the problem.</q>  Every step must
  be successfully completed. Strive to be skillful, and careful, with
  all of your tools.
</p>
</li>
<li>
<p>
We were very careful to write out, in detail, every algebraic
  and arithmetic step in this problem but if we were to do this for
  every problem this text would become too long to be useful. We don't
  want that to happen so we will regularly do several elementary
  algebraic steps at once.

  But <q>elementary</q> does not mean <q>easy.</q> You may not be able to
  follow all of the steps in your head, especially at first. When you
  do not see how to get from one line of computation to the next you
  may be tempted to just skip it. Don't. Do. That.  Keep a writing pad
  handy at all times. If there is any question of understanding a
  given computation take out that pad and do the computation
  yourself. If you are unable to do the computation yourself, ask for
  help. Ask a classmate, a friend, your instructor, whomever. Ask for
  help when you need it.  If you do this habitually you will find that
  following the steps gets easier over time. If you do not it will
  remain difficult forever. We're serious. Do all elementary
  computations yourself!  It is your responsibility to make sure you
  understand the computations we show you.
</p>
</li>
</ul>
</p>


<example xml:id="EXAMPLECircleDist">
<title>Constructing A Square on a Circle</title>
<p>
  We want to find the area of the largest and the smallest squares
  that can be constructed with one corner at the point <m>(2,3)</m> and an
  adjacent corner on the unit circle: <m> x^2+y^2=1</m>.
</p>
<p>

  The solution of this problem is very clear once it has been
  sketched. The purpose of <xref ref="DRILLIntuitiveSquareOnCircle"></xref>
  is for you to see the solution intuitively. We will solve it again
  analytically below.
</p>
</example>
  
<exercise xml:id="DRILLIntuitiveSquareOnCircle">
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Sketch the unit circle, plot the point <m>(2,3)</m>, and draw the
      smallest and largest squares you can which have one corner at
      the point <m>(2,3)</m> and an adjacent corner on the unit circle:
      <m> x^2+y^2=1</m>, Explain how you can tell from your sketch that
      that there is both a maximal (largest area) and a minimal
      (smallest area) square.
    </p>
</statement>
</task>
<task>
<statement>
<p>
 Explain how you can tell from your sketch, that the second
      corner of the maximal and minimal squares are at the
      intersection points of the line <m>y=\frac32x</m> and the unit
      circle.
                      </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that the areas of the maximal square is <m>A\approx 21.2</m>
      units and that the area of the minimal square is <m>A\approx6.8</m>
      units.
    </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill-enumerate} -->
  <!--   <!-\- \label{drill:IntuitiveSquareOnCircle} -\-> -->
  <!--   \begin{enumerate}[label={  (\alph*)}]  -->
  <!--   \item Sketch the unit circle, plot the point <m>(2,3)</m>, and draw the -->
  <!--     smallest and largest squares you can which have one corner at -->
  <!--     the point <m>(2,3)</m> and an adjacent corner on the unit circle: -->
  <!--     <m> x^2+y^2=1</m>, Explain how you can tell from your sketch that -->
  <!--     that there is both a maximal (largest area) and a minimal -->
  <!--     (smallest area) square. -->
  <!--   \item Explain how you can tell from your sketch, that the second -->
  <!--     corner of the maximal and minimal squares are at the -->
  <!--     intersection points of the line <m>y=\frac32x</m> and the unit -->
  <!--     circle. -->
  <!--                     \item Show that the areas of the maximal square is <m>A\approx 21.2</m> -->
  <!--     units and that the area of the minimal square is <m>A\approx6.8</m> -->
  <!--     units. -->
  <!--   \end{enumerate} -->
  <!-- \end{ProficiencyDrill-enumerate} -->


  <p>
  The solution in <xref ref="DRILLIntuitiveSquareOnCircle"></xref> relies
  heavily on the intuition gained from sketching the problem. As we
  have said many times you should use your intuition but not rely on
  it. To confirm our solution in
  <xref ref="DRILLIntuitiveSquareOnCircle"></xref> using Calculus tools we
  will start at the beginning and solve this problem again, relying as
  much as possible on our computations. Eventually, we would like to
  rely exclusively on our computations, but this is not quite possible
  yet.
</p>
<p>
  
  We have the same objective function as in
  <xref ref="EXAMPLESqOnLine">Example~\</xref>: <m>A(x)=(x-2)^2+(y-3)^2</m>.  So
  <me>
    \dx{A} = 2(x-2)\dx{x} + 2(y-3)\dx{y}\label{eq:ConstObj1}
</me>
  as before.  But this time our constraint is
  <me>
    \label{eq:SqCircleConstraint}
    x^2+y^2=1
</me>
  so <m>\textcolor{red}{\dx{y}=-\frac{x}{y}\dx{x}}</m>.  Plugging this into
  <xref ref="EQConstObj1">Equation~</xref>) we have
  \begin{align}
    \nonumber    \dx{A} \amp = 2(x-2)\dx{x} + 2(y-3)\textcolor{red}{\left(-\frac{x}{y}\right)\dx{x}}\\
    \label{eq:SqCircdAdx}    \dfdx{A}{x}\amp = 2\left(-2+\frac{3x}{y}\right)
  \end{align}
</p>
<p>

  In order to use Fermat's Theorem we must first know that one maximum
  and one minimum exists. No computation we've done guarantees the
  existence of an extremum, let alone its location. However, as a
  result of the work you did to solve
  <xref ref="DRILLIntuitiveSquareOnCircle"></xref> we do know, intuitively,
  that there are two optimal solutions: one maximal and one
  minimal. Therefore Fermat's Theorem does guarantee that at each of
  these (wherever they are) <m>\dfdx{A}{x}=0</m>.
</p>
<p>

  We proceed as just discussed. Since we know (from
  <xref ref="DRILLIntuitiveSquareOnCircle"></xref>) that both a maximal and
  a minimal solution exist we set
  <m> \dfdx{A}{x}= 2\left(-2+\frac{3x}{y}\right)=0</m>. Solving this yields
  <me>
    \label{eq:3x=2y}
    3x=2y,
</me>
  and since (from our constraint,
  <xref ref="EQSqCircleConstraint">Equation~</xref>)) <m>y=\pm\sqrt{1-x^2}</m> we have
  <me>
    3x=\pm2\sqrt{1-x^2}.\label{eq:Sqrt}
</me>
  The square root symbol, and the plus-or-minus (<m>\pm</m>) make
  <xref ref="EQSqrt">Equation~</xref>) seem a little scary at first but it is
  really just a quadratic equation in disguise. Squaring both sides of
  <xref ref="EQSqrt">Equation~</xref>) gives <m> 9x^2=4(1-x^2)</m> or
  <me>
    \label{eq:LostSolution}   13x^2=4.
</me>
</p>
<p>

  So we have two solutions: <m>x=\frac{2}{\sqrt{13}}</m> and
  <m>x=-\frac{2}{\sqrt{13}}</m>.  From
  <xref ref="DRILLIntuitiveSquareOnCircle"></xref> we know that these must
  correspond to the maximal and minimal solutions. Fermat's Theorem
  doesn't tell us which is which but now all we need to do is
  distinguish between them by evaluating <m>A(x)</m> for each.
</p>

  <exercise xml:id="DRILLExtremalSquareCircle">
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Show that the area of the maximal square is approximately
      <m>21.2</m> units. Which value of <m>x</m> does this correspond to?
    </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that the area of the minimal square is approximately
      <m>6.8</m> units. Which value of <m>x</m> does this correspond to?
    </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill-enumerate} -->
  <!--   <!-\- \label{drill:ExtremalSquareCircle} -\-> -->
  <!--   \begin{enumerate}[label={  (\alph*)}]  -->
  <!--   \item Show that the area of the maximal square is approximately -->
  <!--     <m>21.2</m> units. Which value of <m>x</m> does this correspond to? -->
  <!--   \item Show that the area of the minimal square is approximately -->
  <!--     <m>6.8</m> units. Which value of <m>x</m> does this correspond to? -->
  <!--   \end{enumerate} -->
  <!-- \end{ProficiencyDrill-enumerate} -->

<p>
Since a circle is a special case of an ellipse the following problem
is a slight generalization of
<xref ref="DRILLIntuitiveSquareOnCircle"></xref>. But the algebra is a bit
trickier.
</p>


<problem xml:id="PROBLEMEllipseDist">
  <introduction>
    <p>
      There are two extremal squares with one corner at <m>(2,3)</m> and an
      adjacent corner on the ellipse:
      <me>
        x^2+\frac14y^2=2.
      </me>
      Find the area of each one of them.
      
      Steps (a) through (g) will guide you through the process. \\
      \hint{Not all of the problems in these steps are easily solved
      algebraically. Use Newton's Method or computational software as
      needed to find approximations.}
    </p>
  </introduction>
  <task>
    <statement>
      <p>
        Draw a sketch of this problem. Explain how you can tell from
        the sketch that there is one maximal, and one minimal square.
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        The objective function for this problem is, once again:
        <m> A(x) = (x-2)^2+(y-3)^2.  </m>
        
        What is the constraint?
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        Use the constraint to show that <m>\dx{y} = -\frac{4x}{y}\dx{x}</m>
        and that <m>y=\pm2\sqrt{2-x^2}</m>.
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        Show that <m>\dfdx{A}{x}=-6x-4+\frac{24x}{y}</m>.
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        Show that if we choose <m> y=2\sqrt{2-x^2}</m> then the only root
        of <m>\dfdx{A}{x}=0</m> is <m>x\approx0.86</m>.
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        Show that if we choose <m> y=-2\sqrt{2-x^2}</m> then the only root
        of <m>\dfdx{A}{x}=0</m> is <m>x\approx-0.28</m>.
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        Find (approximately) the area of the square associated with
        both of these points. Which one is the maximal and which is the
        minimal square?
      </p>
    </statement>
  </task>
</problem>
<!-- \begin{embeddedproblem}[Extremal Squares on an Ellipse] -->
<!--   <!-\- <!-\\- \label{problem:EllipseDist} -\\-> -\-> -->
<!--   There are two extremal squares with one corner at <m>(2,3)</m> and an -->
<!--   adjacent corner on the ellipse: -->
<!--   <me> -->
<!--   x^2+\frac14y^2=2. -->
<!--   </me> -->
<!--   Find the area of each one of them. -->

<!--   Steps (a) through (g) will guide you through the process. \\ -->
<!--   \hint{Not all of the problems in these steps are easily solved -->
<!--     algebraically. Use Newton's Method or computational software as -->
<!--     needed to find approximations.} -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Draw a sketch of this problem. Explain how you can tell from -->
<!--     the sketch that there is one maximal, and one minimal square. -->
<!--   \item The objective function for this problem is, once again: -->
<!--     <m> A(x) = (x-2)^2+(y-3)^2.  </m> -->

<!--     What is the constraint? -->
<!--   \item Use the constraint to show that <m>\dx{y} = -\frac{4x}{y}\dx{x}</m> -->
<!--     and that <m>y=\pm2\sqrt{2-x^2}</m>. -->
<!--   \item Show that <m>\dfdx{A}{x}=-6x-4+\frac{24x}{y}</m>. -->
<!--   \item Show that if we choose <m> y=2\sqrt{2-x^2}</m> then the only root -->
<!--     of <m>\dfdx{A}{x}=0</m> is <m>x\approx0.86</m>. -->
<!--   \item Show that if we choose <m> y=-2\sqrt{2-x^2}</m> then the only root -->
<!--     of <m>\dfdx{A}{x}=0</m> is <m>x\approx-0.28</m>. -->
<!--   \item Find (approximately) the area of the square associated with -->
<!--     both of these points. Which one is the maximal and which is the -->
<!--     minimal square? -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->



<problem xml:id="PROBLEMMaxOrth1">
<introduction>
<p>
  Here is a   sketch of the optimal squares in <xref ref="PROBLEMEllipseDist"></xref>.
  Notice that for both the maximal and the minimal square one of the
  sides appears to be orthogonal to (the line tangent to) the ellipse.
</p>
  <image source="images/EllipseWithSquares.png" width="60%" />
<!-- \centerline{\includegraphics*[height=2in,width=2.8in]{../Figures/EllipseWithSquares}} -->
</introduction>
<task>
<statement>
<p>
 Show that they actually are orthogonal.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 It is generally true that the shortest (or longest) line
    segment from a point <m>(a,b)</m> to a curve, <m>C</m>, will be orthogonal
    to the line tangent to the curve at their point of intersection.
    The figure below shows an arbitrary, differentiable curve,
    <m>C</m>, and an arbitrary point <m>(a,b)</m>.\\
    \centerline{\includegraphics*[height=1in,width=1.5in]{../Figures/MaxOrth1}}
    Suppose that the area of a square with one corner at <m>(a,b)</m> and
    an adjacent corner on the curve at <m>(x,y)</m> is optimal (minimal or
    maximal) at <m>(x_0, y_0)</m>. Show that the line joining <m>(a,b)</m> and
    <m>(x_0,y_0)</m> is orthogonal to the tangent line of <m>C</m> at
    <m>(x_0,y_0)</m> .

    Try to solve this problem completely on your own, but if you get
    stuck here is an outline you can follow:
    
    <ol>
    <li>
    <p>
    Find the objective function, <m>A(x)</m>. (This will be the area      of the square on the line from <m>(a,b)</m> to <m>(x,y)</m>.)
    </p>
    </li>
    <li>
    <p>
    Use the fact that <m>\geneval{\dfdx{A}{x}}{(x_0,y_0)}=0</m> to      find the slope of <m>C</m> at <m>(x_0,y_0)</m>.% That
    </p>
    </li>
    <li>
    <p>
    Find the slope of the line from <m>(a,b)</m> to <m>(x_0,y_0)</m>.
    </p>
    </li>
    <li>
    <p>
    Compare the two slopes.
    </p>
    </li>
    <li>
    <p>
    What happens if the tangent line is horizontal? If it is      vertical?
    </p>
    </li>
    </ol>

  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem}  ;;; MULTILEVEL PROBLEM -->
<!--   <!-\- <!-\\- <!-\\\- <!-\\\\- \label{problem:MaxOrth1} -\\\\-> -\\\-> -\\-> -\-> -->
<!--   Here is a   sketch of the optimal squares in <xref ref="PROBLEMproblem:EllipseDist"></xref>:\\ -->
<!--   \centerline{\centerline{\includegraphics*[height=2in,width=2.8in]{../Figures/EllipseWithSquares}}} -->
<!--   Notice that for both the maximal and the minimal square one of the -->
<!--   sides appears to be orthogonal to (the line tangent to) the ellipse. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Show that they actually are orthogonal. -->
<!--   \item It is generally true that the shortest (or longest) line -->
<!--     segment from a point <m>(a,b)</m> to a curve, <m>C</m>, will be orthogonal -->
<!--     to the line tangent to the curve at their point of intersection. -->
<!--     The figure below shows an arbitrary, differentiable curve, -->
<!--     <m>C</m>, and an arbitrary point <m>(a,b)</m>.\\ -->
<!--     \centerline{\includegraphics*[height=1in,width=1.5in]{../Figures/MaxOrth1}} -->
<!--     Suppose that the area of a square with one corner at <m>(a,b)</m> and -->
<!--     an adjacent corner on the curve at <m>(x,y)</m> is optimal (minimal or -->
<!--     maximal) at <m>(x_0, y_0)</m>. Show that the line joining <m>(a,b)</m> and -->
<!--     <m>(x_0,y_0)</m> is orthogonal to the tangent line of <m>C</m> at -->
<!--     <m>(x_0,y_0)</m> . -->

<!--     Try to solve this problem completely on your own, but if you get -->
<!--     stuck here is an outline you can follow: -->
    
<!--     <ol> -->
<!--     <li> -->
<!--     <p> -->
<!--     Find the objective function, <m>A(x)</m>. (This will be the area      of the square on the line from <m>(a,b)</m> to <m>(x,y)</m>.) -->
<!--     </p> -->
<!--     </li> -->
<!--     <li> -->
<!--     <p> -->
<!--     Use the fact that <m>\geneval{\dfdx{A}{x}}{(x_0,y_0)}=0</m> to      find the slope of <m>C</m> at <m>(x_0,y_0)</m>.% That -->
<!--     </p> -->
<!--     </li> -->
<!--     <li> -->
<!--     <p> -->
<!--     Find the slope of the line from <m>(a,b)</m> to <m>(x_0,y_0)</m>. -->
<!--     </p> -->
<!--     </li> -->
<!--     <li> -->
<!--     <p> -->
<!--     Compare the two slopes. -->
<!--     </p> -->
<!--     </li> -->
<!--     <li> -->
<!--     <p> -->
<!--     What happens if the tangent line is horizontal? If it is      vertical? -->
<!--     </p> -->
<!--     </li> -->
<!--     </ol> -->

<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->


<example xml:id="EXAMPLEDiffvsDer">
<title>Differentials vs. Derivatives</title>
<p>
 But take a moment to consider
  this. Is it clear to you that there must be such a maximal
  rectangle?  If so then, as before, setting the derivative of the
  objective function equal to zero and solving for the variable will
  provide all of the values of the variable where the maximal
  rectangle might occur. If we're lucky there will only be a
  few such and we can check them one at a time.
</p>
<p>

  Finding the objective function is easy. The area, <m>A</m>, of any
  rectangle is its length, <m>l</m>, times its width, <m>w</m>, so
  <me>
    A=lw\label{eq:SquareObjFun}
</me>
  is the objective function.
</p>
<p>

  The perimeter, <m>P</m> is
  <me>
    P=2l +2w\label{eq:SquareConst}
</me>
  and is constrained to be a constant (fixed) value so
  <xref ref="EQSquareConst">Equation~</xref>) is the constraint. Throughout this
  example keep in mind that <m>P</m> is a fixed constant, not a function of
  <m>l</m> and <m>w</m>.
</p>
<p>
  At this point we can complete the problem using Calculus in either
  of two equivalent ways.
  <dl>
    <li>
      <title>Using Differentials:</title>
      <p>
        In our opinion this is how Leibniz
        intended for his Calculus to be used so we tend to favor it.
        <ol>
          <li>
            <p>
              Compute <m>\dx{A} = l\dx{w}+w\dx{l}</m>, from the objective      function.
            </p>
          </li>
          <li>
            <p>
              Differentiate the constraint, giving the differential form      of the constraint: <m>2\dx{l}+2\dx{w}=0.</m>
            </p>
          </li>
          <li>
            <p>
              Set <m>\dx{A}=0</m> and solve this equation using the constraint      and its differential form as needed. In this problem we have      <m>\dx{l}=-\dx{w}</m> so
              <md>
                <mrow>

                  l\dx{w}+w\dx{l} \amp = 0\\
                </mrow>
                <mrow>

                  l\dx{w}-w\dx{w} \amp = 0\\
                  (l-w)\dx{w}\amp =0.

                </mrow>
              </md>

              Since <m>\dx{w}\neq0</m> we have <m>l=w</m> and thus the square encloses
              the most area.
            </p>
          </li>
        </ol>
      </p>
    </li>
    <li>
      <title>Using Derivatives:</title>
      <p>
        The modern approach emphasizes the use of
        functions and derivatives rather than curves and differentials.
        <ol>
          <li>
            <p>
              Solve the constraint for either <m>w</m> or <m>l</m> in terms of the      other. For example, <m>l=\frac12(P-2w).</m>
            </p>
          </li>
          <li>
            <p>
              Substitute this into the objective function to rewrite it in      terms of a single variable:      <me>A(w)=\frac12(P-2w)\cdot w = \frac12(Pw-w^2).</me>
            </p>
          </li>
          <li>
            <p>
              Now think of the objective function, <m>A(w)</m>, as an abstract      function and find its maximum point by setting <m>\dfdx{A}{w}=0</m>      and solving for <m>w</m>.
            </p>
            <p>
              Proceeding, we have
              <me>
              \dfdx{A}{w}=\dfdx {w}\left(\frac12(Pw-2w^2)\right)=\frac12(P-4w)=0
              </me>
              so <m>w=\frac{P}{4}</m>. Putting this back into our constraint gives
              <m>P=2\cdot\frac{P}{4}+2l</m> we see that <m>l</m> is also equal to
              <m>\frac{P}{4}</m>. Since <m>l=w=\frac{P}{4}</m> the square encloses the
              most area.
            </p>
          </li>
        </ol>
      </p>
    </li>
  </dl>

</p>
<p>
  As we said, the two approaches are completely equivalent.  Use
  whichever feels most comfortable to you.
</p>
</example>
<p>
In <xref ref="CHAPTERScienceBeforeCalc">Chapter</xref> we used Fermat's Method of
Adequality to solve the following problem which is closely related to
<xref ref="EXAMPLEDiffvsDer">Example~\</xref>.
</p>
<problem xml:id="PROBLEMMaximalSquareRedux1">
<statement>
<p>
  Find the dimensions of the rectangle having the smallest perimeter,
  given that the area is fixed.

  Since we are still relying on Fermat's Theorem, the first step is to
  convince yourself that this problem has a solution.  Once you have
  done that, use both of the approaches outlined in
  <xref ref="EXAMPLEDiffvsDer">Example~\</xref> to complete the solution. Which
  method do you prefer?
</p>
</statement>
</problem>


<problem>
<introduction>
        
      <image source="images/Lagrange1.png" width="50%"/>
<!-- \begin{wrapfigure}[6]{r}{1.75in} -->
<!--     \captionsetup{labelformat=empty} \vskip-6mm  -->
<!--     \centerline{\includegraphics*[height=1.3in,width=1.75in]{../Figures/Lagrange1}} -->
<!--     \label{fig:Lagrange1} -->
<!--   \end{wrapfigure} -->
<p>
  Consider all lines connecting the point <m>(-4,-3)</m> to an arbitrary
  point <m>(x,y)</m>, on the unit circle as pictured.  There is clearly one
  point where the slope of the associated line is maximum and another
  point where the slope of the associated line is minimum. These are
  the outermost lines depicted in the figure.

  Find an equation for each of these lines. If you aren't sure how to
  begin use the following steps.
</p>
</introduction>
<task>
<statement>
<p>
 Find an appropriate objective function for this problem.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Find the constraint for this problem.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Differentiate both your objective function and your constraint
    to show that the points where the maximum and minimum slope occur
    must satisfy
    <me>

      x^2+y^2=-4x-3y.\label{eq:MaxMinSlope}
    
</me>
    \comment{There is usually more than one way to solve a given
      problem so it is possible that you came up with a different
      equation than we did. That's OK. Solve the problem using yours
      and use ours to check your solution.}
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Solve <xref ref="EQUATIONMaxMinSlope"></xref> and the constraint
    simultaneously to find the equations of the lines with maximal and
    minimal slope.  Verify your answer by graphing both lines and the
    unit circle.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
        
<!--       \begin{wrapfigure}[6]{r}{1.75in} -->
<!--     \captionsetup{labelformat=empty} \vskip-6mm  -->
<!--     \centerline{\includegraphics*[height=1.3in,width=1.75in]{../Figures/Lagrange1}} -->
<!--     \label{fig:Lagrange1} -->
<!--   \end{wrapfigure} -->
<!--   Consider all lines connecting the point <m>(-4,-3)</m> to an arbitrary -->
<!--   point <m>(x,y)</m>, on the unit circle as pictured.  There is clearly one -->
<!--   point where the slope of the associated line is maximum and another -->
<!--   point where the slope of the associated line is minimum. These are -->
<!--   the outermost lines depicted in the figure. -->

<!--   Find an equation for each of these lines. If you aren't sure how to -->
<!--   begin use the following steps. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Find an appropriate objective function for this problem. -->
<!--   \item Find the constraint for this problem. -->
<!--   \item Differentiate both your objective function and your constraint -->
<!--     to show that the points where the maximum and minimum slope occur -->
<!--     must satisfy -->
<!--     <me> -->

<!--       x^2+y^2=-4x-3y.\label{eq:MaxMinSlope} -->
    
<!-- </me> -->
<!--     \comment{There is usually more than one way to solve a given -->
<!--       problem so it is possible that you came up with a different -->
<!--       equation than we did. That's OK. Solve the problem using yours -->
<!--       and use ours to check your solution.} -->
<!--   \item Solve <xref ref="EQUATIONMaxMinSlope"></xref> and the constraint -->
<!--     simultaneously to find the equations of the lines with maximal and -->
<!--     minimal slope.  Verify your answer by graphing both lines and the -->
<!--     unit circle. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->

<exercise>
<introduction>
<p>
  Sketch the graphs of <m>y=e^x</m> and <m>y=\ln(x)</m> and convince yourself
  that there is a point on each graph which is closest to the origin.
</p>
</introduction>
<task>
<statement>
<p>
 Find the approximate coordinates of the point on the curve
    <m>y=e^x</m> that is closest to the origin.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Find the approximate coordinates of the point on the curve
    <m>y=\ln(x)</m> that is closest to the origin.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Are the solutions of parts (a) and (b) related? Explain.
  </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
<!--   Sketch the graphs of <m>y=e^x</m> and <m>y=\ln(x)</m> and convince yourself -->
<!--   that there is a point on each graph which is closest to the origin. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Find the approximate coordinates of the point on the curve -->
<!--     <m>y=e^x</m> that is closest to the origin. -->
<!--   \item Find the approximate coordinates of the point on the curve -->
<!--     <m>y=\ln(x)</m> that is closest to the origin. -->
<!--   \item Are the solutions of parts (a) and (b) related? Explain. -->
<!--   \end{enumerate} -->
<!-- \end{ProficiencyDrill} -->

<exercise>
<introduction>
<p>
  Suppose a point is moving in a plane so that its <m>(x,y)</m> coordinates
  are given by: <me> P(t)=
  \begin{ParamEq} {t-1} {e^t} {-\infty\lt t \lt \infty}
  \end{ParamEq}
  </me>
</p>
</introduction>
<task>
<statement>
<p>
 Find the value of <m>t</m> where the point, <m>P(t)</m>, is closest to
    the origin.  Is it clear that there is such a point?
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Find the <m>(x,y)</m> coordinates of the point's location when it
    is closest to the origin.
  </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
<!--   Suppose a point is moving in a plane so that its <m>(x,y)</m> coordinates -->
<!--   are given by: <me> P(t)= -->
<!--   \begin{ParamEq} {t-1} {e^t} {-\infty\lt t \lt \infty} -->
<!--   \end{ParamEq} -->
<!--   </me> -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Find the value of <m>t</m> where the point, <m>P(t)</m>, is closest to -->
<!--     the origin.  Is it clear that there is such a point? -->
<!--   \item Find the <m>(x,y)</m> coordinates of the point's location when it -->
<!--     is closest to the origin. -->
<!--   \end{enumerate} -->
<!-- \end{ProficiencyDrill} -->


<problem xml:id="PROBLEMRectInscEll">
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Of all the rectangles that can be inscribed in the unit circle
    show that the one with the maximum area is a square.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Of all the rectangles that can be inscribed in the ellipse
    <m>x^2+\frac{y^2}{9}=1</m> show that the one with the maximum area is
    three times taller than it is wide.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Of all the rectangles that can be inscribed in the ellipse
    <m>\frac{x^2}{16}+y^2=1</m> show that the one with the maximum area is
    four times wider than it is tall.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Of all the rectangles that can be inscribed in the ellipse
    <m>\frac{x^2}{a^2}+\frac{y^2}{b^2}=1</m> show that the one with the
    maximum area has a height to width ratio of <m>\frac{b}{a}</m>.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate} -->
<!--   <!-\- \label{problem:RectInscEll} -\-> -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Of all the rectangles that can be inscribed in the unit circle -->
<!--     show that the one with the maximum area is a square. -->
<!--   \item Of all the rectangles that can be inscribed in the ellipse -->
<!--     <m>x^2+\frac{y^2}{9}=1</m> show that the one with the maximum area is -->
<!--     three times taller than it is wide. -->
<!--   \item Of all the rectangles that can be inscribed in the ellipse -->
<!--     <m>\frac{x^2}{16}+y^2=1</m> show that the one with the maximum area is -->
<!--     four times wider than it is tall. -->
<!--   \item Of all the rectangles that can be inscribed in the ellipse -->
<!--     <m>\frac{x^2}{a^2}+\frac{y^2}{b^2}=1</m> show that the one with the -->
<!--     maximum area has a height to width ratio of <m>\frac{b}{a}</m>. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->
<aside>
<title>Note to self</title>
<p>
Digression missing
</p>
</aside>

<!-- <!-\- \begin{Digression}[Triangles with Fixed Perimeters] -\-> -->
<!-- <!-\-   \label{digression:TrianglesWithFixedPerimeters} -\-> -->
<!-- <!-\-   In <xref ref="EXfixed-perimeter">Examples</xref> <xref ref="EXAMPLEDiffvsDer">and</xref> we -\-> -->
<!-- <!-\-   saw that of all rectangles with fixed perimeter, the square (an -\-> -->
<!-- <!-\-   equilateral rectangle) has the largest area. Is this also true of -\-> -->
<!-- <!-\-   triangles? More precisely, does an equilateral triangle have the -\-> -->
<!-- <!-\-   largest area out of all triangles with a fixed perimeter?  This may -\-> -->
<!-- <!-\-   sound like a simpler problem but it is actually a bit harder. -\-> -->
  
<!-- <!-\-   Here's why. With a rectangle each set of parallel sides varied -\-> -->
<!-- <!-\-   together so we only had two independent parameters to deal with. For -\-> -->
<!-- <!-\-   triangles all three sides vary independently, giving us three -\-> -->
<!-- <!-\-   independently varying parameters, which is inherently more complex -\-> -->
<!-- <!-\-   than two. -\-> -->


<!-- <!-\-   How might we address this question? -\-> -->

<!-- <!-\-   A standard ploy for solving difficult problems is to first try a -\-> -->
<!-- <!-\-   simpler <q>adjacent</q> problem. To create such a problem in this case -\-> -->
<!-- <!-\-   we hold one side fixed and only allow two sides of our triangle to -\-> -->
<!-- <!-\-   vary. We'll show that when the area of the triangle is maximal the -\-> -->
<!-- <!-\-   two varying sides must be the same length. We want to use this -\-> -->
<!-- <!-\-   adjacent problem to gain some insight into how to solve our actual -\-> -->
<!-- <!-\-   problem. -\-> -->

<!-- <!-\-   So our adjacent problem is this: Given all triangles with a fixed -\-> -->
<!-- <!-\-   base and a fixed perimeter, does an isosceles triangle have the -\-> -->
<!-- <!-\-   largest area?  The sketch below has all of the pertinent -\-> -->
<!-- <!-\-   parameters labeled.\\ -\-> -->
        
<!-- <!-\- <image source="images/Optimization3.png" width="60%" /> -\-> -->
<!-- <!-\- <!-\\- \centerline{\includegraphics*[height=1.2in,width=2.5in]{../Figures/Optimization3}} -\\-> -\-> -->
    
<!-- <!-\-   If we hold <m>b</m> fixed minimizing the area, <m>A=\frac12bh</m>, is -\-> -->
<!-- <!-\-   equivalent to maximizing <m>h</m>. So the length of <m>h</m> is the natural -\-> -->
<!-- <!-\-   objective function for this problem. Also if <m>h</m> is at its maximum -\-> -->
<!-- <!-\-   then by Fermat's Theorem (<xref ref="THEOREMFermatsTheorem">Theorem~\</xref>), <m>\dx{h}=0</m>. Notice that -\-> -->
<!-- <!-\-   there are two right triangles in our sketch and <m>h</m> is the height of -\-> -->
<!-- <!-\-   both of them. -\-> -->


<!-- <!-\-   <problem xml:id="problem:MaximalIsoceles1"> -\-> -->
<!-- <!-\- <introduction> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-     <!-\\- \label{problem:MaximalIsoceles1} -\\-> -\-> -->
<!-- <!-\- </p> -\-> -->
<!-- <!-\- </introduction> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Use the sketch above to express <m>h</m> as a function of <m>x</m> and -\-> -->
<!-- <!-\-       <m>z</m> and show that when <m>h</m> is maximal <m>x\dx{x} - z\dx{z}=0</m>. -\-> -->
<!-- <!-\-     </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Express <m>h</m> as a function of <m>y</m> and <m>w</m> and show that when -\-> -->
<!-- <!-\-       <m>h</m> is maximal <m>y\dx{y}-w\dx{w}=0</m>. -\-> -->
<!-- <!-\-     </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Use the fact that <m>b</m> is constant to find an equation -\-> -->
<!-- <!-\-       relating <m>\dx{z}</m> and <m>\dx{w}</m>. -\-> -->
<!-- <!-\-     </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Use the fact that the perimeter <m>P</m> is constant to find an -\-> -->
<!-- <!-\-       equation relating <m>\dx{x}</m> and <m>\dx{y}</m>. -\-> -->
<!-- <!-\-     </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Use the results from parts (a), (b), (c), and (d) to show -\-> -->
<!-- <!-\-       that <m>h</m> is maximized when -\-> -->
<!-- <!-\-       <me> -\-> -->
<!-- <!-\-       \frac{z}{x}=\dfdx{x}{z}=\frac{w}{y}. -\-> -->
<!-- <!-\-       </me> -\-> -->
<!-- <!-\-       \hint{Use an appropriate trigonometric function.} -\-> -->
<!-- <!-\-     </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Use part (e) to conclude that the base angles, <m>\alpha</m> and -\-> -->
<!-- <!-\-       <m>\beta</m>, must be congruent and thus <m>x=y</m>. -\-> -->
<!-- <!-\-                 </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- </problem> -\-> -->
<!-- <!-\- <!-\\- \begin{embeddedproblem-enumerate}[The Adjacent Problem] -\\-> -\-> -->
<!-- <!-\-   <!-\\-   <!-\\\- \label{problem:MaximalIsoceles1} -\\\-> -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \begin{enumerate}[label={  (\alph*)}] -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \item Use the sketch above to express <m>h</m> as a function of <m>x</m> and -\\-> -\-> -->
<!-- <!-\-   <!-\\-     <m>z</m> and show that when <m>h</m> is maximal <m>x\dx{x} - z\dx{z}=0</m>. -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \item Express <m>h</m> as a function of <m>y</m> and <m>w</m> and show that when -\\-> -\-> -->
<!-- <!-\-   <!-\\-     <m>h</m> is maximal <m>y\dx{y}-w\dx{w}=0</m>. -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \item Use the fact that <m>b</m> is constant to find an equation -\\-> -\-> -->
<!-- <!-\-   <!-\\-     relating <m>\dx{z}</m> and <m>\dx{w}</m>. -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \item Use the fact that the perimeter <m>P</m> is constant to find an -\\-> -\-> -->
<!-- <!-\-   <!-\\-     equation relating <m>\dx{x}</m> and <m>\dx{y}</m>. -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \item Use the results from parts (a), (b), (c), and (d) to show -\\-> -\-> -->
<!-- <!-\-   <!-\\-     that <m>h</m> is maximized when -\\-> -\-> -->
<!-- <!-\-   <!-\\-     <me> -\\-> -\-> -->
<!-- <!-\-   <!-\\-     \frac{z}{x}=\dfdx{x}{z}=\frac{w}{y}. -\\-> -\-> -->
<!-- <!-\-   <!-\\-     </me> -\\-> -\-> -->
<!-- <!-\-   <!-\\-     \hint{Use an appropriate trigonometric function.} -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \item Use part (e) to conclude that the base angles, <m>\alpha</m> and -\\-> -\-> -->
<!-- <!-\-   <!-\\-     <m>\beta</m>, must be congruent and thus <m>x=y</m>. -\\-> -\-> -->
<!-- <!-\-   <!-\\-               \end{enumerate} -\\-> -\-> -->
<!-- <!-\-   <!-\\- \end{embeddedproblem-enumerate} -\\-> -\-> -->
  
<!-- <!-\-   To show that the maximal area of an arbitrary triangle with a fixed -\-> -->
<!-- <!-\-   perimeter must be equilateral we do not need Calculus, only -\-> -->
<!-- <!-\-   reasoning.  An example of the kind of reasoning we need appears in -\-> -->
<!-- <!-\-   the Sherlock Holmes short story <pubtitle>The Adventure of the Beryl -\-> -->
<!-- <!-\-     Coronet</pubtitle>. Early in the story Holmes says to Watson, <q>It is an old -\-> -->
<!-- <!-\-   maxim of mine that when you have excluded the impossible, whatever -\-> -->
<!-- <!-\-   remains, however improbable, must be the truth.</q>  Our solution will -\-> -->
<!-- <!-\-   follow Holmes' lead: We will eliminate what is impossible leaving -\-> -->
<!-- <!-\-   only the truth behind\aside{Holmes is using a tried and true -\-> -->
<!-- <!-\-     mathematical proof technique, known colloquially as <q>the process -\-> -->
<!-- <!-\-     of elimination.</q> In mathematics it goes by its Latin name -\-> -->
<!-- <!-\-     <foreign>Reduction Ad Absurdum</foreign> (RAA). If only one of two -\-> -->
<!-- <!-\-     statements can be true -\\- for example a triangle is either -\-> -->
<!-- <!-\-     equilateral or it is not -\\- we show logically that one of them is -\-> -->
<!-- <!-\-     impossible under the constraints of the problem. We then conclude -\-> -->
<!-- <!-\-     that the other statement must be true. In this way we <q>eliminate -\-> -->
<!-- <!-\-     the -\-> -->
<!-- <!-\-     impossible</q> so what is left <q>must be the truth.</q> \\ -\-> -->
<!-- <!-\-     If more than two statements are possible and we can eliminate all -\-> -->
<!-- <!-\-     but one, that one <q>must be the truth.</q> If only two statements -\-> -->
<!-- <!-\-     are possible, as in this problem, the method is also called -\-> -->
<!-- <!-\-     <term>Proof by Contradiction</term>.}. -\-> -->

        

<!-- <!-\-   <problem> -->
<!-- <!-\- <introduction> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-     is Equilateral] -\-> -->
<!-- <!-\-     Observe that every triangle is either equilateral, or it is not -\-> -->
<!-- <!-\-     equilateral. -\-> -->
<!-- <!-\-     \label{problem:MaximalTriangle} -\-> -->
<!-- <!-\- </p> -\-> -->
<!-- <!-\- </introduction> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Suppose we have a triangle with sides <m>a</m>, <m>b</m>, and <m>c</m> -\-> -->
<!-- <!-\-       which is not equilateral. Then at least two sides, say <m>a</m> and -\-> -->
<!-- <!-\-       <m>c</m>, are not equal.  Explain how -\-> -->
<!-- <!-\-       <xref ref="PROBLEMproblem:MaximalIsoceles1"></xref> implies that there must -\-> -->
<!-- <!-\-       be another triangle with the same perimeter and a larger area. -\-> -->
<!-- <!-\-                 </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- <task> -\-> -->
<!-- <!-\- <statement> -\-> -->
<!-- <!-\- <p> -\-> -->
<!-- <!-\-  Use Holmes' maxim to explain why a triangle with a fixed -\-> -->
<!-- <!-\-       perimeter enclosing maximal area must be equilateral. -\-> -->
<!-- <!-\-     </p> -\-> -->
<!-- <!-\- </statement> -\-> -->
<!-- <!-\- </task> -\-> -->
<!-- <!-\- </problem> -\-> -->
<!-- <!-\- <!-\\- \begin{embeddedproblem}[The Largest Triangle with a Fixed Perimeter -\\-> -\-> -->
<!-- <!-\-   <!-\\-   is Equilateral] -\\-> -\-> -->
<!-- <!-\-   <!-\\-   Observe that every triangle is either equilateral, or it is not -\\-> -\-> -->
<!-- <!-\-   <!-\\-   equilateral. -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \label{problem:MaximalTriangle} -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \begin{enumerate}[label={  (\alph*)}] -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \item Suppose we have a triangle with sides <m>a</m>, <m>b</m>, and <m>c</m> -\\-> -\-> -->
<!-- <!-\-   <!-\\-     which is not equilateral. Then at least two sides, say <m>a</m> and -\\-> -\-> -->
<!-- <!-\-   <!-\\-     <m>c</m>, are not equal.  Explain how -\\-> -\-> -->
<!-- <!-\-   <!-\\-     <xref ref="PROBLEMproblem:MaximalIsoceles1"></xref> implies that there must -\\-> -\-> -->
<!-- <!-\-   <!-\\-     be another triangle with the same perimeter and a larger area. -\\-> -\-> -->
<!-- <!-\-   <!-\\-               \item Use Holmes' maxim to explain why a triangle with a fixed -\\-> -\-> -->
<!-- <!-\-   <!-\\-     perimeter enclosing maximal area must be equilateral. -\\-> -\-> -->
<!-- <!-\-   <!-\\-   \end{enumerate} -\\-> -\-> -->
<!-- <!-\-   <!-\\- \end{embeddedproblem} -\\-> -\-> -->
<!-- <!-\- \end{Digression} -\-> -->

</section>

<section xml:id="SECTIONrefl-refr-rainb">
<title>Reflections, Refractions, and Rainbows</title>

<introduction>
  <p>
    Because they are called <q>Optimization Problems</q> it is natural to assume that such
    problems are always about finding the maximum or minimum value of
    something. Certainly many of them are, but not all.  Optimization
    problems come in two flavors:
    <ol>
      <li>
        <p>
          Find the extreme values of some objective function, if there
          are any.  Examples of this kind of problem are
          <xref ref="EXAMPLESqOnLine">Examples~\</xref>,
          <xref ref="EXAMPLECircleDist">and~\</xref>,
          <xref ref="DRILLExtremalSquareCircle"></xref>,
          and
          <xref ref="PROBLEMEllipseDist">Problem~\</xref>.
        </p>
      </li>
      <li>
        <p>
          Show that some property holds when the objective function is
          optimized. Examples of this kind of problem are
          <xref ref="PROBLEMMinSqLine"></xref>,
          <xref ref="PROBLEMMaxOrth1"></xref>,
          <xref ref="PROBLEMRectInscEll"></xref>
          and
          <xref ref="EXAMPLEDiffvsDer"></xref>.
        </p>
      </li>
    </ol>
  </p>
</introduction>
<subsection xml:id="SUBSECTIONreflection">
<title>Reflection</title>

<figure>
<caption>
<url href="https://echengphoto.com/" visual="https://echengphoto.com/">This figure needs a caption.</url>
</caption>
<image source="images/ReflectingMirror4.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[9]{r}{2in} -->
<!--   \captionsetup{labelformat=empty} -->
<!--   \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/ReflectingMirror4}} -->
<!--   \label{fig:ReflectingMirror4} -->
<!-- \end{wrapfigure} -->
<p>

Another example of this second type is the problem of reflecting light
we looked at in <xref ref="CHAPTERScienceBeforeCalc">Chapter</xref>. Recall that
we showed that light bounces off of a mirror in such a manner that the
angle of incidence equals the angle of reflection.  We did this by
reasoning geometrically from the figure at the right to show that the
minimal path must satisfy the condition <m>\alpha=\gamma</m>.
</p>
<p>

The geometric argument was actually pretty easy to understand once we
found the right trick. But that's the difficulty. The geometric
argument required the very counter-intuitive trick of pretending that
the light passed through the mirror instead of reflecting off of it!
Calculus provides a more systematic approach, one that does not
require a stroke-of-genius level of insight to solve each new
problem. Let's re-solve this problem, this time using the Calculus
tools we've learned.
</p>
<p>

We will need an objective function so we modify the sketch above to
suit the needs of Calculus. In particular, the relevant quantities
need names as shown below.
</p>

<image source="images/ReflectingMirror5.png" width="60%" />
<!-- \centerline{ -->
<!--   \includegraphics*[height=2in,width=5in]{../Figures/ReflectingMirror5}} -->
<p>
We assume that <m>a</m> (the height of the light source), <m>b</m> (the height
of the observer's eye), and <m>c</m> (the distance between the light source
and the observer) are constants while <m>x, y, z</m>, and <m>w</m> are
variables.
</p>
<p>

We wish to show that when the path of the light from <m>A</m> to <m>R</m> to <m>B</m>
is shortest, then <m>\alpha=\beta</m>. Since the length of that path is
<m>z+w</m> a natural objective function is:

<me>
  \label{eq:RefMir1} L=z+w.
</me>
We also have the following constraints
\begin{align}
  \label{eq:RefMir2}  a^2+x^2\amp =z^2, \text{ and}\\
  \label{eq:RefMir3} b^2+y^2\amp =w^2.\\
  \label{eq:RefMir4} x+y\amp =c.
\end{align}
</p>
<p>

Differentiating <xref ref="EQRefMir1">Equation~</xref>) gives
<m>\dx{L} = \dx{z}+\dx{w}</m>.
</p>
<p>

Differentiating <xref ref="EQRefMir2">Equation~</xref>) gives
<m>\dx{z}=\frac{x}{z}\dx{x}</m> so, combining these two results, we have
<me>
\dx{L} = \frac{x}{z}\dx{x}+\dx{w}.
</me>
</p>
<p>

Differentiating <xref ref="EQRefMir3">Equation</xref>
gives<m>\dx{w}=\frac{y}{w}\dx{y}</m>, so
<me>
\dx{L} = \frac{x}{z}\dx{x}+\frac{y}{w}\dx{y}.
</me>
</p>
<p>

And finally differentiating <xref ref="EQRefMir4">Equation~</xref>) gives
<m>\dx{y} = -\dx{x}</m>, so that
<me>
\dx{L} = \frac{x}{z}\dx{x}-\frac{y}{w}\dx{x},
</me>
or
<me>
\dfdx{L}{x} = \frac{x}{z}-\frac{y}{w}.
</me>
</p>
<p>


Now suppose that the path from <m>A</m> to <m>R</m> to <m>B</m> is the shortest
possible path, i.e., suppose that <m>L</m> is minimal. Then by Fermat's
Theorem we know that <m>\dfdx{L}{x}=0</m>, and therefore
<me>
\frac{x}{z}=\frac{y}{w}.
</me>
Since <m>\frac{x}{z}=\cos(\alpha)</m> and <m>\frac{y}{w}=\cos(\beta)</m> we see
that <m>\alpha=\beta</m>.
</p>
<p>

This Calculus based argument is not as elegant as the geometric
argument we used in <xref ref="CHAPTERScienceBeforeCalc">Chapter</xref>. In the
geometric argument we could easily visualize what was happening.  Our
Calculus based argument wasn't at all visual and it involved a lot of
computation. But, believe it or not, this is a strength not a
weakness.  None of the computations are particularly hard, just
tedious and detailed. But -- and this is the point -- we also had a
clearly defined procedure to follow. We needed to: (1) Compute
<m>\dfdx{L}{x}</m>, and (2) set <m>\dfdx{L}{x}</m> equal to zero.  The rest was
Algebra which is straightforward though not necessarily easy.
</p>


<problem>
<introduction>
<p>
  In the figure above suppose that <m>a=5</m>, <m>b=3</m>, and <m>c=10</m>.
</p>
</introduction>
<task>
<statement>
<p>
 Show that
    <m>\dfdx{L}{x}=\frac{x}{\sqrt{25+x^2}}-\frac{10-x}{\sqrt{9+(10-x)^2}}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that the solution of <m>\dfdx{L}{x}=0</m> is <m>x=\frac{25}{4}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Use the result of part (b) to show that <m>\alpha=\beta</m>.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--   In the figure above suppose that <m>a=5</m>, <m>b=3</m>, and <m>c=10</m>. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Show that -->
<!--     <m>\dfdx{L}{x}=\frac{x}{\sqrt{25+x^2}}-\frac{10-x}{\sqrt{9+(10-x)^2}}</m>. -->
<!--   \item Show that the solution of <m>\dfdx{L}{x}=0</m> is <m>x=\frac{25}{4}</m>. -->
<!--   \item Use the result of part (b) to show that <m>\alpha=\beta</m>. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->



</subsection>
<subsection xml:id="SUBSECTIONrefraction">
<title>Refraction: Snell's Law</title>

<p>
We began the derivation of Snell's Law in
<xref ref="SECsnells-law-refr">Section</xref>, using the following sketch
and assuming that the velocity of light in Medium 1 is <m>v_1</m>, and the
velocity of light in
Medium 2 is <m>v_2</m>.
</p>
<image source="images/Refraction4.png" width="60%" />
<!-- \centerline{\includegraphics*[height=2.2in,width=3.7in]{../Figures/Refraction4}} -->
<p>
In <xref ref="PROBLEMFermatSnell">Problem~\</xref>
in you found that the time for a ray of light to travel
from point <m>A</m> to point <m>B</m> is given by
<me>
T(x)=\frac{\sqrt{a^2+x^2}}{v_1}+\frac{\sqrt{b^2+(c-x)^2}}{v_2}.
</me>
But we stopped there with the comment that, although Fermat
successfully proved Snell's Law by minimizing <m>T(x)</m> using his Method
of Adequality, it is very very difficult to do. We said we would
return to the problem when we could use the rules of Calculus. The
time to do that has arrived.
</p>
<p>

Notice that we have an optimization problem. The objective function we
need to minimize is <m>T(x)</m>.  There are several constraints. For
example, <m>x+y=c</m> is one. Another is <m>a^2+x^2=z^2</m>. There is at least
one more.
</p>
<p>

It is tempting to compute <m>\dfdx{T}{x}</m> and proceed to solve
<m>\dfdx{T}{x}=0</m> as we've done before. Computing <m>\dfdx{T}{x}</m> is a bit
challenging but it can be done if you proceed carefully.
</p>
<p>

The real issue is solving <m>\dfdx{T}{x}=0</m> for <m>x</m>. Unfortunately, this
is still rather difficult to accomplish.  But fortunately we we are
not really interested in the value of <m>x</m> when <m>T(x)</m> is minimal. We
want to show that the tie traveled along the path from <m>A</m> to <m>C</m> to
<m>B</m> is minimal when
<m>\frac{\sin(\alpha)}{v_1}=\frac{\sin(\beta)}{v_2}</m>.  We'll proceed
carefully.
</p>

<problem xml:id="PROBLEMSnellsLawWithCalculus">
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
  We  know that the total time traveled from point <m>A</m>  to <m>C</m> to <m>B</m> is given by\\
    \centerline{ <m> T(x)=\dfrac{z}{v_1}+\dfrac{w}{v_2}.  </m>} Write down
    all of the constraints involving the variables <m>x</m>, <m>y</m>, <m>z</m>, and
    <m>w</m>, and the constants <m>a</m>, <m>b</m>, and <m>c</m>.  (We'll ignore <m>\alpha</m>
    and <m>\beta</m> for now.)
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that when <m>T</m> is minimum (that is, when <m>\dfdx{T}{x}=0</m>)
    we have
    <me>

      \label{eq:SnellPrecurse}
      \dfrac{1}{v_1}\dfrac{x}{z}=\dfrac{1}{v_2}\dfrac{y}{w}.
    
</me>
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Use <xref ref="EQUATIONSnellPrecurse">~</xref> to derive Snell's Law of
    refraction: <m> \frac{\sin(\alpha)}{v_1}= \frac{\sin(\beta)}{v_2}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Assuming that the speed of light in water is about <m>3/4</m> of
    the speed of light in air, use Snell's Law to determine the range
    of possible angles for <m>\beta</m> as <m>\alpha</m> ranges from <m>0</m> to
    <m>\pi/2</m>.
    \centerline{\includegraphics*[height=.8in,width=1.9in]{../Figures/RangeBeta}}
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate} -->
<!--   <!-\- \label{problem:SnellsLawWithCalculus} -\-> -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item  We  know that the total time traveled from point <m>A</m>  to <m>C</m> to <m>B</m> is given by\\ -->
<!--     \centerline{ <m> T(x)=\dfrac{z}{v_1}+\dfrac{w}{v_2}.  </m>} Write down -->
<!--     all of the constraints involving the variables <m>x</m>, <m>y</m>, <m>z</m>, and -->
<!--     <m>w</m>, and the constants <m>a</m>, <m>b</m>, and <m>c</m>.  (We'll ignore <m>\alpha</m> -->
<!--     and <m>\beta</m> for now.) -->
<!--   \item Show that when <m>T</m> is minimum (that is, when <m>\dfdx{T}{x}=0</m>) -->
<!--     we have -->
<!--     <me> -->

<!--       \label{eq:SnellPrecurse} -->
<!--       \dfrac{1}{v_1}\dfrac{x}{z}=\dfrac{1}{v_2}\dfrac{y}{w}. -->
    
<!-- </me> -->
<!--   \item Use <xref ref="EQUATIONSnellPrecurse">~</xref> to derive Snell's Law of -->
<!--     refraction: <m> \frac{\sin(\alpha)}{v_1}= \frac{\sin(\beta)}{v_2}</m>. -->
<!--   \item Assuming that the speed of light in water is about <m>3/4</m> of -->
<!--     the speed of light in air, use Snell's Law to determine the range -->
<!--     of possible angles for <m>\beta</m> as <m>\alpha</m> ranges from <m>0</m> to -->
<!--     <m>\pi/2</m>. -->
<!--     \centerline{\includegraphics*[height=.8in,width=1.9in]{../Figures/RangeBeta}} -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->


<figure>
<caption>
<url href="https://echengphoto.com/" visual="https://echengphoto.com/">This figure needs a caption.</url>
</caption>
<image source="images/SnellsWindowFoliage-EricChen.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[]{r}{2in} -->
<!--   \captionsetup{labelformat=empty} -->
<!--   \centerline{\href{https://echengphoto.com/}{\includegraphics*[height=1.5in,width=2in]{../Figures/SnellsWindowFoliage-EricChen}}} -->
<!--   \label{fig:SnellsWindowFoliage-EricChen} -->
<!--   \centerline{\textcolor{blue}{ Snell's Window}} -->
<!--   \centerline{\textcolor{blue}{courtesy of Eric Cheng}} -->
<!-- \end{wrapfigure} -->
<p>

Physically, what part (d) of
<xref ref="PROBLEMSnellsLawWithCalculus">Problem~\</xref> says is that when you
are beneath the surface of a pond and look upward the entire view of the
world above the surface is compressed into % the range dictated by the
a circle at the top of a cone with central
angle <m>\beta</m>. Attempts to
look beyond that angle will result in you seeing a (probably dark)
reflection from the bottom of the pond as no light that enters from above and
outside this circle will reach your eye at point <m>P</m>.  This phenomenon
is called Snell's Window and is illustrated in the image at the right.
</p>
<p>

The solution to the following problem will rely on a derivation
similar to the one we used to prove Snell's Law.
</p>

<problem xml:id="PROBLEMsnells-law-variation">
<introduction>
<p>
  Suppose that the cost to run a fiber optic cable underwater is
  <m>k</m> (<m>k\ge1</m>) times the cost to run it on land.  We wish to run a
  fiber optic cable from point <m>A</m> <m>1</m> km from the river, to point <m>B</m>
  on the other side <m>10</m> km
  downstream. The river is <m>1</m> km wide.\\
  \centerline{\includegraphics*[height=1.8in,width=4.5in]{../Figures/FiberOptic1}}
</p>
</introduction>
<task>
<statement>
<p>
 Show that the value of <m>x</m> necessary to minimize the cost of
    running the cable must satisfy the equation
    <me>
    (k^2-1) x^4-20(k^2-1) x^3+101(k^2-1) x^2-20k^2 x+100k^2=0.
    </me>
  </p>
</statement>
</task>
<task>
<statement>
<p>
 When the formulas we're working with get this complicated it
    is a good idea to check them against our intuition in simple
    cases. Does this formula make sense to you when <m>k=1</m>?
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Use any appropriate technology, or Newton's Method, to provide
    approximate values for <m>x</m> in the following table
    \begin{center}
      \begin{tabular}{|c|p{3cm}|} \hline <m>k </m>
        \amp <m>\hspace{12mm}x</m>\\\hline \hline
        \amp    \\
        <m>1.1</m> \amp    \\
        \amp    \\
        <m>1.2</m> \amp    \\
        \amp    \\
        <m>1.3</m> \amp    \\
        \amp    \\
        <m>1.4</m> \amp    \\
        \amp    \\
        <m>1.5</m> \amp    \\
        \amp    \\
        \hline
      \end{tabular}
    \end{center}
    Do these values surprise you? Explain.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--   <!-\- \label{problem:snells-law-variation} -\-> -->
<!--   Suppose that the cost to run a fiber optic cable underwater is -->
<!--   <m>k</m> (<m>k\ge1</m>) times the cost to run it on land.  We wish to run a -->
<!--   fiber optic cable from point <m>A</m> <m>1</m> km from the river, to point <m>B</m> -->
<!--   on the other side <m>10</m> km -->
<!--   downstream. The river is <m>1</m> km wide.\\ -->
<!--   \centerline{\includegraphics*[height=1.8in,width=4.5in]{../Figures/FiberOptic1}} -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Show that the value of <m>x</m> necessary to minimize the cost of -->
<!--     running the cable must satisfy the equation -->
<!--     <me> -->
<!--     (k^2-1) x^4-20(k^2-1) x^3+101(k^2-1) x^2-20k^2 x+100k^2=0. -->
<!--     </me> -->
<!--   \item When the formulas we're working with get this complicated it -->
<!--     is a good idea to check them against our intuition in simple -->
<!--     cases. Does this formula make sense to you when <m>k=1</m>? -->
<!--   \item Use any appropriate technology, or Newton's Method, to provide -->
<!--     approximate values for <m>x</m> in the following table -->
<!--     \begin{center} -->
<!--       \begin{tabular}{|c|p{3cm}|} \hline <m>k </m> -->
<!--         \amp <m>\hspace{12mm}x</m>\\\hline \hline -->
<!--         \amp    \\ -->
<!--         <m>1.1</m> \amp    \\ -->
<!--         \amp    \\ -->
<!--         <m>1.2</m> \amp    \\ -->
<!--         \amp    \\ -->
<!--         <m>1.3</m> \amp    \\ -->
<!--         \amp    \\ -->
<!--         <m>1.4</m> \amp    \\ -->
<!--         \amp    \\ -->
<!--         <m>1.5</m> \amp    \\ -->
<!--         \amp    \\ -->
<!--         \hline -->
<!--       \end{tabular} -->
<!--     \end{center} -->
<!--     Do these values surprise you? Explain. -->
<!--   \end{enumerate} -->


<!-- \end{embeddedproblem} -->


</subsection>
<subsection xml:id="SUBSECTIONrainbows">
<title>Rainbows</title>

<p>
Look carefully at the double rainbow in the pictures below and notice
that the order of the colors is reversed from the primary (brighter)
to the secondary rainbow?  Why do you think this
happens?
</p>
<image source="images/SavageEnariRainbow.png" width="60%" />
<!-- \centerline{\includegraphics*[height=3in,width=5.6in]{../Figures/SavageEnariRainbow}} -->
<p>

A few other questions come readily to mind. What conditions are
required for a rainbow to form? Why is red on the top of the primary
rainbow?  Why is the primary rainbow below the secondary one? Why is
the primary rainbow brighter and why are double rainbows so rare?
</p>
<p>

To tackle these questions the first thing we'll need to do is build a
mathematical model of the problem. As you will see developing the
model is probably the most challenging part.
</p>
<p>

When a ray of light enters a raindrop it gets both refracted and
reflected, so we will need to use all that we have learned about how
light refracts and reflects. Clearly Snell's Law will play a prominent
role. To keep things simple we assume the drop is spherical.
</p>

<figure>
<caption>
<url href="https://en.wikipedia.org/wiki/Leo_Tolstoy" visual="https://en.wikipedia.org/wiki/Leo_Tolstoy">This figure needs a caption.</url>
</caption>
<image source="images/Refraction7.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[13]{r}{3in} -->
<!--   \captionsetup{labelformat=empty} -->
<!--     \centerline{\includegraphics*[height=2in,width=3in]{../Figures/Refraction7}} -->
<!--   \label{fig:Refraction7} -->
<!-- \end{wrapfigure} -->
<p>

By the Principle of Local Linearity when light strikes a point on a
curved surface it will refract (if the surface is transparent) or
reflect (if the surface is reflective) as if the surface is actually
the line tangent to the surface. Since we're assuming for simplicity
that our raindrops are spherical this means that the light will
reflect or refract as if it is striking the tangent line of the circle
in the diagram at the point where the light enters the droplet, <m>A</m>,
exits the droplet, <m>C</m>, or reflects inside of the droplet, <m>B</m>.  All
of the angles in the diagram at the right are measured between the
light beam (in red) and the extended radii (blue, dashed lines) at
points <m>A</m>, <m>B</m>, and <m>C</m>.
</p>
<p>

As displayed in the diagram above, the light ray traveling at velocity
<m>v_1</m>, entering the raindrop at <m>A</m> and making an angle of <m>\alpha</m>
radians with the radial line <m>OA</m> is refracted to an angle of radian
measure <m>\beta</m> according to Snell's Law:
<me>\frac{\sin(\alpha)}{v_1}=\frac{\sin(\beta)}{v_2},</me> where
<m>v_2</m> is the velocity of light inside the raindrop. It is helpful to
think of this refraction as a rotation about the point <m>A</m>. This is
<q>Rotation 1</q> in the diagram below. The reflection at point <m>B</m> and
the refraction at point <m>C</m> can similarly be thought of as rotations
about their respective points.
</p>

<figure>
<caption>
<url href="https://en.wikipedia.org/wiki/Leo_Tolstoy" visual="https://en.wikipedia.org/wiki/Leo_Tolstoy">This figure needs a caption.</url>
</caption>
<image source="images/Droplet1.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[11]{r}{3in} -->
<!--   \captionsetup{labelformat=empty} -->
<!--   \vskip-6mm  -->
<!--   \centerline{\includegraphics*[height=1.8in,width=3in]{../Figures/Droplet1}} -->
<!--   \label{fig:Droplet1} -->
<!-- \end{wrapfigure} -->
<p>

Actually, only a portion of the light is refracted. The rest is
reflected off the exterior of the raindrop, and is no longer of
concern to us.  Once inside the raindrop, it reflects off of the back
of the raindrop (again only a portion is reflected) so that the angle
of incidence equals the angle of reflection.  A portion of the light
then exits the raindrop, and once again the angles are governed by
Snell's Law.
</p>
<p>


The total amount of (clockwise) rotation in this process is called the
<term>deviation angle</term>, denoted <m>D(\alpha)</m>. This is shown in the
sketch above. %\\
Notice that the total rotation is a sum of three separate rotations.
</p>


<problem>
<statement>
<p>
  Show that <m> D(\alpha)=\pi-4\beta+2\alpha</m>.
</p>
</statement>
</problem>
<p>
Remember that the angles <m>\alpha</m> and <m>\beta</m> are not
independent. They are related by Snell's Law which we will rewrite as
<me>
  \label{eq:SnellConstraint}
  \sin(\alpha)=\frac{v_1}{v_2}\sin(\beta)=k\sin(\beta),
</me>
where <m>k=\frac{v_1}{v_2}</m> is called <term>index of refraction</term> (for
water). In the case of white light, this index of refraction is
about\aside{This is an average. <m>k</m> actually varies with the frequency
  (color) of the light.}  <m>\frac43</m>. Graphing <m>D(\alpha)</m> for
<m>k=\frac43</m> and <m>0\le\alpha\le\frac{\pi}{2}</m> gives the graph at the
left.
</p>
<figure>
<caption>
<url href="https://en.wikipedia.org/wiki/Leo_Tolstoy" visual="https://en.wikipedia.org/wiki/Leo_Tolstoy">\textcolor{black} </url>
</caption>
<image source="images/DoubleRainbow3.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[16]{l}{3.7in} -->
<!--   \captionsetup{labelformat=empty} \vskip-5mm  -->
<!--       \centerline{\includegraphics*[height=2.5in,width=3.7in]{../Figures/DoubleRainbow3}} -->
<!--   \caption{\textcolor{black} } -->
<!--   \label{fig:DoubleRainbow3} -->
<!-- \end{wrapfigure} -->
<p>

From this graph it appears that the minimum of the curve is
approximately at the point <m>(1.03,2.41)</m>.  So the minimum value of
<m>D(\alpha)</m> is about <m>2.41 \text{ radians }\approx138^\circ</m> and it
occurs when the angle at which the light enters the raindrop is
<m>\alpha\approx1.03 \text{ radians }\approx59.4^\circ</m>.  Notice (from
the enlargement of the graph near that minimum) that because the graph
of <m>D(\alpha)</m> is nearly horizontal\aside{This is Fermat's Theorem
  coming into play again.} for values of <m>\alpha</m> near <m>1.03</m> the
amount of deviation is roughly the same for those values of <m>\alpha</m>.
</p>
<p>


This is pertinent because it means that the lower the deviation angle
the more concentrated that light rays exiting the raindrop. So the
light rays entering the raindrop at approximately <m>59^\circ</m> have the
highest concentration when exiting the raindrop.  At other values of
<m>\alpha</m> the light is more diffused.  It is these concentrated light
rays that we see as a rainbow.
</p>
<p>


The angle supplementary to <m>D(\alpha)</m> is called the <term>rainbow
  angle</term>, denoted <m>R(\alpha)</m>. Thus
<me>
R(\alpha)=\pi-D(\alpha)=\pi-(\pi-4\beta+2\alpha)=4\beta-2\alpha\text{
  radians.}
</me>
</p>

<figure>
<caption>
<url href="https://en.wikipedia.org/wiki/Leo_Tolstoy" visual="https://en.wikipedia.org/wiki/Leo_Tolstoy">This figure needs a caption.</url>
</caption>
<image source="images/Rainbow4.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[8]{r}{2.5in} -->
<!--   \captionsetup{labelformat=empty} \vskip-3mm  -->
<!--   \centerline{\includegraphics*[height=1.25in,width=2.5in]{../Figures/Rainbow4}} -->
<!-- \end{wrapfigure} -->
<p>

The rainbow angle is also the angle that the rainbow makes with the
eye of an observer, relative to the angle of
the sun.  For white light we have a rainbow angle of
<me>
R(1.03)=\pi-2.41\approx0.732 \text{ radians }\approx42^\circ
</me>
as seen at the right.
</p>
<p>

So you will see a rainbow when the air is filled with water droplets,
for example immediately after a rain, and the sun is behind you.
Relative to the sun's rays the
angle from your eye to the top of the rainbow will be about
<m>42^\circ</m>.  Every droplet reflects and refracts each ray of light
entering it. The aggregation of all of those rays is the rainbow.
</p>
<p>

Of course, rainbows will manifest under other circumstances too, but
we have not analyzed those.
</p>


</subsection>
<subsection xml:id="SUBSECTIONRainbow">
<title>The Colors of the Rainbow</title>

<figure>
<caption>
<url href="https://en.wikipedia.org/wiki/Leo_Tolstoy" visual="https://en.wikipedia.org/wiki/Leo_Tolstoy">This figure needs a caption.</url>
</caption>
<image source="images/DarkSideOfTheMoon.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[13]{l}{1.75in} -->
<!--   \vskip-4mm  -->
<!--       \centerline{\includegraphics*[height=1.75in,width=1.75in]{../Figures/DarkSideOfTheMoon}} -->
<!--   \centerline{\textcolor{blue}{\pubtitle{\small The Dark Side of the -->
<!--         Moon},}} -->
<!--     \centerline{\textcolor{blue}{Pink Floyd}} -->
<!--   \label{fig:DarkSideOfTheMoon} -->
<!-- \end{wrapfigure} -->
<p>

The color spread in a rainbow occurs because the index of refraction
<m>k</m>, changes with the frequency (color) of the light.  This can be
seen by shining a beam of light through a triangular prism or, by
listening to rock music from the 1970s.
</p>
<p>

Of course we can only do so much by reasoning from graphs and
pictures. If we want to nail things down very precisely (we do), we
will eventually need to look at the problem analytically by minimizing
an objective function. Fortunately, we already have our objective
function. It is <m>D(\alpha)</m>. Our constraint comes from Snell's Law,
<m>\sin(\alpha)=k\sin(\beta)</m>. We said that the general parameter <m>k</m>
would depend on the frequency of the light\aside{ And the physical
  properties of the media the light is passing through, but we'll only
  consider water and air.} and we've observed that for water and air
<m>k=\frac43</m>. Rather
than graphing the function for different values of <m>k</m> we'll just
leave it as an arbitrary constant while we calculate.  Afterward we
can substitute specific values as needed.
</p>


<problem>
<statement>

<p>
  Differentiate the objective function, <m>D(\alpha)</m>, and the
  constraint, <xref ref="EQUATIONSnellConstraint"></xref>, and use Fermat's
  Theorem (<xref ref="THEOREMFermatsTheorem">~</xref>) to show that when <m>D</m> is
  a minimum
  <me>
    \label{eq:MinimumDeflect}
    \cos(\alpha)=\frac{k}{2}\cos(\beta).
</me>
</p>
</statement>
</problem>
<p>

Combining <xref ref="EQUATIONMinimumDeflect"></xref> with our constraint, we
see that we need to solve the following system of two equations in two
unknowns,
\begin{align*}
  \cos(\alpha)\amp =\frac{k}{2}\cos(\beta)\\
  \sin(\alpha)\amp =k\sin(\beta).
\end{align*}
</p>
<p>

Normally to solve such a system, we would use one of the equations to
eliminate one of the variables in the other equation.  We could do
that here but it would require some very messy expressions involving
inverse trigonometric functions. Instead there is a trick that will be
cleaner.
</p>
<p>
Suppose we square the quantities in each equation and then add the
resulting equations together. This gives
<me>
  \label{eq:TrigTrick}
  1=\sin^2(\alpha)+\cos^2(\alpha)=\frac{k^2}{4}\cos^2(\beta)+k^2\sin^2(\beta).
</me>
You might want to file this trick away in your memory. When
Trigonometry is involved it is a good idea to look for, or to create,
sums of the squares of sines and cosines.
</p>

<problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Use <xref ref="EQUATIONTrigTrick"></xref> to show that for a given
    index of refraction <m>k</m>, <m>D(\alpha)</m> is minimized when
    <m>\sin(\beta)=\sqrt{\frac{4-k^2}{3k^2}}</m> and
    <m>\sin(\alpha)=\sqrt{\frac{4-k^2}{3}}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Use this to complete the following table:
    \begin{center}
      \begin{tabular}{|c|c|c|c|c|c|c|} \hline Color\amp  <m>k</m>\amp
        <m>\beta</m> in degrees\amp <m>\alpha</m> in degrees\amp <m>D(\alpha)</m>
        in degrees\amp <m>R(\alpha)</m> in degrees\\\hline
        Red   \amp 1.331\amp \amp \amp \amp \\
        Orange\amp 1.332\amp \amp \amp \amp \\
        Yellow\amp 1.333\amp \amp \amp \amp \\
        Green \amp 1.335\amp \amp \amp \amp \\
        Blue  \amp 1.337\amp \amp \amp \amp \\
        Indigo\amp 1.340\amp \amp \amp \amp \\
        Violet\amp 1.344\amp \amp \amp \amp \\\hline
      \end{tabular}
    \end{center}
  </p>
</statement>
</task>
<task>
<statement>
<p>
 How does this explain the order of the colors in the primary
    rainbow?
  </p>
</statement>
</task>
</problem>
<problem>
<statement>
<p>
  Differentiate the objective function, <m>D(\alpha)</m>, and the
  constraint, <xref ref="EQUATIONSnellConstraint"></xref>, and use Fermat's
  Theorem (<xref ref="THEOREMFermatsTheorem">~</xref>) to show that when <m>D</m> is
  a minimum
  <me>
    \label{eq:MinimumDeflect}
    \cos(\alpha)=\frac{k}{2}\cos(\beta).
</me>
</p>
</statement>
</problem>
<p>

Combining <xref ref="EQUATIONMinimumDeflect"></xref> with our constraint, we
see that we need to solve the following system of two equations in two
unknowns,
\begin{align*}
  \cos(\alpha)\amp =\frac{k}{2}\cos(\beta)\\
  \sin(\alpha)\amp =k\sin(\beta).
\end{align*}
</p>
<p>

Normally to solve such a system, we would use one of the equations to
eliminate one of the variables in the other equation.  We could do
that here but it would require some very messy expressions involving
inverse trigonometric functions. Instead there is a trick that will be
cleaner.
</p>
<p>

Suppose we square the quantities in each equation and then add the
resulting equations together. This gives
<me>
  \label{eq:TrigTrick}
  1=\sin^2(\alpha)+\cos^2(\alpha)=\frac{k^2}{4}\cos^2(\beta)+k^2\sin^2(\beta).
</me>
You might want to file this trick away in your memory. When
Trigonometry is involved it is a good idea to look for, or to create,
sums of the squares of sines and cosines.
</p>


<problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Use <xref ref="EQUATIONTrigTrick"></xref> to show that for a given
    index of refraction <m>k</m>, <m>D(\alpha)</m> is minimized when
    <m>\sin(\beta)=\sqrt{\frac{4-k^2}{3k^2}}</m> and
    <m>\sin(\alpha)=\sqrt{\frac{4-k^2}{3}}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Use this to complete the following table:
    \begin{center}
      \begin{tabular}{|c|c|c|c|c|c|c|} \hline Color\amp  <m>k</m>\amp
        <m>\beta</m> in degrees\amp <m>\alpha</m> in degrees\amp <m>D(\alpha)</m>
        in degrees\amp <m>R(\alpha)</m> in degrees\\\hline
        Red   \amp 1.331\amp \amp \amp \amp \\
        Orange\amp 1.332\amp \amp \amp \amp \\
        Yellow\amp 1.333\amp \amp \amp \amp \\
        Green \amp 1.335\amp \amp \amp \amp \\
        Blue  \amp 1.337\amp \amp \amp \amp \\
        Indigo\amp 1.340\amp \amp \amp \amp \\
        Violet\amp 1.344\amp \amp \amp \amp \\\hline
      \end{tabular}
    \end{center}
  </p>
</statement>
</task>
<task>
<statement>
<p>
 How does this explain the order of the colors in the primary
    rainbow?
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate} -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Use <xref ref="EQUATIONTrigTrick"></xref> to show that for a given -->
<!--     index of refraction <m>k</m>, <m>D(\alpha)</m> is minimized when -->
<!--     <m>\sin(\beta)=\sqrt{\frac{4-k^2}{3k^2}}</m> and -->
<!--     <m>\sin(\alpha)=\sqrt{\frac{4-k^2}{3}}</m>. -->
<!--   \item Use this to complete the following table: -->
<!--     \begin{center} -->
<!--       \begin{tabular}{|c|c|c|c|c|c|c|} \hline Color\amp  <m>k</m>\amp -->
<!--         <m>\beta</m> in degrees\amp <m>\alpha</m> in degrees\amp <m>D(\alpha)</m> -->
<!--         in degrees\amp <m>R(\alpha)</m> in degrees\\\hline -->
<!--         Red   \amp 1.331\amp \amp \amp \amp \\ -->
<!--         Orange\amp 1.332\amp \amp \amp \amp \\ -->
<!--         Yellow\amp 1.333\amp \amp \amp \amp \\ -->
<!--         Green \amp 1.335\amp \amp \amp \amp \\ -->
<!--         Blue  \amp 1.337\amp \amp \amp \amp \\ -->
<!--         Indigo\amp 1.340\amp \amp \amp \amp \\ -->
<!--         Violet\amp 1.344\amp \amp \amp \amp \\\hline -->
<!--       \end{tabular} -->
<!--     \end{center} -->
<!--   \item How does this explain the order of the colors in the primary -->
<!--     rainbow? -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->
<p>
The values of <m>R(\alpha)</m> you obtained in the table account for the
various color bands that appear in the rainbow as sunlight hits
droplets at various angles.
</p>

</subsection>
<subsection xml:id="SUBSECTIONDoubleRainbows">
<title>Double Rainbows</title>

<figure>
<caption>
<url href="https://en.wikipedia.org/wiki/Leo_Tolstoy" visual="https://en.wikipedia.org/wiki/Leo_Tolstoy">This figure needs a caption.</url>
</caption>
<image source="images/Droplet2.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[]{r}{3in} -->
<!-- \captionsetup{labelformat=empty} -->
<!-- \centerline{\includegraphics*[height=2.3in,width=3in]{../Figures/Droplet2}} -->
<!-- \label{fig:Droplet2} -->
<!-- \end{wrapfigure} -->
<p>

In a double rainbow the primary rainbow is created from light entering
the upper portion of the droplet and exiting from the bottom. If light
is bright enough then a secondary rainbow is created from light
entering the lower portion and exiting the upper portion of the
droplet as in
the diagram below.
</p>
<p>


For the secondary rainbow the deviation angle <m>D(\alpha)</m> is the total
amount of counterclockwise rotation and the rainbow angle would
be <m>R(\alpha)=D(\alpha)-\pi</m>.  Note that the extra reflection explains
why the secondary rainbow is not as bright as the primary.
</p>
<p>

</p>


<problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Show that in the case of the secondary rainbow,
    <m>D(\alpha)=2\pi+2\alpha-6\beta</m>. This is our objective function
    for the secondary rainbow.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that <m>D(\alpha)</m> is minimized when
    <m>\sin(\beta)=\sqrt{\frac{9-k^2}{8k^2}}</m> and
    <m>\sin(\alpha)=\sqrt{\frac{9-k^2}{8}}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Use this to complete the following table:
        \begin{center}
      \begin{tabular}{|c|c|c|c|c|c|c|} \hline Color\amp  k\amp
        <m>\beta</m> in degrees\amp <m>\alpha</m> in degrees\amp <m>D(\alpha)</m>
        in degrees\amp <m>R(\alpha)</m> in degrees\\\hline
        Red\amp 1.331\amp \amp \amp \amp \\
        Orange\amp 1.332\amp \amp \amp \amp \\
        Yellow\amp 1.333\amp \amp \amp \amp \\
        Green\amp 1.335\amp \amp \amp \amp \\
        Blue\amp 1.337\amp \amp \amp \amp \\
        Indigo\amp 1.340\amp \amp \amp \amp \\
        Violet\amp 1.344\amp \amp \amp \amp \\\hline
      \end{tabular}
    \end{center}
      </p>
</statement>
</task>
<task>
<statement>
<p>
 Use the table in part (c) of this problem and the table in the
    previous problem to explain why the secondary rainbow is above the
    primary rainbow and its colors are reversed.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate} -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Show that in the case of the secondary rainbow, -->
<!--     <m>D(\alpha)=2\pi+2\alpha-6\beta</m>. This is our objective function -->
<!--     for the secondary rainbow. -->
<!--   \item Show that <m>D(\alpha)</m> is minimized when -->
<!--     <m>\sin(\beta)=\sqrt{\frac{9-k^2}{8k^2}}</m> and -->
<!--     <m>\sin(\alpha)=\sqrt{\frac{9-k^2}{8}}</m>. -->
<!--   \item Use this to complete the following table: -->
<!--         \begin{center} -->
<!--       \begin{tabular}{|c|c|c|c|c|c|c|} \hline Color\amp  k\amp  -->
<!--         <m>\beta</m> in degrees\amp <m>\alpha</m> in degrees\amp <m>D(\alpha)</m> -->
<!--         in degrees\amp <m>R(\alpha)</m> in degrees\\\hline -->
<!--         Red\amp 1.331\amp \amp \amp \amp \\ -->
<!--         Orange\amp 1.332\amp \amp \amp \amp \\ -->
<!--         Yellow\amp 1.333\amp \amp \amp \amp \\ -->
<!--         Green\amp 1.335\amp \amp \amp \amp \\ -->
<!--         Blue\amp 1.337\amp \amp \amp \amp \\ -->
<!--         Indigo\amp 1.340\amp \amp \amp \amp \\ -->
<!--         Violet\amp 1.344\amp \amp \amp \amp \\\hline -->
<!--       \end{tabular} -->
<!--     \end{center} -->
<!--       \item Use the table in part (c) of this problem and the table in the -->
<!--     previous problem to explain why the secondary rainbow is above the -->
<!--     primary rainbow and its colors are reversed. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->





</subsection>
</section>
<section xml:id="SECTIONmore-optimal-squares">
<title>Global vs. Local Extrema</title>

<p>
So far in this chapter we've relied heavily on our intuition. For
instance, in <xref ref="EXAMPLESqOnLine">Example</xref> it was very clear that a
minimal square exists. Moreover, when we differentiated the objective
function we found that <m>x=-\frac12</m> was the only solution of
<m>\dfdx{A}{x}=0</m>. So it was reasonable to conclude that the minimum
occurs when <m>x=-\frac12</m>.
</p>

<p>
Similarly in <xref ref="PROBLEMEllipseDist">Problem</xref> it was intuitively
clear that there was both a maximal and a minimal square, so when
we found two solutions of <m>\dfdx{A}{x}=0</m> it made sense to conclude
that they correspond to the maximal and minimal squares, respectively.
</p>

<p>
Unfortunately things are rarely this straightforward.  Consider the
following example.
</p>

<example xml:id="EXAMPLEParabolaOptSqr">
<title>Constructing a Square on a Parabola</title>
<p>
  We would like to find the area of the smallest square which can be
  constructed with one corner at the point <m>(2,3)</m> and an adjacent
  corner on the graph of <m> y = x^2</m>.  This example is very similar to
  <xref ref="PROBLEMMinSqLine">Problem</xref> or <xref ref="PROBLEMEllipseDist">Problem</xref>
  so we will proceed in much the same way.  The objective function is
  the same
  <me>
    \label{eq:ParabolaObjective}
    A = (x-2)^2 + (y-3)^2
</me>
  but this time the constraint is
  <me>
    \label{eq:ParabolaConstraint}
    y = x^2.
</me>
</p>
<p>
  
  In our previous examples we began by differentiating both the
  objective function and the constraint. This time substitute the
  constraint <m>y=x^2</m> into <m>A(x)</m> to obtain the objective function
  <me>
  A(x) = (x-2)^2 + (x^2-3)^2
  </me>
  in terms of a single variable. We make this change of strategy
  simply to demonstrate that the two procedures are equivalent.  In
  fact, for this particular problem they are almost identical. For
  more complex problems you may find that you prefer one strategy or
  the other.
</p>
</example>
  <exercise xml:id="DRILLSqParab">
<statement>
<p>
    Show that <m>\dfdx{A}{x}=0</m> when <m>x \approx1.75</m>, <m>x \approx-1.32</m>
    and <m>x \approx-0.43</m>.  Getting three distinct solutions of
    <m>\dfdx{A}{x}=0</m> is quite unexpected in light of our previous work.
    Can you explain this?
  </p>
</statement>
</exercise>


<image source="images/ParabolaThreeSquares.png" width="50%"/>
<!-- \begin{wrapfigure}[15]{r}{2.7in} -->
<!--     \captionsetup{labelformat=empty} -->
<!--     \centerline{\includegraphics*[height=2.5in,width=2.7in]{../Figures/ParabolaThreeSquares}} -->
<!--     \label{fig:ParabolaThreeSquares} -->
<!--   \end{wrapfigure} -->

<p>  
  To find the minimal square in <xref ref="DRILLSqParab"></xref> we
  need only substitute the <m>x</m>-values into <m>A(x)</m>. We get
  \begin{align*} \textcolor{darkpastelgreen}{A(1.75)} \amp
  \textcolor{darkpastelgreen}{\approx 0.07},\\
  \textcolor{violet}{A(-1.32)}\amp \textcolor{violet}{\approx 12.6},\\
  A(-0.43)\amp \approx 13.83.  \end{align*} From these numbers, and
  from the sketch at the right, we can see that the minimal square
  seems to be the one whose second corner lies on the parabola at the
  point (approximately) <m>(1.75, 3.06)</m>. But those other two
  solutions of <m>\dfdx{A}{x}=0</m> are troubling.  Do we get a
  maximal square at <m>\left(-0.43,(-0.43)^2\right)</m> since
  <m>A(-0.43) \approx 13.83</m> is the largest value of <m>A(x)</m>
  among the three we've identified. And what about the point
  <m>(-1.32, 1.32^2)</m>?  We clearly get neither a minimum nor a
  maximum. Why did our solution procedure point to it? This is all
  very puzzling.
</p>
  
<image source="images/ParabolaThreeSquares2.png" width="50%"/>
<!-- \begin{wrapfigure}[14]{l}{2.5in} -->
<!--     \captionsetup{labelformat=empty} \vskip-4mm  -->
<!--     \centerline{\includegraphics*[height=2.2in,width=2.5in]{../Figures/ParabolaThreeSquares2}} -->
<!--     \label{fig:ParabolaThreeSquares2} -->
<!--   \end{wrapfigure} -->

<p>
  To begin addressing these questions let's look at the graph of our
  objective function, <m>A(x) = (x-2)^2 + (x^2-3)^2</m>.  The first
  coordinate of each point on the graph at the left corresponds to the
  <m>x</m>-coordinate of the corner of a square which lies on the
  constraint, <m>y=x^2</m>, and the second coordinate on the graph is the
  area of that square. Thus the minimal square will correspond to the
  lowest point on the graph at the left which is the square with a
  second corner at <m>x=1.75</m> as we have already concluded.  But since
  the graph at the left continues to rise as we look farther to the
  right (or left) it should also be clear that there is no maximal
  square.
</p>

<p>
  This graph also explains the why our procedure identified the
  squares with a second corner at both <m>x=-1.32</m> and <m>x=-0.43</m> as
  possible minimal squares as well.  When we solve <m>\dfdx{A}{x}=0</m> we
  are locating the points on the graph of our objective function where
  its derivative is zero. That is, where the slope of the line tangent
  is horizontal. Fermat's Theorem only assures us that if <m>A(x)</m> has
  an extremum at <m>x=a</m> then <m>\dfdxat{A}{x}{a}=0</m>. In particular it
  does not tell us that there are no other values of <m>x</m> where
  <m>\dfdx{A}{x}=0</m>.
</p>


<image source="images/ParabolaThreeSquares4.png" width="50%"/>
<!-- \begin{wrapfigure}[19]{l}{1.5in} -->
<!--     \captionsetup{labelformat=empty} \vskip-4mm  -->
<!--     \centerline{\includegraphics*[height=3in,width=1.5in]{../Figures/ParabolaThreeSquares4}} -->
<!--     \label{fig:ParabolaThreeSquares3} -->
<!--   \end{wrapfigure} -->

<p>
  The problem here is that we have not been precise in our
  language. When we say <q>maximum</q> (or minimum) in ordinary speech we
  mean <q>the largest one,</q> and it is clear that there can only be one
  <q>largest\aside{Although it can occur more than once, at different
    places. Think about the graph of <m>y=\sin(x).</m>}.</q>
</p>
<p>

  However, if we confine our attention to the part of the graph inside
  the blue rectangle at the left we see that the point at
  <m>(-1.32, 12.6)</m> is a minimum <alert>locally</alert> and the point at
  <m>(-0.43, 13.83)</m> is a maximum <alert>locally</alert>. By <q>locally</q> we
  mean <q>if we restrict our attention to the graph near those two
  points</q> as seen at the right. We will need to distinguish between
  local and global optima in the future.
</p>
<p>

  There are other issues as well.
</p>
<p>

  Recall from <xref ref="DIGRESSIONTangentHasNoInverse">Digression~\</xref> that a
  function has two parts:
  \begin{enumerate}
  \item A rule to associate input with output, and
  \item A domain.
  \end{enumerate}
  Change either of these and you have a different function.
</p>
<p>

  In this example our objective function is
<me>
    \label{eq:ParabolaSquareDomainR}
    A(x) =
    (x-2)^2 + (x^2-3)^2
</me>
    and the constraint is
    <me>
    y=x^2, \text{ with domain }\RR.
</me>
  But suppose we change the constraint to
  <me>
    \label{eq:ParabolaSquareConstraintRestricted}
    y=x^2, \text{ with domain }-2\le x\le 0.5, \text{ (the part inside
      the blue rectangle).}}
</me>
</p>
<p>

  We now have a different problem because the only part of the graph
  we are interested in is the piece inside the blue rectangle. The
  global minimum no longer occurs at <m>x\approx1.75</m> because <m>1.75</m> is
  not in the problem domain, <m>x\approx1.75</m> simply
  doesn't exist in the domain of the function <m>y=x^2</m>,  with
    domain; <m>-2\le x\le 0.5</m>.  However, since <m>x=-0.43</m> and <m>x=-1.32</m> are in the
  domain they still correspond to a local maximum and a local minimum,
  respectively. Are they also the global maximum and minimum?  Give
  this question some thought and take your best guess. We will return
  to it in <xref ref="PROBLEMParabolaSquare-Redux">Problem~\</xref>.
</p>


<image source="images/LocalGlobalDef.png" width="50%"/>
<!-- \begin{wrapfigure}[13]{r}{3in} -->
<!-- \captionsetup{labelformat=empty} -->
<!-- \centerline{\includegraphics*[height=2in,width=3in]{../Figures/LocalGlobalDef}} -->
<!-- \label{fig:LocalGlobalDef} -->
<!-- \end{wrapfigure} -->
<p>

The existence of local extrema really complicates things for us
because it means we have to find all of the <term>local</term> extrema and
then figure out which of them, if any, are global.  If we don't get
organized we're likely to have a lot of trouble keeping this all
straight.
</p>
<p>

In the sketch at the right <m>y(a)</m> is the <term>global</term> minimum of <m>y</m>
since it is the lowest point on the graph of <m>y(x)</m>, whereas <m>y(c)</m> is
a local minimum because it is the lowest point on the graph when the
domain of <m>y(x)</m> is restricted to the interval <m>(c-\eps, c+\eps)</m>
(between the dashed lines).  In this sketch the global maximum of
<m>y(x)</m> occurs at the endpoints of the interval, <m>\alpha</m> and <m>\beta</m>.
The fact that extrema can also occur at endpoints is a complicating
detail we will come back to shortly.
</p>
<p>

Since the domain of the function affects the location of the extrema a
definition of extrema  will
need to reference the function's domain. It is easy to get lost in the technicalities so keep
<xref ref="EXAMPLEParabolaOptSqr">Example~\</xref> in mind as we proceed.
</p>
<p>
We have the following definitions.
</p>

<definition xml:id="DEFINITIONGlobalMin">
<title>Global Minimum</title>
<statement>
<p>
  Suppose that <m>g</m> is a number in the domain of <m>y</m> such
  that\aside{The phrase <q>such that</q> is a term of art in
    mathematics. It means, <q>with the following property.</q>}
  <m>y(g)\le y(x)</m> for every <m>x</m> in the domain of <m>y</m>.  Then <m>y(g)</m> is
  the <term>global minimum</term> of <m>y</m>.

</p>
</statement>
</definition>

<problem xml:id="PROBLEMMaximaDefinition">
<statement>
<p>
  Provide a definition of Global Maximum modeled on
  <xref ref="DEFGlobalMin">Definition~\</xref>.
</p>
</statement>
</problem>

<p>
To define local extrema we need the concept of an open interval, so we
 digress briefly.
</p>
<aside>
<title>Note to self</title>
<p>
Digression missing.
</p>
</aside>

<!-- \begin{Digression}[Interval Notation] -->
<!--   \label{digress:IntervalNotation} -->
<!--   An <term>interval</term> is a contiguous set of real numbers. For example, -->
<!--   the set of numbers strictly between zero and one is an -->
<!--   interval. Because the endpoints are not included it is called an -->
<!--   <term>open interval</term> and is denoted by <m>(0,1)</m>. Think of this -->
<!--   notation as an abbreviation of the the two inequalities -->
<!--   <me> -->
<!--   0\lt x \text{ and } x\lt1 \text{ (also abbreviated sometimes as -->
<!--     <m>0\lt x\lt1</m>) } </me> -->
<!--         Be careful. This notation can be ambiguous. Without some context it -->
<!--   is not clear whether the notation <m>(a,b)</m> represents the open interval satisfying the inequalities -->
<!--   <m> -->
<!--   a\lt x \lt b</m>, or the  point <m>(a,b)</m> in the -->
<!--   <m>x</m>-<m>y</m> plane. -->
<!-- </p> -->
<!-- <p> -->

<!-- <p> -->
<!--   If we include the endpoints we have a <term>closed interval</term>, -->
<!--   denoted by the ordered pair <m>[a,b]</m>.  Think of this as an -->
<!--   abbreviated form of the two inequalities -->
<!--   <me> -->
<!--   a\le x \text{ and }x\le b \text{ (also abbreviated sometimes as -->
<!--     <m>a\le x\le b</m>) }. -->
<!--   </me> -->
<!-- </p> -->
<!-- </p> -->
<!-- <p> -->

        

  
<!-- <exercise> -->
<!--   <introduction> -->
<!--     <p> -->
<!--       Re-express each of the following intervals using inequalities and -->
<!--       state whether it is open, closed, or neither. -->
<!--     </p> -->
<!--   </introduction> -->
<!--   <task> -->
<!--     <statement> -->
<!--       <p> -->
<!--         <m>(-1,1)</m> -->
<!--       </p> -->
<!--     </statement> -->
<!--   </task> -->
<!--   <task> -->
<!--     <statement> -->
<!--       <p> -->
<!--         <m>[-1,1]</m> -->
<!--       </p> -->
<!--     </statement> -->
<!--   </task> -->
<!--   <task> -->
<!--     <statement> -->
<!--       <p> -->
<!--         <m>[-10,25)</m> -->
<!--       </p> -->
<!--     </statement> -->
<!--   </task> -->
<!--   <task> -->
<!--     <statement> -->
<!--       <p> -->
<!--         <m>(-32,100]</m> -->
<!--       </p> -->
<!--     </statement> -->
<!--   </task> -->
<!-- </exercise> -->
<!-- begin{ProficiencyDrill} -->
  <!--   Re-express each of the following intervals using inequalities and -->
  <!--   state whether it is open, closed, or neither. -->
  <!--   \begin{enumerate}[label={  (\alph*)}]  -->
  <!--     \item <m>(-1,1)</m> -->
  <!--     \item <m>[-1,1]</m> -->
  <!--     \item <m>[-10,25)</m> -->
  <!--     \item <m>(-32,100]</m> -->
  <!--   \end{enumerate} -->
  <!-- \end{ProficiencyDrill} -->

<!-- <p> -->

<!--   If we want to identify the interval of all numbers greater than, say -->
<!--   <m>x=1</m> there is no right endpoint of the interval. Rather than -->
<!--   writing this out in words every time we encounter it (which will be -->
<!--   often) we force our notation to adapt to our need and denote this -->
<!--   interval as: <m>(1, \infty)</m>. Similarly the interval of all numbers -->
<!--   less than or equal to <m>7</m> is denoted: <m>(-\infty, 7]</m>. We've been -->
<!--   using the symbol <q><m>\RR</m></q> to denote all real numbers, but since the -->
<!--   set of all real numbers is a (very large) interval we will sometimes -->
<!--   use the interval notation, <m>(-\infty, \infty)</m> as well. -->
<!-- </p> -->
<!-- <p> -->

<!--   Do not be fooled by this. <q>Infinity</q> (<m>\infty</m>) is not a number -->
<!--   and cannot be treated like one. This is just a notational shorthand -->
<!--   that we use for our own convenience. -->
<!-- </p> -->

<!--         \end{Digression} -->
<p>
Now we can define local extrema.
</p>

<definition xml:id="DEFINITIONLocalMin">
<title>Local Minimum</title>
<statement>
<p>
  <!-- \label{def:LocalMin} -->
  Suppose that <m>l</m> is a number in the domain of <m>y(x)</m>. Then <m>y(l)</m> is
  a <term>local minimum</term> of <m>y</m> if there is an open interval, <m>I</m>, such
  that <m>y(l)\le y(x)</m> for every <m>x</m> in the interval <m>I</m> and in the
  domain of <m>y(x)</m>.

</p>
</statement>
</definition>

<problem xml:id="PROBLEMLocalMaximaDefinition">
<statement>
<p>
  Provide a definition of Local Maximum modeled on
  <xref ref="DEFLocalMin">Definition~\</xref>.
</p>
</statement>
</problem>


  
<exercise>
<statement>
<p>
  Explain why we can find a <term>global</term> maximum (minimum) by finding
  all of the <term>local</term> maxima (minima) and selecting the largest
  (smallest) among these.
</p>
</statement>
</exercise>




</section>
<section xml:id="SUBSECTIONoptim-abstr-probl">
<title>Optimization, the Abstract Problem</title>

<introduction>
<p>

As we saw in <xref ref="EXAMPLEParabolaOptSqr">Example~\</xref> once we've found
the objective function, <m>O(x)</m>, our optimization problem becomes the
more abstract problem of finding the extreme points of the graph of
<m>O(x)</m>. An optimization problem ultimately comes down to finding all
of the local extrema. The maximum among those will be the global
maximum, and the minimum among those will be the global
minimum. Assuming of course, that either exists.
</p>
<p>
  
Thus our first task is to identify all of the local extrema.  But
finding the local extreme points of the graph of an arbitrary
objective function can be more complicated than we've seen in any of
our examples so far. In this section we will address these
complications. By the end of the section we will have a general
procedure for solving this more abstract optimization problem.
</p>
</introduction>

<subsection>
<title>Identifying and Distinguishing Maxima and Minima</title>
<p>

Use your favorite graphing utility to graph the function
<m> O(x)=x^3-3x </m> and confirm visually that it has a local maximum at
<m>(-1, 2)</m>, and a local minimum at <m>(1,-2)</m>.  This seems to be easy to
do when we have the graph in front of us.  But in the absence of a
graph how could we tell which is the maximum and which is the minimum?
</p>
<p>

  Sometimes even having the graph isn't much help. For example, see if
  you can visually identify the global maximum and global minimum of
  the graph of
  <me>
  O(x)=(x^4-17x^3+239x)\sin(2x),\; 10\le x\le20.
  </me>
</p>
<p>
  
  We'll need an analytic method; one that doesn't rely on pictures.
  To that end, consider the following theorem from elementary Algebra.
</p>

<theorem xml:id="THEOREMFDT-lines">
<p>
<ol>
  <li>
    <p>
      If a line has positive slope then the <m>y</m> coordinate  increases as the <m>x</m> coordinate increases.
    </p>
  </li>
  <li>
    <p>
      If a line has negative slope then the <m>y</m> coordinate  decreases as the <m>x</m> coordinate increases.
    </p>
  </li>
</ol>
</p>
</theorem>

<p>
  Lines are easy to think about of course, because the slope of a line
  is constant. If the slope of a line is <m>5</m> here, then it is also <m>5</m>
  over there, and way back there too. But we know that the slope of a
  curve can change from point to point so we will need to generalize
  <xref ref="THEOREMFDT-lines">Theorem</xref> to a statement about curves.
  <xref ref="THEOREMFDT-lines">Theorem~\</xref> generalizes to curves as follows.
</p>

<theorem xml:id="THEOREMFDT">
  <title>The First Derivative Test</title>
  <p>
    Suppose <m>f</m> is a function of <m>x</m>.  The following statements are
    true\aside{This is a rather naive statement of this theorem, but
    it will suffice for our current purposes. We will revisit,
    restate, and prove the First Derivative Test in
    <xref ref="SECfirst-deriv-test">Section</xref>}:
    <ol>
      <li>
        <p>
          If <m>f^\prime(a)\gt 0</m>, on some interval then <m>f(x)</m> is    increasing on the interval.
        </p>
      </li>
      <li>
        <p>
          If <m>f^\prime(a)\lt 0</m>, on some interval then <m>f(x)</m> is    decreasing on the interval.
        </p>
      </li>
    </ol>
  </p>
</theorem>


  
  <p>
  The First Derivative test is precisely the tool we need to
  distinguish a maximum from a minimum.  It will also turn out to be
  the tool that will allow us to determine via computation, rather
  than intuition, if a given objective function has a maximum or
  minimum.  Take a moment to think about how this might be done before
  reading further.
</p>


</subsection>
<subsection xml:id="SUBSECTIONTransitionPoints">
<title>Transition Points, and Possible Transition Points on
    Open Intervals</title>

<p>

  For the moment notice that we are confining our attention to
  functions whose domains are open intervals.
</p>
<p>
  
  From <xref ref="THEOREMFDT">Theorem</xref> we see that if the derivative of <m>O(x)</m>
  is positive then <m>O(x)</m> is increasing and if the derivative of
  <m>O(x)</m> is negative then <m>O(x)</m> is decreasing. So, at a maximum
  <m>O(x)</m> will transition from increasing to decreasing, and
  <m>O^\prime(x)=\dfdx{O}{x}</m> will transition from positive to
  negative. We conclude that to find a maximum we need to find those
  places where the derivative transitions from positive to negative.
</p>
<p>


  Similarly, to find a local minimum, we need to find a place where
  the derivative transitions from negative to positive.  We call such
  points <term>optimal transition points</term> because they are the places
  where (local) optima must occur.
</p>
<p>

  The simplest way for <m>O^\prime(x)=\dfdx{O}{x}</m> to make either
  transition is for it to pass through zero. Thus the solutions of
  <m>O^\prime(x) = \dfdx{O}{x} =0</m> are <term>possible optimal transition
    points (POTPs)</term> because these are points where and optimum might
  occur. This is not guaranteed.
</p>
<p>
  
  In the simplest case all we have to do is find the solutions of
  <m>O^\prime(x)=\dfdx{O}{x}</m>, then determine the sign of the derivative
  on either side of each such point. If it changes then we have a
  local extremum.
</p>
<p>

</p>

  <exercise xml:id="DRILLTransitionQuestion">
<statement>
<p>
    <!-- \label{drill:TransitionQuestion} In the paragraph above we used -->
    the phrase <q>in the simplest case.</q> We chose our words
    carefully. Can you think of another way for
    <m>O^\prime(x) =\dfdx{O}{x}</m> to transition from positive to
    negative, or from negative to positive?  Give this some
    thought. We will come back to it.
  </p>
</statement>
</exercise>
<p>
  The POTPs which are solutions of <m>\dfdx{O}{x}=0</m> are the easiest to
  think about and work with so we will focus on those for
  now. Unfortunately, extrema can sometimes occur at other points as
  well. We will address that possibility once we have thoroughly
  examined this simpler case.
</p>
  <example xml:id="EXAMPLEPPT">
<p>
    Let <m>O(x)=x^3-3x</m>.  The solutions of <m>\dfdx{O}{x}=3x^2-3=0</m> are
    <m>x=-1</m> and <m>x=1</m> so these are the POTPs.  Sketch the graph of
    <m>O(x)</m> and follow along with our reasoning below, confirming our
    conclusions visually.
</p>
<p>
    To determine if they actually are transition points we proceed as
    follows:
    \begin{description}
    \item[At \boldmath <m>x=-1</m>:] Pick a number less than <m>-1</m>, say
      <m>x=-2.</m> Since <m>\dfdxat{O}{x}{-2}\gt 0</m> we see that <m>O(x)</m> is
      increasing to the left of <m>x=-1.</m> Next pick a number between
      <m>-1</m> and the next POTP, <m>x=1</m>. We'll take <m>x=0</m>. Since
      <m>\dfdxat{O}{x}{0}\lt0</m> we see that <m>O(x)</m> is decreasing to the
      right of <m>x=-1</m>. Thus <m>O(-1) =2</m> is a local maximum value of
      <m>O(x)</m>.
    \item[At \boldmath  <m>x=1</m>:] % Pick a number between the previous
                  As we saw above <m>O(x)</m> is decreasing to the left of <m>x=1</m> since
      <m>\dfdxat{O}{x}{0}\lt0</m>. (Zero is between <m>x=-1</m> and <m>x=1</m>.) Next
      choose any number to the right of <m>x=1</m>. We'll choose
      <m>x=2</m>. Since <m>\dfdxat{O}{x}{2}\gt0</m> we see that <m>O(x)</m> is
      increasing to the right of <m>x=1</m>. Thus <m>O(1)=-2</m> is a local
      minimum of <m>O(x)</m>.
    \end{description}
</p>
<p>

  
    In this example we only tested one number between adjacent
    POTPs. Is that enough? Give this some thought before reading on.
</p>
<p>

    Of course it is. Consider that the POTPs are precisely those
    places where <m>O^\prime(x)</m> might change sign. Therefore the sign
    of <m>O^\prime(x)</m> must either be always positive or always negative
    in between POTPs. Therefore, we only need to test at one value of
    <m>x</m> to find the sign of <m>O(x)</m> on the entire interval between
    POTPs.
</p>
<p>

    If <m>a</m> is the greatest POTP we need only test the sign of one
    number greater than <m>a</m> to determine the sign of <m>O^\prime(x)</m> for
    every value of <m>x</m> greater than <m>a</m>.
</p>
<p>

    Similarly, if <m>a</m> is the least POTP we need only test the sign of
    one number less than <m>a</m> to determine the sign of <m>O^\prime(x)</m>
    for every value of <m>x</m> less than <m>a</m>.
</p>
<p>

    We state all of this formally in <xref ref="LEMMAAdjRoots">Lemma~\</xref>
    below.
</p>
  </example>

    <exercise>
<statement>
<p>
      Does the graph of <m>O(x)=x^3-3x</m> have a global maximum or
      minimum?  Explain.
    </p>
</statement>
</exercise>

<lemma xml:id="LEMMAAdjRoots">
  <p>
    Let <m>f(x)</m> be a differentiable function.
    
    <ol>
      <li>
        <p>
          Suppose <m>r_1</m> and <m>r_2</m> are two POTPs of <m>f(x)</m> such that
          there is not another POTP between them. If <m>f^\prime(x)\gt
          0</m> for some <m>x</m> in the domain of <m>f</m> between <m>r_1</m> and
          <m>r_2</m>, then <m>f^\prime(x)\gt 0</m> for every <m>x</m> in the domain
          of <m>f</m> between <m>r_1</m> and <m>r_2</m>. Similarly, if
          <m>f^\prime(x)\lt 0</m> for some <m>x</m> between <m>r_1</m> and <m>r_2</m>,
          then <m>f^\prime(x)\lt 0</m> for every <m>x</m> in the domain of <m>f</m>
          between <m>r_1</m> and <m>r_2</m>.
        </p>
      </li>
      <li>
        <p>
          Suppose <m>r_1</m> is the greatest POTP of <m>f(x)</m>. If
          <m>f^\prime(x)\gt0\; (\lt0)</m> for some <m>x\gt r_1</m> then
          <m>f^\prime(x)\gt 0\; (\lt0)</m> for all <m>x\gt r_1</m>, in the
          domain of <m>f</m>.
        </p>
      </li>
      <li>
        <p>
          Suppose <m>r_2</m> is the least POTP of <m>f(x)</m>. If
          <m>f^\prime(x)\gt0\; (\lt0)</m> for some <m>x\lt r_2</m> then
          <m>f^\prime(x)\gt 0\; (\lt0)</m> for all <m>x\lt r_2</m>, in the
          domain of <m>f</m>.
        </p>
      </li>
    </ol>
  </p>
</lemma>

<p>
  In mathematics Theorems and Lemmas are always stated very formally,
  very concisely, and with as much generality as possible. There are
  good reasons for this but it does sometimes make them hard to read.
</p>
  
<exercise>
  <statement>
    <p>
      Read <xref ref="LEMMAAdjRoots">Lemma</xref> very carefully and convince
      yourself that it really does say the same thing as our conclusions
      at the end of <xref ref="EXAMPLEPPT">Example~\</xref>.
    </p>
  </statement>
</exercise>
<p>
  Remember that POTPs are <em>possible</em> optimal transition
  points. The existence of a POTP does not imply the existence of an
  optimum, as the next example demonstrates.
</p>

<example xml:id="EXAMPLEx5">
<p>

  Find all extrema of the graph of <m>O(x)=x^5</m>.
</p>
<p>

  Solving <m>\dfdxat{O}{x}{0}=5x^4=0</m> we see that <m>x=0</m> is the only
  POTP. But elsewhere <m>O^\prime(x)\gt 0</m> (confirm this) so
  <m>\dfdx{O}{x}</m> is positive for every value of <m>x</m> except zero. In
  particular it is positive on the left and on the right of
  zero. Therefore <m>O(x)=x^5</m> never transitions between increasing
  and decreasing, so we conclude that it does not have an extremum
  at <m>x=0</m>, despite the fact that <m>\dfdxat{O}{x}{0}=0</m>. This may
  seem very curious until you graph the function.
</p>
</example>


  <exercise>
    <statement>
      <p>
        Sketch the graph of <m>O(x)=x^5</m> and use it to explain how we can
        have <m>\dfdxat{O}{x}{0}=0</m> yet not have either a maximum or a
        minimum at <m>x=0</m>.
      </p>
    </statement>
  </exercise>


        




  <example xml:id="EXAMPLEParabolaSquare-Redux">
<title>Constructing a Parabola on a Square   (<xref ref="EXAMPLEParabolaOptSqr"></xref>), Revisited</title>
<p>
    Given our new understanding of the distinction between local and
    global extrema we will revisit
    <xref ref="EXAMPLEParabolaOptSqr"></xref>. Recall the problem:
    \begin{center}
      \begin{minipage}{.8\linewidth}
        Find the area of the smallest square which can be constructed
        with one corner at the point <m>(2,3)</m> and an adjacent corner on
        the graph of <m> y = x^2</m>.
      \end{minipage}
    \end{center}
    The objective function is still <m> A = (x-2)^2 + (y-3)^2 </m> so when
    we substitute the constraint, <m>y = x^2</m>, we get the abstract
    problem of finding the lowest points on the graph of
    <me>
    A(x) = (x-2)^2 + (x^2-3)^2
    </me>

</p>
<p>

    Solving <m>\dfdx{A}{x}=0</m> gives us three POTPs: <m>x \approx-1.32</m>,
    <m>x \approx-0.43</m>, and <m>x \approx1.75</m> as before, so the intervals
    we need are, <m>(-\infty, -1.32)</m>, <m>(-1.32, -0.43)</m>,
    <m>(-0.43, 1.75)</m>, and <m>(1.75, \infty)</m>.  Because our POTPs are
    approximations these intervals are also approximate.

</p>
<p>

    Now pretend that you don't already know the solution of this
    problem.  Just as in <xref ref="EXAMPLEPPT"></xref> we can use the
    First Derivative Test to determine which of the POTPs we've
    identified corresponds to a local minimum or maximum.
  </p>
</example>


<problem xml:id="DRILLFDT1">
  <introduction>
    <p>
      Choose a point in each interval and confirm that the following
      statements are true.
      <dl>
        <li>
          <title>[\boldmath On the (approximate) interval        <m>(-\infty, -1.32)</m>:</title>
          <p>
            <m>O^\prime(x) \lt0</m>
          </p>
        </li>
        <li>
          <title>[\boldmath On the (approximate) interval        <m>(-1.32, -0.43)</m>:</title>
          <p>
            <m>O^\prime(x) \gt0</m>
          </p>
        </li>
        <li>
          <title>[\boldmath On the (approximate) interval        <m>(-0.43, 1.75)</m>:</title>
          <p>
            <m>O^\prime(x) \lt0</m>
          </p>
        </li>
        <li>
          <title>[\boldmath On the (approximate) interval        <m>(1.75, \infty)</m>:</title>
          <p>
            <m>O^\prime(x) \gt0</m>
          </p>
        </li>
      </dl>

    </p>
  </introduction>
  <task>
    <statement>
      <p>
        Use the First Derivative Test and the data displayed above
        to show that there is a local minimum at <m>x\approx-1.32</m> a
        local maximum at <m>x\approx-0.43</m> and a local minimum at
        <m>x\approx1.75</m>.
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        Is the data above sufficient to support the conclusion that        there is a global minimum at <m>x\approx1.75</m>? Explain why not.
      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        What additional data do we need to conclude that there is        a global minimum at <m>x\approx1.75</m>?
      </p>
    </statement>
  </task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--       <!-\- \label{drill:FDT1} -\-> -->
<!--       Choose a point in each interval and confirm that the following -->
<!--       statements are true. -->
<!-- <dl> -->
<!-- <li> -->
<!-- <title>[\boldmath On the (approximate) interval        <m>(-\infty, -1.32)</m>:</title> -->
<!-- <p> -->
<!--  <m>O^\prime(x) \lt0</m> -->
<!-- </p> -->
<!-- </li> -->
<!-- <li> -->
<!-- <title>[\boldmath On the (approximate) interval        <m>(-1.32, -0.43)</m>:</title> -->
<!-- <p> -->
<!--  <m>O^\prime(x) \gt0</m> -->
<!-- </p> -->
<!-- </li> -->
<!-- <li> -->
<!-- <title>[\boldmath On the (approximate) interval        <m>(-0.43, 1.75)</m>:</title> -->
<!-- <p> -->
<!--  <m>O^\prime(x) \lt0</m> -->
<!-- </p> -->
<!-- </li> -->
<!-- <li> -->
<!-- <title>[\boldmath On the (approximate) interval        <m>(1.75, \infty)</m>:</title> -->
<!-- <p> -->
<!--  <m>O^\prime(x) \gt0</m> -->
<!-- </p> -->
<!--       </li> -->
<!-- </dl> -->

<!--       \begin{enumerate}[label={  (\alph*)}] -->
<!--               \item Use the First Derivative Test and the data displayed above -->
<!--         to show that there is a local minimum at <m>x\approx-1.32</m> a -->
<!--         local maximum at <m>x\approx-0.43</m> and a local minimum at -->
<!--         <m>x\approx1.75</m>. -->
<!--       \item Is the data above sufficient to support the conclusion that        there is a global minimum at <m>x\approx1.75</m>? Explain why not. -->
<!--       \item What additional data do we need to conclude that there is        a global minimum at <m>x\approx1.75</m>? -->
<!--               \end{enumerate} -->
<!--     \end{embeddedproblem} -->


  <exercise xml:id="DRILLFDT2">
<introduction>
<p>
    Identify all possible optimal transition points, and identify the
    intervals on which each function is increasing and
    decreasing. Label each possible optimal transition point as a local or
    global minimum, or a local or global maximum, or neither.
</p>
</introduction>
<task>
<statement>
<p>
 <m>f(x) = 2x^3+x^2-20x+1</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = 4x^{3}-3x^{4}</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = 8x^5-5x^4-20x^3</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^3-x^2-40x+8</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^6-3x^5</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^6-3x^5+x</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^{2}\left(x^{2}-4\right)^{\frac{1}{3}}</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = (4x^{3}-3x^{4})^{\frac43}</m>
    </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
  <!--   <!-\- \label{drill:FDT2} -\-> -->
  <!--   Identify all possible optimal transition points, and identify the -->
  <!--   intervals on which each function is increasing and -->
  <!--   decreasing. Label each possible optimal transition point as a local or -->
  <!--   global minimum, or a local or global maximum, or neither. -->
  <!--   \begin{enumerate}[label={  (\alph*)}] -->
  <!--     \item <m>f(x) = 2x^3+x^2-20x+1</m> -->
  <!--     \item <m>f(x) = 4x^{3}-3x^{4}</m> -->
  <!--     \item <m>f(x) = 8x^5-5x^4-20x^3</m> -->
  <!--     \item <m>f(x) = x^3-x^2-40x+8</m> -->
  <!--     \item <m>f(x) = x^6-3x^5</m> -->
  <!--     \item <m>f(x) = x^6-3x^5+x</m> -->
  <!--     \item <m>f(x) = x^{2}\left(x^{2}-4\right)^{\frac{1}{3}}</m> -->
  <!--     \item <m>f(x) = (4x^{3}-3x^{4})^{\frac43}</m> -->
  <!--   \end{enumerate} -->
  <!-- \end{ProficiencyDrill} -->
     

</subsection>
<subsection xml:id="SUBSECTIONunderl-deriv">
<title>Undefined Derivatives</title>

  <blockquote>
<p>
Happy families are all alike; every unhappy family is
    unhappy in its own
    way.
</p>
<attribution>
<url href="https://en.wikipedia.org/wiki/Leo_Tolstoy" visual="https://en.wikipedia.org/wiki/Leo_Tolstoy">Leo
      Tolstoy (1847-1910)</url>
</attribution>
</blockquote>

<p>
  In <xref ref="DRILLTransitionQuestion"></xref> we asked if you think of a
  <q>way for <m>O^\prime(x) =\dfdx{O}{x}</m> to transition from positive to
  negative, or from negative to positive</q> without passing through
  zero. Clearly this is possible, otherwise we would not have asked.
  But it's hard to see how this can be isn't it? After all, at a
  transition point the derivative of the objective function changes
  signs: It transitions from negative-to-positive or from
  positive-to-negative. Obviously, the only number that has positive
  numbers on one side and negative numbers on the other is zero. So
  won't the solutions of <m>\dfdx{O}{x}=0</m> give us all of the
  possible transition points?
</p>

  <example xml:id="EXAMPLEPOTP-WhereDerivIsUndef">
<p>
    No, they won't.  We can also have a transition point wherever
    <m>\dfdxat{O}{x}{a}</m> is meaningless. That is, when
    <m>\eval{\dfdx{O}{x}}{x}{a}</m> is
   <term>undefined</term>. <xref ref="DRILLCubeRoot2"></xref> below demonstrates
    one way in which a derivative might be undefined.
</p>
      </example>

    
    <exercise xml:id="DRILLCubeRoot2">
<introduction>
<p>
      Suppose <me>
            y(x)=x^\frac13
      </me>
      The graph of <m>y(x)</m> looks like this:\\
      \centerline{\includegraphics*[height=1in,width=3in]{../Figures/CubeRoot1}}
</p>
</introduction>
<task>
<statement>
<p>
 Show that <m>\eval{\dfdx{y}{x}}{x}{0}</m> is undefined.\\
        \hint{Recall <xref ref="DIGRESSIONdigression:DivideByZero"></xref>.}
      </p>
</statement>
</task>
<task>
<statement>
<p>
 Graph <m>\dfdx{y}{x}</m> to verify that <m>\dfdx{y}{x}\gt 0</m>
        when <m>x\ne 0</m>.
      </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill-1line} -->
    <!--   <!-\- \label{drill:CubeRoot2} -\-> -->
    <!--   Suppose <me> -->
    <!--         y(x)=x^\frac13 -->
    <!--   </me> -->
    <!--   The graph of <m>y(x)</m> looks like this:\\ -->
    <!--   \centerline{\includegraphics*[height=1in,width=3in]{../Figures/CubeRoot1}} -->
    <!--   \begin{enumerate}[label={  (\alph*)}] -->
    <!--   \item Show that <m>\eval{\dfdx{y}{x}}{x}{0}</m> is undefined.\\ -->
    <!--     \hint{Recall <xref ref="DIGRESSIONdigression:DivideByZero"></xref>.} -->
    <!--   \item Graph <m>\dfdx{y}{x}</m> to verify that <m>\dfdx{y}{x}\gt 0</m> -->
    <!--     when <m>x\ne 0</m>. -->
    <!--   \end{enumerate} -->
    <!-- \end{ProficiencyDrill-1line} -->
<p>

  Based on <xref ref="DRILLCubeRoot2"></xref> it would be easy to conclude
  that the derivative of <m>y(x)</m> can only be undefined at a point <m>x</m>
  where the formula for <m>\dfdx{y}{x}</m> requires that we divide by
  zero. But this conclusion is due to the poverty of our experience
  with non-differentiabilty.
</p>
<p>

    There are many ways that a function can fail to be differentiable at
  a point. Dividing by zero is only one of them. In many ways it is
  the simplest.  The family of non-differentiable functions is a very
  unhappy family, indeed. We might even call it dysfunctional.
</p>
<p>

  The  functions whose graphs are shown below is a representative sample of
  functions which are non-differentiable at
  <m>x=0</m>. Can you see what they all have in common?\\
</p>
  
<image source="images/NonDiff3.png" width="60%" />
<!-- \centerline{\includegraphics*[height=1.5in,width=5in]{../Figures/NonDiff3}} -->
<p>
  In our comments just before <xref ref="DEFLocalLinearity">Definition~\</xref> we
  stated that the Principle of Local Linearity is exactly what makes
  Calculus useful and we have relied on that truth in all of our
  subsequent investigations. But there is more to it than that. The
  Principle of Local Linearity is not only what makes Differential
  Calculus useful, its what makes Differential Calculus possible.
</p>

<image source="images/NonDiff2.png" width="50%"/>
<!-- \begin{wrapfigure}[5]{l}{.7in} -->
<!--     \captionsetup{labelformat=empty} -->
<!--     \centerline{\includegraphics*[height=.7in,width=.7in]{../Figures/NonDiff2}} -->
<!--     \label{fig:NonDiff2} -->
<!--   \end{wrapfigure} -->
<p>

  Take another look at graph (a) above, <m>y(x) = \abs{x}</m>.  Do you see
  that the Principle of Local Linearity is not in play near the point
  <m>(0,0)</m>? No matter how much we zoom in on this point the graph will
  never resemble a straight line,  any straight line. It looks like
  the sketch at the left at every scale.
</p>
<p>

  The same is true of every function given above. They all violate the
  Principle of Local Linearity. Near <m>x=0</m> none of them looks like a
  straight line no matter what viewing scale we use.
</p>
<p>

  The case of a
  vertical tangent line is slightly problematic because near <m>x=0</m> the graph
  of, for example, <m>y=x^{\frac13}</m> looks like a vertical straight
   line. But the derivative of <m>y=x^{\frac13}</m>  is
   <me>\dfdx{y}{x}=\frac{1}{3x^{\frac23}}</me> so it is  not differentiable
   at zero, which is the point: Any point where a given function is
   not differentiable is a POTP.
</p>
<p>

  We formalize this observation with the following definition.
</p>
<definition xml:id="DEFINITIONOptimalTransitionPoints">
  <title>Possible Optimal Transition Points (POTPs)</title>
  <statement>
    <p>
      <!-- \label{def:OptimalTransitionPoints} -->
      The <term>possible optimum transition points</term> of a function,
      <m>O(x)</m>, come in two categories:
      
      <ol>
        <li>
          <p>
            Any point, <m>x=a</m>, where <m>\dfdxat{O}{x}{a}=0</m> is a possible
            optimal transition point.
          </p>
        </li>
        <li>
          <p>
            Any point, <m>x=a</m>, where <m>\dfdxat{O}{x}{a}</m> is not defined
            is a possible optimal transition point.
          </p>
        </li>
      </ol>

    </p>
  </statement>
</definition>



  <exercise xml:id="DRILLFDT3">
<introduction>
<p>
    For each function identify all POTPs, and identify the intervals
    on which the function is increasing and decreasing. Label each
    POTP as a local or global minimum, maximum, or neither.\\
    \comment{For some of these you will have to rely on their
      graphs to find the POTPs. In <xref ref="CHAPTERPTERchpt:when-deriv-doesnt">~</xref> you will learn
      how  to find them by computing.}
</p>
</introduction>
<task>
<statement>
<p>
 <m>f(x) = \frac{x}{x^2+9}</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = \frac1x</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = \frac{x^2}{x^2+5}</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^\frac13</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^\frac23</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x-3x^\frac13</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^\frac13(x+4)</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = x^\frac23(x^2-8)</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = 5x^\frac23-2x^\frac53</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = \abs{x^2-1}</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = \abs{x}-3\abs{x-3}</m>
      </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x) = \abs{x}-\abs{x-3}</m>
    </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
  <!--   <!-\- \label{drill:FDT3} -\-> -->
  <!--   For each function identify all POTPs, and identify the intervals -->
  <!--   on which the function is increasing and decreasing. Label each -->
  <!--   POTP as a local or global minimum, maximum, or neither.\\ -->
  <!--   \comment{For some of these you will have to rely on their -->
  <!--     graphs to find the POTPs. In <xref ref="CHAPTERPTERchpt:when-deriv-doesnt">~</xref> you will learn -->
  <!--     how  to find them by computing.} -->
  <!--   \begin{enumerate}[label={  (\alph*)}]  -->
  <!--     \item <m>f(x) = \frac{x}{x^2+9}</m> -->
  <!--     \item <m>f(x) = \frac1x</m> -->
  <!--     \item <m>f(x) = \frac{x^2}{x^2+5}</m> -->
  <!--     \item <m>f(x) = x^\frac13</m> -->
  <!--     \item <m>f(x) = x^\frac23</m> -->
  <!--     \item <m>f(x) = x-3x^\frac13</m> -->
  <!--     \item <m>f(x) = x^\frac13(x+4)</m> -->
  <!--     \item <m>f(x) = x^\frac23(x^2-8)</m> -->
  <!--     \item <m>f(x) = 5x^\frac23-2x^\frac53</m> -->
  <!--     \item <m>f(x) = \abs{x^2-1}</m> -->
  <!--     \item <m>f(x) = \abs{x}-3\abs{x-3}</m> -->
  <!--     \item <m>f(x) = \abs{x}-\abs{x-3}</m> -->
  <!--   \end{enumerate} -->
  <!-- \end{ProficiencyDrill} -->




</subsection>
<subsection xml:id="SUBSECTIONoptim-clos-interv">
<title>Transition Points on a Closed Interval; the Problem of Endpoints</title>


<p>
  Real world optimization problems will have a natural domain on which
  the objective function is defined.  It is pointless to consider
  values of <m>x</m> outside of that domain. We actually saw this in
  <xref ref="EXAMPLECircleDist">Example</xref>, although we didn't remark on it at
  the time. Recall that in <xref ref="EXAMPLECircleDist">Example</xref> we needed
  to optimize the area of a square with one of its corners on the unit
  circle: <m>x^2+y^2=1.</m> Obviously it makes no sense to consider any
  value of <m>x</m> greater than <m>1</m> or less than <m>-1</m> (why not?), so the
  natural domain of this problem is <m>-1\le x\le 1</m>.
</p>
<p>


  When the natural domain of a problem is a closed interval (one that
  includes both endpoints) it is possible that an extremum might also
  occur at one of those endpoints.
</p>

  <example xml:id="EXAMPLESqrClosed">
  <figure>
<caption>
<url href="https://en.wikipedia.org/wiki/Achilles%27_heel" visual="https://en.wikipedia.org/wiki/Achilles%27_heel">This figure needs a caption.</url>
</caption>
<image source="images/ObjSqr.png" width="50%"/>
</figure>
<!-- \begin{wrapfigure}[8]{r}{1.5in} -->
<!--     \captionsetup{labelformat=empty} \vskip-8mm  -->
<!--     \centerline{\includegraphics*[height=1.5in,width=1.5in]{../Figures/ObjSqr}} -->
<!--     \label{fig:ObjSqr} -->
<!--   \end{wrapfigure} -->
<p>

  For example, suppose we need to optimize the function,
  <me>
  O(x) = x^2,\; -1\le x\le 2.
  </me>
  From the graph at the right we can see that this function has a
  global minimum at <m>(0,0)</m>. We can find this minimum by the methods
  we are already familiar with.  But it also has a local maximum at
  <m>(-1,1)</m> and global maximum at <m>(2,4)</m>, and nothing we've done so
  far would identify these two points as possible extrema.
</p>
<p>

  It is clear from the graph what is happening, though. If we hadn't
  restricted the domain of our function then the graph would continue
  to rise on both sides and there would be no local or global maximum
  at all.  The restriction on the domain forces the graph to stop
  rising at the endpoints of the interval which makes each of these
  endpoints a local maximum.
</p>
<p>

  Thus we see that when the domain of our function is a closed
  interval there is also the possibility that a local or global
  extremum might occur at the endpoints of the interval as well. As a
  result, when searching for extrema we must always check the
  endpoints of the domain interval (if there are any).
</p>
<p>

  To be clear, the end points of a closed interval are not transition
  points because there can be no transition between increasing and
  decreasing at an endpoint. It simply stops. However, since it is
  possible to have extrema at the endpoints they must also be checked
  whenever they are in play.
</p>
<p>

  


        
  Be careful. When the domain of a function is artificially
  constrained like this it is easy to forget that the constraint is
  present. We tend to think of it as <q>not really there.</q>  This is a
  mistake. Recall from
  <xref ref="DIGRESSIONTangentHasNoInverse">Digression~\</xref> that the
  definition of the domain is a part of the definition of a
  function. Think of the function's domain as the <q>universe</q> for
  that particular problem. Nothing exists outside of the domain. Thus
  in this example nothing exists outside of the interval (universe)
  <m>[-1,2]</m>.
</p>
</example>
<p>

It appears that to find global extrema for a function whose domain
consists entirely of closed intervals all we need to do is
\begin{enumerate}
\item Find the POTPs.
\item Evaluate our objective function at the POTPs and at any end
  points of intervals in the domain of the objective function.
\item Determine which among those is greatest and which is least.
\end{enumerate}
</p>
<p>

And that's it. When the domain of our function is a closed interval
(or the union of closed intervals) optimization really is that
straightforward\aside{Remember that <q>straightforward</q> does not mean
  <q>easy.</q>}.
</p>
<p>

We formalize all of this in <xref ref="THEOREMmax-min">Theorem</xref> below.
</p>

<theorem xml:id="THEOREMmax-min">
<title>Extreme Value Theorem</title>
<p>
  If <m>f(x)</m> is a continuous function whose domain consists entirely of
  closed, bounded intervals then:
  \begin{enumerate}[label={  (\alph*)}]
  \item There is at least one point in the domain, say <m>x=c</m> such that
    <m>f(c)</m> is the global maximum value of <m>f(x)</m>.  Moreover <m>c</m> will
    either be an end point of one of the domain intervals, or an
    optimal transition point.
  \item There is least one point in the domain, say <m>x=d</m>, and <m>f(d)</m>
    is the global minimum of <m>f(x)</m>.  Moreover <m>d</m> will either be an
    end point of one of the domain intervals, or optimal transition
    point.
  \end{enumerate}
</p>
</theorem>


<problem xml:id="PROBLEMParabolaSquare-Redux">
<statement>
<p>
  We ended <xref ref="EXAMPLEParabolaOptSqr">Example~\</xref> after posing the
  problem of finding the global extrema of
  <me>
  A(x) = (x-2)^2 + (x^2-3)^2
  </me>
  with the constraint
  <me>
  y=x^2,\; -2\le x\le 0.5.
  </me>
  Solve this problem now.
</p>
</statement>
</problem>

<problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Notice that <m>y=x^2</m> has no extrema on <m>(0,\infty).</m> Explain
    why this does not violate the Extreme Value Theorem.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Notice that <m>y=\frac{1}{x}</m> has no extrema on <m>[-1,1].</m>
    Explain why this does not violate the Extreme Value Theorem.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate}  -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Notice that <m>y=x^2</m> has no extrema on <m>(0,\infty).</m> Explain -->
<!--     why this does not violate the Extreme Value Theorem. -->
<!--   \item Notice that <m>y=\frac{1}{x}</m> has no extrema on <m>[-1,1].</m> -->
<!--     Explain why this does not violate the Extreme Value Theorem. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate}  -->


<problem xml:id="PROBLEMSquareOnCircle">
<statement>
<p>
  If we had known <xref ref="THEOREMmax-min">Theorem</xref> when we first looked at
  <xref ref="EXAMPLECircleDist">Example~\</xref> it would have saved us some time.
  Redo <xref ref="EXAMPLECircleDist">Example~\</xref>, using the knowledge that
  the domain of the problem is <m>-1\le x\le1</m> because the constraint is
  <m>x^2+y^2=1.</m>
</p>
</statement>
</problem>



<problem>
<introduction>
<p>
  Find the global maximum and global minimum of each function with the
  domain restricted to the given intervals.  Verify your solution by
  graphing the function.
</p>
</introduction>
<task>
<statement>
<p>
 <m>O(x) = x^3-3x</m>
  <ol>
    <li>
      <p>
        <m>[-1.5, 1.5] </m>
      </p>
    </li>
    <li>
      <p>
        <m>[-3, 3]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[1,2]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[0,1]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[-1,0]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[-2,-1]</m>
      </p>
    </li>
  </ol>
  </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> f(x) = x^3-12x </m>
  <ol>
    <li>
      <p>
        <m>[0,4]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[-4,0]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[-2,2]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[-1,3]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[-2, 1]</m>
      </p>
    </li>
    <li>
      <p>
        <m>[-5, 5]</m>
      </p>
    </li>
  </ol>
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem}  ;;; MULTILEVEL PROBLEM -->
<!--   Find the global maximum and global minimum of each function with the -->
<!--   domain restricted to the given intervals.  Verify your solution by -->
<!--   graphing the function. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item <m>O(x) = x^3-3x</m> -->
<!--   <ol> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-1.5, 1.5] </m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-3, 3]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[1,2]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[0,1]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-1,0]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-2,-1]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--   </ol> -->
<!--   \item <m> f(x) = x^3-12x </m> -->
<!--   <ol> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[0,4]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-4,0]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-2,2]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-1,3]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-2, 1]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         <m>[-5, 5]</m> -->
<!--       </p> -->
<!--     </li> -->
<!--   </ol> -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->

<problem>
<introduction>
<p>
  Find the global maximum and global minimum of each of the following
  functions with domains on the given intervals. Verify your solution
  with graphing software.
</p>
</introduction>
<task>
<statement>
<p>
 <m>\displaystyle y=4-x^3</m> \\ on the interval <m>[-2,1]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y =(x^3-27)^{\frac13}</m> \\ on the interval <m>[-5 , 5]</m>
      \solution{ Minimum: <m>(-5,\sqrt[3]{-152}) </m> Maximum:
        <m>(-5,\sqrt[3]{98}) </m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=\sqrt[3]{x}</m>\\ on the interval <m>[-1,8]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=-3x^{2/3}</m> \\ on the interval <m>[-1,1]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=x\sqrt{1-x^2} </m> \\ on the interval <m>[-1,1]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=x(2-x)^{1/3}</m> \\ on the interval <m>[1,3]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=x^{1/2}-x^{3/2}</m>\\ on the interval <m>[0,4]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=\frac{7}{x^2+5}</m> \\ on the interval
      <m>[-2,2]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=\frac{x}{x^2-x+1}</m> \\ on the interval
      <m>[0,3]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=\frac{1-x}{x^2+3}</m> \\ on the interval
      <m>[-2,5]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=-\frac1x</m> \\ on the interval <m>[1/2,3]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=xe^x</m> \\ on the interval <m>[-3,4]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=x^2e^x</m> \\ on the interval <m>[-3,1/2]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y = e^{-x^2}</m> \\ on the interval <m>[2 ,10 ]</m> \solution{
        Minimum: <m>(10,e^{-100}) </m> Maximum: <m>(2, e^{-4}) </m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y=e^{-x^2}</m>, \\ on the interval <m>[-2, 1]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y = e^{-x^2}</m> \\ on the interval <m>[-1 ,2 ]</m> \solution{
        Minimum: <m>(-1,e) </m> Maximum: <m>(2, e^{-4}) </m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y = e^{-\frac{1}{x^2}}</m> \\ on the interval <m>[2 ,10 ]</m>
      \solution{ Minimum: <m>(2, e^{-1/4}) </m> Maximum:
        <m>(10, w^{-1/100}) </m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=x\ln(x)</m>\\ on the interval <m>[1/5,1]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y =x^2\sin(x^2)</m>, \\ on the interval<m>[0 ,2 ]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>\displaystyle y =\frac{\ln(x)}{x}</m>, \\ on the interval
      <m>[2 ,10 ]</m>
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--   Find the global maximum and global minimum of each of the following -->
<!--   functions with domains on the given intervals. Verify your solution -->
<!--   with graphing software. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--                 \item <m>\displaystyle y=4-x^3</m> \\ on the interval <m>[-2,1]</m> -->
<!--     \item <m> y =(x^3-27)^{\frac13}</m> \\ on the interval <m>[-5 , 5]</m> -->
<!--       \solution{ Minimum: <m>(-5,\sqrt[3]{-152}) </m> Maximum: -->
<!--         <m>(-5,\sqrt[3]{98}) </m>} -->
<!--     \item <m>\displaystyle y=\sqrt[3]{x}</m>\\ on the interval <m>[-1,8]</m> -->
<!--     \item <m>\displaystyle y=-3x^{2/3}</m> \\ on the interval <m>[-1,1]</m> -->
<!--     \item <m>\displaystyle y=x\sqrt{1-x^2} </m> \\ on the interval <m>[-1,1]</m> -->
<!--     \item <m>\displaystyle y=x(2-x)^{1/3}</m> \\ on the interval <m>[1,3]</m> -->
<!--     \item <m>\displaystyle y=x^{1/2}-x^{3/2}</m>\\ on the interval <m>[0,4]</m> -->
<!--     \item <m>\displaystyle y=\frac{7}{x^2+5}</m> \\ on the interval -->
<!--       <m>[-2,2]</m> -->
<!--     \item <m>\displaystyle y=\frac{x}{x^2-x+1}</m> \\ on the interval -->
<!--       <m>[0,3]</m> -->
<!--     \item <m>\displaystyle y=\frac{1-x}{x^2+3}</m> \\ on the interval -->
<!--       <m>[-2,5]</m> -->
<!--     \item <m>\displaystyle y=-\frac1x</m> \\ on the interval <m>[1/2,3]</m> -->
<!--     \item <m>y=xe^x</m> \\ on the interval <m>[-3,4]</m> -->
<!--     \item <m>y=x^2e^x</m> \\ on the interval <m>[-3,1/2]</m> -->
<!--     \item <m> y = e^{-x^2}</m> \\ on the interval <m>[2 ,10 ]</m> \solution{ -->
<!--         Minimum: <m>(10,e^{-100}) </m> Maximum: <m>(2, e^{-4}) </m>} -->
<!--     \item <m>\displaystyle y=e^{-x^2}</m>, \\ on the interval <m>[-2, 1]</m> -->
<!--     \item <m> y = e^{-x^2}</m> \\ on the interval <m>[-1 ,2 ]</m> \solution{ -->
<!--         Minimum: <m>(-1,e) </m> Maximum: <m>(2, e^{-4}) </m>} -->
<!--     \item <m> y = e^{-\frac{1}{x^2}}</m> \\ on the interval <m>[2 ,10 ]</m> -->
<!--       \solution{ Minimum: <m>(2, e^{-1/4}) </m> Maximum: -->
<!--         <m>(10, w^{-1/100}) </m>} -->
<!--     \item <m> y=x\ln(x)</m>\\ on the interval <m>[1/5,1]</m> -->
<!--     \item <m>\displaystyle y =x^2\sin(x^2)</m>, \\ on the interval<m>[0 ,2 ]</m> -->
<!--     \item <m>\displaystyle y =\frac{\ln(x)}{x}</m>, \\ on the interval -->
<!--       <m>[2 ,10 ]</m> -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->


<problem>
<introduction>
<p>
  For each of the following functions defined on closed, bounded
  intervals, find the maximum and minimum of the function on that
  interval.
</p>
</introduction>
<task>
<statement>
<p>
 <m>f(x)=2x^3+3x^2-12x+1 \\ \text{ on } [-3,2]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>f(x)=2x^3+3x^2-12x+1 \\ \text{ on } [-3,3]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>g(x)=4x^{\frac{3}{2}}-3x^2-2 \\ \text{ on }[0,2]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>h(z)=3z^{2/3}+2z-4 \\ \text{ on }[-2,1]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>L(x)=\ln((x-2)^6) -x^2 \\ \text{ on }[-1.5,4]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>

      <m>f(\theta)=\frac{\theta}{2} -\sin\theta \\\text{ on }[0,2\pi]</m>
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--   For each of the following functions defined on closed, bounded -->
<!--   intervals, find the maximum and minimum of the function on that -->
<!--   interval. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--     \item <m>f(x)=2x^3+3x^2-12x+1 \\ \text{ on } [-3,2]</m> -->
<!--     \item <m>f(x)=2x^3+3x^2-12x+1 \\ \text{ on } [-3,3]</m> -->
<!--     \item <m>g(x)=4x^{\frac{3}{2}}-3x^2-2 \\ \text{ on }[0,2]</m> -->
<!--     \item <m>h(z)=3z^{2/3}+2z-4 \\ \text{ on }[-2,1]</m> -->
<!--     \item <m>L(x)=\ln((x-2)^6) -x^2 \\ \text{ on }[-1.5,4]</m> -->
<!--     \item -->
<!--       <m>f(\theta)=\frac{\theta}{2} -\sin\theta \\\text{ on }[0,2\pi]</m> -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->
</subsection>

</section>
<section xml:id="SECTIONconc-second-deriv-1">
<title>Concavity and the Second Derivative Test</title>

<subsection xml:id="SUBSECTIONconc-second-deriv">
<title>The Second Derivative Test</title>


<p>
<xref ref="THEOREMmax-min">Theorem</xref> explicitly assumed that the domain of our
function consisted of closed (and bounded) intervals. This assumption was
crucial. Without this assumption even simple functions that you would
expect to have extrema do not.
</p>
<example xml:id="EXAMPLEOpenNoExtrema">
<p>
  For example, suppose our objective function is <m>O(x)=x</m>, and that
  the domain is the open interval <m>(-1,1)</m>.  Do you see why the graph
  of this function has no extrema of any kind?  If not here is one way
  to prove it.
</p>
 

</example>
 <proof>
<p>
    Observe that <m>\dfdx{O}{x}=1\gt 0</m>. Therefore <m>O(x)</m> is always
    increasing on <m>(-1,1)</m>.  If <m>x</m> is any number between <m>-1</m> and <m>1</m>
    then <m>f(x)</m> can't be a maximum (minimum) because any number just
    to the right (left) of <m>x</m> will give us an <m>f(x)</m> that is higher
    (lower) than <m>f(x)</m>.

    Can we always find a number <q>just to the right</q> of <m>x</m> without
    leaving the interval <m>(-1,1)?</m> Sure. Just take the number halfway
    between <m>x</m> and <m>1.</m>
</p>
<p>
<alert><m>\halmos</m></alert>
</p>
</proof>

  <exercise>
<statement>
<p>
    Show that the function <m>O(x)=x</m> also has no minimum on the open
    interval <m>(-1,1)</m>.
  </p>
</statement>
</exercise>

<p>
This leaves us with a dilemma: If the domain is not closed and bounded
we can't
rely on the Extreme Value Theorem to guarantee the existence of extrema. In
fact <xref ref="EXAMPLEOpenNoExtrema">Example~\</xref> shows that there might not
be any extrema. But if there are we'd still like to be able to
find them.
</p>

<p>
This is a problem but it is not an insurmountable problem. In fact we
already have most of the tools we need.  It is still true that local
extrema, if they exist, can only occur at optimal transition points or
at endpoints. So finding these is still the first step.
</p>

<example xml:id="EXAMPLEFDT1">
<p>
  For this example we strongly suggest that you do not graph the
  objective functions first. Yes, we know this goes directly against
  our previous advice to always visualize your problem when you can,
  but one purpose of this section is for you to learn to analyze a
  problem using your Calculus tools. Much as an airline pilot must
  train to fly using only the cockpit instruments in case they have no
  other choice due to poor visibility, you should also practice
  <q>flying blind</q> so you can be successful even when you are not able
  to draw a useful graph.  You will learn more, and you will learn
  better, that way.
</p>
<p>

  Of course, once we've moved beyond this section you should visualize
  your problem if you possibly can. We weren't kidding about that. You
  don't want to fly blind, you just need to be able to when it is
  necessary.
</p>
<p>

  From the information gethered in <xref ref="DRILLO1O2">Drill:</xref> can we
  conclude that either <m>O_1(x)</m> or <m>O_2(x)</m> has a global maximum at
  <m>x=-1</m> and a global minimum at <m>x=1</m>?
</p>
<p>

  No we can't.  They both have a local maximum and minimum at those
  points since both functions increase on <m>(-\infty,-1)</m>, decrease on
  <m>(-1,1)</m>, and then increase again on <m>(1,\infty)</m>. But from the
  information we have gathered so far we can't tell if the graph of
  either function rises above its value at <m>x=-1</m> or drops below its
  value at <m>x=1</m> .
</p>
<p>

            
                  


  When we analyze <m>O_1(x)</m> and <m>O_2(x)</m> using the First Derivative
  Test we get exactly the same information from both functions. But
  they are very different functions. In particular, <m>O_1(x)</m> does not
  have any global extrema, while <m>O_2(x)</m> has both a global maximum
  and a global minimum. Graph them now and see.  To distinguish,
  analytically, between <m>O_1(x)</m> and <m>O_2(x)</m> we will need a new tool
  called the Second Derivative Test.
</p>
<p>



  But before we leave this example we need to address a small issue
  with our language.  The phrase <q><m>x</m> gets farther from zero in the
  negative (or positive) direction so does <m>O_1(x)</m></q> is
  awkward\aside{It is also a bit imprecise for our purposes.}.  In
  future examples we will instead usually abbreviate these as: <q>as
  <m>x</m> goes to negative (or positive) infinity, <m>O_1(x)</m> also goes to
  negative (or positive) infinity.</q> Do not invest too much in these
  phrases.  They cannot possibly mean what they pretend to
  mean. <q>Infinity</q> is neither a number nor a place so it is
  meaningless to say that <m>x</m> <q>goes to</q> infinity. Think of this as a
  kind of verbal shorthand, or notation.
</p>
</example>



<problem xml:id="DRILLO1O2">
  <introduction>
    <p>
    </p>
  </introduction>
  <task>
    <statement>
      <p>
        Suppose that <m>O_1(x)=3x^3-9x</m>.
        \vskip-2mm
        
        <ol>
          <li>
            <p>
              Show that the POTPs are <m>x=-1</m> and <m>x=1</m>.
            </p>
          </li>
          <li>
            <p>
              Show that <m>O_1(x)</m> is increasing on <m>(-\infty,-1)</m>,
              decreasing on <m>(-1,1)</m>, and increasing again on
              <m>(1,\infty)</m>.
            </p>
          </li>
        </ol>

      </p>
    </statement>
  </task>
  <task>
    <statement>
      <p>
        Suppose that <m>O_2(x)=\frac{-x}{x^2+1}</m>.  Show that <m>O_2(x)</m> is
        increasing on <m>(-\infty,-1)</m>, decreasing on <m>(-1,1)</m>, and
        increasing again on <m>(1,\infty)</m>.
      </p>
    </statement>
  </task>
</problem>
<!-- \begin{embeddedproblem-enumerate}  ;;; MULTILEVEL PROBLEM -->
<!--     <!-\- <!-\\- \label{drill:O1O2} -\\-> -\-> -->
<!--     \begin{enumerate}[label={  (\alph*)}] -->
<!--     \item Suppose that $O_1(x)=3x^3-9x$. -->
<!--       \vskip-2mm -->
      
<!--       <ol> -->
<!--         <li> -->
<!--           <p> -->
<!--             Show that the POTPs are $x=-1$ and        $x=1$. -->
<!--           </p> -->
<!--         </li> -->
<!--         <li> -->
<!--           <p> -->
<!--             Show that $O_1(x)$ is increasing on $(-\infty,-1)$, decreasing        on $(-1,1)$, and increasing again on $(1,\infty)$. -->
<!--           </p> -->
<!--         </li> -->
<!--       </ol> -->

<!--     \item       Suppose that $O_2(x)=\frac{-x}{x^2+1}$. -->
    
<!--     <ol> -->
<!--       <li> -->
<!--         <p> -->
<!--           Show that $O_2(x)$ is increasing on $(-\infty,-1)$, decreasing        on $(-1,1)$, and increasing again on $(1,\infty)$. -->
<!--         </p> -->
<!--       </li> -->
<!--     </ol> -->

<!--     \end{enumerate} -->

<!--   \end{embeddedproblem-enumerate} -->

<image source="images/ConcaveUpDown1.png" width="50%"/>
<!-- \begin{wrapfigure}[7]{r}{1.6in} -->
<!--   \captionsetup{labelformat=empty} -->
<!--     \centerline{\includegraphics*[height=1in,width=1.6in]{../Figures/ConcaveUpDown1}} -->
<!--   \label{fig:ConcaveUp} -->
<!-- \end{wrapfigure} -->
<p>
Just as the First Derivative Test tells us whether
the graph of a function is increasing or decreasing, the Second
Derivative Test tells us whether the graph is <term>concave upward</term> or
<term>concave downward</term>.  We need to begin by explaining the meaning
of the phrases <term>concave upward</term> and <term>concave downward</term>.
</p>

<p>
The graphs at the right are illuminative. Loosely speaking concave
upward means <q>like a bowl that opens up,</q> and concave downward means
<q>like a bowl that opens down.</q>  However it is easy to get the wrong
impression from these simple examples. The graphs of the natural
exponential and the natural logarithm (seen below)
are also concave upward and concave downward, respectively. This is
true despite the fact that the exponential never turns up on the left,
and the logarithm never turns down on the right.
</p>

<image source="images/ExpLog2.png" width="60%" />
<!-- \centerline{\includegraphics*[height=2in,width=2in]{../Figures/ExpLog2}} -->


<image source="images/ConcaveUpDown.png" width="50%"/>
<!-- \begin{wrapfigure}[]{l}{1.5in} -->
<!--   \vskip-3mm  \captionsetup{labelformat=empty} -->
<!--   \centerline{\includegraphics*[height=.75in,width=1.5in]{../Figures/ConcaveUpDown}} -->
<!--   \label{fig:ConcaveUpDown} -->
<!-- \end{wrapfigure} -->

<p>
Nor is every graph always concave up or concave down.  We can see from
its graph at the left that the sine function is both concave upward
and concave downward. On the interval <m>(0,\pi)</m> it is concave downward
and on the interval <m>(\pi,2\pi)</m> it is concave upward. The concavity
of a graph, like the property of increasing and decreasing, depends on
the interval we are looking at.
</p>
<p>

Now what about these two functions?
</p>

<image source="images/ConcaveUpDownUnclear.png" width="60%" />
<!-- \centerline{\includegraphics*[height=1.5in,width=3in]{../Figures/ConcaveUpDownUnclear}} -->
<p>
The graph on the right appears to be concave up everywhere, but is it?
Can you tell from the graph what the concavity of either function is
near <m>x=0</m>?  If it is important for us to distinguish concave upward
from concave downward (it is), then clearly we will need a more
precise method than simply looking at graphs. We'll proceed carefully.
</p>

<image source="images/ConcaveUpWithTangent.png" width="50%"/>
<!-- \begin{wrapfigure}[9]{r}{3in} -->
<!--   \captionsetup{labelformat=empty} -->
<!--       \centerline{\includegraphics*[height=1.3in,width=3in]{../Figures/ConcaveUpWithTangent}} -->
<!--   \label{fig:ConcaveUpWithTangent} -->
<!-- \end{wrapfigure} -->
<p>
Since we're studying Calculus it seems likely that the derivative will
play an instrumental role, so let's see what we can say about the
derivative of a function whose graph is concave upward as shown at the
right.  In this example notice how the slope of the line tangent to
the graph (the derivative) changes as <m>x</m> increases. At <m>x</m> the
tangent line is horizontal (slope is zero), to the left of <m>x</m> the
tangent line has negative slope and to the right it has positive
slope.  Speaking loosely, when the graph of a function is concave up
its the derivative increases as <m>x</m> increases.
</p>
<exercise>
<statement>
<p>
  Does that mean that the derivative of a concave downward function
  will decrease as <m>x</m> increases? Yes, of course it does.  Look back
  at the graphs of the other <q>concave up</q> and <q>concave down</q>
  examples and convince yourself that this is true of them as well.
</p>
</statement>
</exercise>

<p>
Apparently in order to distinguish where a function is concave upward
from where it is concave downward we need to locate those intervals
where the derivative is increasing and where it is decreasing.  That
is, we need a tool that tells when some function (the derivative
function in this case) is increasing and when
it is decreasing.
</p>

<p>
But we already have that tool! It's called the First Derivative Test.
</p>

<p>
To find out where the graph of <m>y(x)</m> is concave upward or concave
downward, we ask where its derivative, <m>\dfdx{y}{x}</m>, is increasing
and where it is decreasing. To find out where <m>\dfdx{y}{x}</m> is
increasing and decreasing we ask where its derivative,
<m>\dfdxn{y}{x}{2}</m>, is positive and where it is negative.
</p>

<p>
The function <m>\dfdx{y}{x}</m> will be increasing (meaning that <m>y(x)</m> is
concave upward) wherever its derivative, <m>\dfdxn{y}{x}{2}</m>, is
positive. It will be decreasing (<m>y(x)</m> is concave downward) wherever
its derivative, <m>\dfdxn{y}{x}{2}</m>, is negative.
</p>

<p>
So, to determine concavity of <m>y(x)</m>, we need to look at the sign of
its second derivative, <m>\dfdxn{y}{x}{2}</m>. More formally we have the
following theorem.
</p>

<theorem xml:id="THEOREMwhat-second-deriv">
  <title>Concavity</title>
  <p>
    Suppose <m>y=y(x)</m> is a differentiable function of <m>x.</m> The following
    statements are true:
    
    <ol>
      <li>
        <p>
          If <m>\eval{\dfdxn{y}{x}{2}}{x}{a}\gt 0</m> on some open interval
          then <m>\dfdx{y}{x}</m> is increasing, and therefore the graph of
          <m>y</m> is concave upward on the interval.
        </p>
      </li>
      <li>
        <p>
          If <m>\eval{\dfdxn{y}{x}{2}}{x}{a}\lt 0</m>, on some open
          interval then <m>\dfdx{y}{x}</m> is decreasing, and therefore the
          graph of <m>y</m> is concave downward on the same interval.
        </p>
      </li>
    </ol>

  </p>
</theorem>




<example>
<p>
  Let <m>y=x^2.</m> Then <m>\dfdx{y}{x}=2x,</m> and <m>\dfdxn{y}{x}{2}=2.</m> Since
  the second derivative of <m>y</m> is always positive the graph must
  always be concave upward.
</p>
</example>

  <exercise>
<statement>
<p>
    Graph <m>y=x^2</m> and verify that it is always concave upward.
  </p>
</statement>
</exercise>



<example>
<p>
  Let <m>y=x^3.</m> Then <m>\dfdx{y}{x}=6x^2,</m> and <m>\dfdxn{y}{x}{2}=3x.</m>
  Since the second derivative of <m>y</m> is negative on the interval
  <m>(-\infty,0)</m> the graph must be concave downward on for
  <m>x\lt0</m>. Since the second derivative of <m>y</m> is positive on the
  interval <m>(0,\infty)</m> the graph must be concave upward for <m>x\gt0</m>.
</p>
</example>

  <exercise>
<statement>
<p>
    Graph <m>y=x^3</m> and verify that it is always concave downward on the
    interval <m>(-\infty, 0)</m>, and concave upward on the interval
    <m>(0,\infty)</m>.
  </p>
</statement>
</exercise>

<p>

Because we are applying the First Derivative Test to the first
derivative of <m>y(x)</m> our language necessarily gets a little complex
here.  The point to remember is that we are ultimately interested in
what the first two derivatives, <m>\dfdx{y}{x}</m> and <m>\dfdxn{y}{x}{2}</m>,
tell us about the graph of <m>y(x)</m>. We will define some vocabulary to
help us keep all of this clear.
</p>
<p>

We called the solutions of <m>\dfdx{y}{x}=0</m> possible optimal transition
points (POTPs) because these are the places where the graph of <m>y(x)</m>
might transition between increasing and decreasing. So they are
possible local optimal points.
</p>
<p>

We will call the solutions of <m>\dfdxn{y}{x}{2}=0</m> possible inflective
transition points (PITPs) because they are those places where the
<term>inflection</term> of the graph of <m>y(x)</m> might transition between
concave upward and concave downward.
</p>



<problem xml:id="PROBLEMEvenFuncConcavity">
<introduction>
<p>
  Suppose that <m>y(x)=x^4-x^2</m>.
</p>
</introduction>
<task>
<statement>
<p>
 Show that the PITPs of <m>y(x)</m> are <m>x=-\frac{1}{\sqrt{6}}</m>, and
    <m>x=\frac{1}{\sqrt{6}}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that the graph of <m>y</m> is concave upward on the intervals
    <m>\left(-\infty,\frac{-1}{\sqrt{6}}\right)</m> and
    <m>\left(\frac{1}{\sqrt{6}},\infty\right)</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that the graph of <m>y</m> is concave downward on the interval
    <m>\left(\frac{-1}{\sqrt{6}},\frac{1}{\sqrt{6}}\right)</m>. In
    particular notice that <m>y</m> is concave downward at <m>x=0</m>.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--   <!-\- \label{problem:EvenFuncConcavity} -\-> -->
<!--   Suppose that $y(x)=x^4-x^2$. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Show that the PITPs of $y(x)$ are $x=-\frac{1}{\sqrt{6}}$, and -->
<!--     $x=\frac{1}{\sqrt{6}}$. -->
<!--   \item Show that the graph of $y$ is concave upward on the intervals -->
<!--     $\left(-\infty,\frac{-1}{\sqrt{6}}\right)$ and -->
<!--     $\left(\frac{1}{\sqrt{6}},\infty\right)$. -->
<!--   \item Show that the graph of $y$ is concave downward on the interval -->
<!--     $\left(\frac{-1}{\sqrt{6}},\frac{1}{\sqrt{6}}\right)$. In -->
<!--     particular notice that $y$ is concave downward at $x=0$. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->


<p>
Part (c) of <xref ref="PROBLEMEvenFuncConcavity">Problem~\</xref> displays a very
useful fact about the second derivative.  At <m> x=0</m> the first
derivative of <m>y(x)=x^4-x^2</m> is equal to zero, which means that the
line tangent at zero is horizontal. Also at <m>x=0</m> the second
derivative is negative, which means that at <m>x=0</m> the graph is concave
downward.  Taking these two facts together we can conclude that <m>y(x)</m>
must have a (local) maximum at <m>x=0.</m>
</p>
<p>

That is, for any curve <m>y(x)</m>, if
<me>\dfdxat{y}{x}{a}=0 \text{ and } \eval{\dfdxn{y}{x}{2}}{x}{a}\lt0</me>
then <m>y</m> must have a (local) maximum at <m>x=0</m>. Similarly, for any
curve <m>y(x)</m>, if
<me>\left.\dfdx{y}{x}\right|_{x=a}=0 \text{ and
}\left.\dfdxn{y}{x}{2}\right|_{x=a}\gt  0</me> then <m>y</m> must have a
(local) minimum at <m>x=a.</m>
</p>


<problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Use the observation in the previous paragraph to show that the
    graph of
    <me>
    y(x)=x^4-x^2
    </me>
    has local minima at
    <m>x=\frac{1}{\sqrt{2}}</m>, and at <m>x=-\frac{1}{\sqrt{2}}</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 What is the value of the minima (the <m>y</m> value) of <m>y(x)</m> at
    each <m>x=\frac{1}{\sqrt{2}}</m>, and <m>x=-\frac{1}{\sqrt{2}}</m>?
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate} -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Use the observation in the previous paragraph to show that the -->
<!--     graph of -->
<!--     $$ -->
<!--     y(x)=x^4-x^2 -->
<!--     $$ -->
<!--     has local minima at -->
<!--     $x=\frac{1}{\sqrt{2}}$, and at $x=-\frac{1}{\sqrt{2}}$. -->
<!--   \item What is the value of the minima (the $y$ value) of $y(x)$ at -->
<!--     each $x=\frac{1}{\sqrt{2}}$, and $x=-\frac{1}{\sqrt{2}}$? -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->

<p>
We formalize this idea in the Second Derivative Test, stated below.
</p>

<theorem xml:id="THEOREMSecondDerivativeTest">
  <title>The Second Derivative Test</title>
  <p>
    \label{THEOREMSecondDerivativeTest}
    Suppose <m>y</m> is some differentiable function and that at some point
    <m>a</m> in its domain
    <me>
    \left.\dfdx{y}{x}\right|_{x=a}=0.
    </me>
    Then the following statements are true:
    
    <ol>
      <li>
        <p>
          If <m>\left.\dfdxn{y}{x}{2}\right|_{x=a}\gt 0</m> then <m>y</m> has a    local minimum at <m>x=a.</m>
        </p>
      </li>
      <li>
        <p>
          If <m>\left.\dfdxn{y}{x}{2}\right|_{x=a}\lt 0</m> then <m>y</m> has a    local maximum at <m>x=a.</m>
        </p>
      </li>
      <li>
        <p>
          If <m>\left.\dfdxn{y}{x}{2}\right|_{x=a}=0</m> then we get    no information about possible extrema of <m>y</m> at <m>x=a</m>.
        </p>
      </li>
    </ol>

  </p>
</theorem>



<exercise xml:id="DRILLSecondDerivativeTest">
<introduction>
<p>
  Use the Second Derivative Test to find the local maxima and minima
  of each function. Also identify any global maxima and minima.
</p>
</introduction>
<task>
<statement>
<p>
 <m>y(x)=x^2-5x+2</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=x^3-2x^2-x</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=3x^3-9x</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=x^4-5x^2+4</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=\sin(x)</m>\\ on <m>[0,4\pi]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=\sin(x)+\cos(x)</m>\\ on <m>[0,2\pi]</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=\sec(x)</m>\\ on <m>[0,2\pi]</m>
  </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
<!--   <!-\- \label{drill:SecondDerivativeTest} -\-> -->
<!--   Use the Second Derivative Test to find the local maxima and minima -->
<!--   of each function. Also identify any global maxima and minima. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--     \item $y(x)=x^2-5x+2$ -->
<!--     \item $y(x)=x^3-2x^2-x$ -->
<!--     \item $y(x)=3x^3-9x$ -->
<!--     \item $y(x)=x^4-5x^2+4$ -->
<!--     \item $y(x)=\sin(x)$\\ on $[0,4\pi]$ -->
<!--     \item $y(x)=\sin(x)+\cos(x)$\\ on $[0,2\pi]$ -->
<!--     \item $y(x)=\sec(x)$\\ on $[0,2\pi]$ -->
<!--   \end{enumerate} -->
<!-- \end{ProficiencyDrill} -->
<p>
As you saw in <xref ref="DRILLSecondDerivativeTest">Drill\</xref> when the Second
Derivative Test works it can make quick work of many optimization
problems. But unfortunately part (c) of
<xref ref="THEOREMSecondDerivativeTest">Theorem</xref> is its
<url href="https://en.wikipedia.org/wiki/Achilles%27_heel" visual="https://en.wikipedia.org/wiki/Achilles%27_heel">Achilles
  heel</url>. It is surprisingly common for both the first and second
derivative to be equal to zero at a POTP. When this happens the Second
Derivative Test cannot tell us whether it is an optimal point or not,
so we have to fall back on the First Derivative Test and analyze the
intervals between the the POTPs.
</p>

<exercise>
<introduction>
<p>
  Analyze the concavity of the graphs of each of the following
  functions.
</p>
</introduction>
<task>
<statement>
<p>
 <m>y(x)=x^4</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)= x^3</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)= x^4(x-1)^3</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=\frac{1}{x^4+1}</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)=x^4+x^3</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y(x)= e^{-x^3}</m>
  </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
<!--   Analyze the concavity of the graphs of each of the following -->
<!--   functions. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--     \item $y(x)=x^4$ -->
<!--     \item $y(x)= x^3$ -->
<!--     \item $y(x)= x^4(x-1)^3$ -->
<!--     \item $y(x)=\frac{1}{x^4+1}$ -->
<!--     \item $y(x)=x^4+x^3$ -->
<!--     \item $y(x)= e^{-x^3}$ -->
<!--   \end{enumerate} -->
<!-- \end{ProficiencyDrill} -->

<exercise>
<introduction>
<p>
  Identify all intervals where the given curve is concave upward,
  concave downward, increasing, and decreasing. Identify all local
  optima, and all global optima, if any.

  Graph the curve to check your work after you have solved each
  problem.
</p>
</introduction>
<task>
<statement>
<p>
 <m> y=x^3-2x^2+x+1</m> \solution{ Concave up: <m>(2/3,\infty)</m>
        Concave down: <m>(-\infty, 2/3)</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y= 3x^4-4x^3+6</m> \solution{ Concave up:
        <m>(-\infty, 0)\cup(2/3,\infty)</m> Concave down: <m>(0,2/3)</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=2x^6-6x^4</m> \solution{ Concave up:
        <m>(-\infty, -\sqrt{6/5})\cup(\sqrt{6/5},\infty)</m> Concave down:
        <m>(-\sqrt{6/5},\sqrt{6/5}</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=(x^2-1)^2</m> \solution{ Concave up:
        <m>(-\infty, -1/\sqrt{3})\cup(1/\sqrt{3}, \infty)</m> Concave down:
        <m>(-1/\sqrt{3},1/\sqrt{3})</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=\sqrt[5]{x}-1</m> \solution{ Concave up: <m>(-\infty, 0)</m>
        Concave down: <m>(0, \infty)</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=x^2-\frac{27}{x^2}</m> \solution{ Concave up:
        <m>(-\infty, -3)\cup(3,\infty) </m> Concave down: <m>(-3,3)</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=\frac{x}{x^2+1}</m> \solution{ Concave up:
        <m>(-\sqrt{3},0)\cup(\sqrt{3},\infty)</m> Concave down:
        <m>(-\infty, -\sqrt{3})\cup(0,\sqrt{3})</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=\sqrt[3]{x^2}(3x+10)</m> \solution{ Concave up:
        <m>(2/3, \infty)</m> Concave down: <m>(-\infty, 0)\cup(0, 2/3)</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m> y=8x^{\frac13}+x^{\frac43}</m> \solution{ Concave up:
        <m>(-\infty,0)\cup(4,\infty)</m> Concave down: <m>(0,4)</m>}
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=\sqrt[3]{x}(x-8)</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=\sin^2(x)</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=x+\sin(x)</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=\cos(2x)+\sin(2x)</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=xe^x</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=x^3e^{-x^2}</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=x\ln(x)</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=x^2\ln(x)</m>
    </p>
</statement>
</task>
<task>
<statement>
<p>
 <m>y=\ln(x)e^x</m>
  </p>
</statement>
</task>
</exercise>
<!-- begin{ProficiencyDrill} -->
<!--   Identify all intervals where the given curve is concave upward, -->
<!--   concave downward, increasing, and decreasing. Identify all local -->
<!--   optima, and all global optima, if any. -->

<!--   Graph the curve to check your work after you have solved each -->
<!--   problem. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--     \item <m> y=x^3-2x^2+x+1</m> \solution{ Concave up: <m>(2/3,\infty)</m> -->
<!--         Concave down: <m>(-\infty, 2/3)</m>} -->
<!--     \item <m> y= 3x^4-4x^3+6</m> \solution{ Concave up: -->
<!--         <m>(-\infty, 0)\cup(2/3,\infty)</m> Concave down: <m>(0,2/3)</m>} -->
<!--     \item <m> y=2x^6-6x^4</m> \solution{ Concave up: -->
<!--         <m>(-\infty, -\sqrt{6/5})\cup(\sqrt{6/5},\infty)</m> Concave down: -->
<!--         <m>(-\sqrt{6/5},\sqrt{6/5}</m>} -->
<!--     \item <m> y=(x^2-1)^2</m> \solution{ Concave up: -->
<!--         <m>(-\infty, -1/\sqrt{3})\cup(1/\sqrt{3}, \infty)</m> Concave down: -->
<!--         <m>(-1/\sqrt{3},1/\sqrt{3})</m>} -->
<!--     \item <m> y=\sqrt[5]{x}-1</m> \solution{ Concave up: <m>(-\infty, 0)</m> -->
<!--         Concave down: <m>(0, \infty)</m>} -->
<!--     \item <m> y=x^2-\frac{27}{x^2}</m> \solution{ Concave up: -->
<!--         <m>(-\infty, -3)\cup(3,\infty) </m> Concave down: <m>(-3,3)</m>} -->
<!--     \item <m> y=\frac{x}{x^2+1}</m> \solution{ Concave up: -->
<!--         <m>(-\sqrt{3},0)\cup(\sqrt{3},\infty)</m> Concave down: -->
<!--         <m>(-\infty, -\sqrt{3})\cup(0,\sqrt{3})</m>} -->
<!--     \item <m> y=\sqrt[3]{x^2}(3x+10)</m> \solution{ Concave up: -->
<!--         <m>(2/3, \infty)</m> Concave down: <m>(-\infty, 0)\cup(0, 2/3)</m>} -->
<!--     \item <m> y=8x^{\frac13}+x^{\frac43}</m> \solution{ Concave up: -->
<!--         <m>(-\infty,0)\cup(4,\infty)</m> Concave down: <m>(0,4)</m>} -->
<!--     \item <m>y=\sqrt[3]{x}(x-8)</m> -->
<!--     \item <m>y=\sin^2(x)</m> -->
<!--     \item <m>y=x+\sin(x)</m> -->
<!--     \item <m>y=\cos(2x)+\sin(2x)</m> -->
<!--     \item <m>y=xe^x</m> -->
<!--     \item <m>y=x^3e^{-x^2}</m> -->
<!--     \item <m>y=x\ln(x)</m> -->
<!--     \item <m>y=x^2\ln(x)</m> -->
<!--     \item <m>y=\ln(x)e^x</m> -->
<!--   \end{enumerate} -->
<!-- \end{ProficiencyDrill} -->


<problem>
<introduction>
<p>
  Show that <m>y(x)=\frac{x(x-1)}{x^3-27}</m> has
</p>
</introduction>
<task>
<statement>
<p>
 both a global and a local minimum if its domain is the
    interval <m>(-5,0)</m>, and
  </p>
</statement>
</task>
<task>
<statement>
<p>
 only a local minimum if its domain is the interval
    <m>\left(-5, \frac52\right)</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Does the graph of this function have a global maximum for
    either of the domains given in parts (a) or (b)? Explain.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-1line} -->
<!--   Show that <m>y(x)=\frac{x(x-1)}{x^3-27}</m> has -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item both a global and a local minimum if its domain is the -->
<!--     interval <m>(-5,0)</m>, and -->
<!--   \item only a local minimum if its domain is the interval -->
<!--     <m>\left(-5, \frac52\right)</m>. -->
<!--   \item Does the graph of this function have a global maximum for -->
<!--     either of the domains given in parts (a) or (b)? Explain. -->
<!--   \end{enumerate} -->
<!--   \hint{Use Newton's Method, and the First Derivative Test.} -->
<!-- \end{embeddedproblem-1line} -->
  
<problem>
<statement>
<p>
  Does <m>f(x)=\sin(x)</m> have a global extremum (minimum or maximum) on
  the interval <m>\left(0,\frac{\pi}{2}\right)</m>? How about on <m>(0,
  \pi)</m>? On <m>(0, 2\pi)</m>? Explain.\\
  \hint{Use the First Derivative Test.}
</p>
</statement>
</problem>


<aside>
<title>Note to self</title>
<p>
Multilevel Problem missing here
</p>
</aside>


<problem>
<introduction>
<p>
 Suppose that <m>O(x) = \frac{x^2}{1+x^2}</m> and that the domain of the
  problem is all real numbers (<m>\RR</m>).
</p>
</introduction>
<task>
<statement>
<p>
 Find all local extrema.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Find all global extrema.
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--  Suppose that <m>O(x) = \frac{x^2}{1+x^2}</m> and that the domain of the -->
<!--   problem is all real numbers (<m>\RR</m>). -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Find all local extrema. -->
<!--   \item Find all global extrema. -->
<!--   \end{enumerate} -->
<!--   \hint{Use the First Derivative Test.} -->
<!-- \end{embeddedproblem} -->

<problem>
<introduction>
<p>
  Consider the polynomial <m> y(x) = (x+1)^3(x-1)(x+3)</m>.
</p>
</introduction>
<task>
<statement>
<p>
 Show that <m>\dfdxat{y}{x}{-1}=0.</m>\\
    \noindent  \hint{You can save yourself a lot of work on this
      problem by keeping your eye on the goal.  The problem is to show
      that <m>\left.\dfdx{y}{x}\right|_{x=-1}=0</m>, not to compute
      <m>\dfdx{y}{x}</m> and then <q>simplify</q> it.}
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Graph <m>y</m> near <m>x=-1</m> to convince yourself that <m>y</m> has
    neither a maximum nor a minimum at <m>x=-1</m>.
              </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem} -->
<!--   Consider the polynomial $ y(x) = (x+1)^3(x-1)(x+3)$. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Show that $\dfdxat{y}{x}{-1}=0.$\\ -->
<!--     \noindent  \hint{You can save yourself a lot of work on this -->
<!--       problem by keeping your eye on the goal.  The problem is to show -->
<!--       that $\left.\dfdx{y}{x}\right|_{x=-1}=0$, not to compute -->
<!--       $\dfdx{y}{x}$ and then <q>simplify</q> it.} -->
<!--   \item Graph $y$ near $x=-1$ to convince yourself that $y$ has -->
<!--     neither a maximum nor a minimum at $x=-1$. -->
<!--               \end{enumerate} -->
<!-- \end{embeddedproblem} -->

<p>
As we've said before, Calculus is merely one tool in your problem
solving toolbox. Moreover it is almost never the first tool you should
reach for.  You will frequently need to use your skills with Algebra,
Geometry, or Trigonometry to transform a problem into a form which
allows you to bring Calculus to bear on it.  You will need to take it
slowly, think clearly, and be careful. Frequently you will find that
your first first few ideas aren't working. When that happens, find
another idea and start again.
</p>
<p>

On the other hand you will often have a good deal of insight into
real-world problems because they are, well, real-world problems, and
you understand a lot about the real world.
</p>

</subsection>
</section>

<section xml:id="SECTIONoptim-probl">
<title>Optimization Problems</title>

<introduction>

<p>
So far in this chapter the examples and problems we've chosen we've
chosen emphasized the different aspects of optimization. Our intention
was to show you the subtleties involved one at a time so you could
understand them separately.
</p>

<p>
Of course, this is entirely unrealistic. Real problems rarely tell you
where the difficulties will lie, so in this final section we offer you
a selection of problems. It is up to you to
</p>
<p>
<ol>
  <li>
    <p>
      Find an appropriate objective function.
    </p>
  </li>
  <li>
    <p>
      Identify the constraints.
    </p>
  </li>
  <li>
    <p>
      Decide whether the natural domain of the problem consists closed  intervals or not.
    </p>
  </li>
  <li>
    <p>
      Identify any POTPs.  If the problem domain consists only of closed intervals use  <xref ref="SECoptim-probl">Theorem</xref>. Otherwise use the First or the  Second Derivative Test.
    </p>
  </li>
  <li>
    <p>
      Identify which, if any, of the POTPs are global optima.
    </p>
  </li>
  <li>
    <p>
      Re-read the problem and confirm that you have solved it.  In the process of finding an optimum it is easy to lose track of the  question and stop too soon. Always make sure you have actually  solved the problem as stated.
    </p>
  </li>
</ol>
</p>
<p>
Recall that in <xref ref="EXfixed-perimeter">Example~\</xref> we observed that
most people can see intuitively that of all rectangles with a fixed
perimeter the one that encloses the greatest area will be a square. We
gave an algebraic demonstration of this in
<xref ref="CHAPTERScienceBeforeCalc">Chapter</xref> but now that we know how to
use Calculus to optimize let's revisit this problem.
</p>
<example xml:id="EXAMPLERectangleFixedPerimeter">
<title><xref ref="EXAMPLEFixedPerimeter"></xref> revisited again</title>
  <!-- \label{example:RectangleFixedPerimeter} -->
<p>
  We first solved this problem in <xref ref="EXfixed-perimeter">Example~\</xref>
  where we solved it algebraically.  We revisited it the first time in
  <xref ref="PROBLEMMaximalSquareRedux1">Problem~\</xref> where we solved it again
  analytically (using Calculus) twice. But to do this we relied on
  Fermat's Theorem and Fermat's Theorem only allows us to find a
  maximum that we already know exists. At that time we did not have
  the tools to show that we actually had a maximum. We do now so we
  will solve this problem one last time before we move on.
</p>
<p>
  Show that of all rectangles with a fixed perimeter, <m>P</m>,
  the one with the greatest area is a square.\\
</p>
      
<image source="images/PerimeterArea.png" width="60%" />
<!-- \centerline{\includegraphics*[height=1.3in,width=2.6in]{../Figures/PerimeterArea}} -->
<p>
  We will follow the outline above.
</p>
<p>
<ol>
  <li>
    <p>
      The objective function is <me>
      \label{eq:FixedPerimeterObjective} A=xy, </me>
    </p>
  </li>
  <li>
    <p>
      The only constraint is 
      <men  xml:id="EQUATIONFixedPerimeterConstraint1"> 
        <!-- \label{EQUATIONFixedPerimeterConstraint1} -->
      P=2x+2y 
      </men> 
where <m>P</m> is constant.
    </p>
  </li>
  <li>
    <p>
      Since we are talking about a length it must be that
      <m>x\ge0</m>. From <xref
      ref="EQFixedPerimeterConstraint">Equation~</xref>) we see that
      <m>x</m> must be less that or equal to <m>\frac{P}{2}</m>. Otherwise the
      perimeter will be greater than <m>P</m>. So the domain\aside{Strictly
      speaking if <m>x=0</m> or <m>x=\frac{P}{2}</m> we don't actually have a
      rectangle. But it is simpler to use the Extreme Value Theorem
      (<xref ref="THEOREMmax-min">Theorem~\</xref>) than to find the
      increasing and decreasing intervals using the First Derivative
      Test. Since the Extreme Value Theorem requires a closed domain
      we make things simpler by allowing <q>zero width</q> rectangles.}
      of our problem is <m>0\le x\le \frac{P}{2}</m>.
    </p>
  </li>
  <li>
    <p>
      Since the problem domain is a closed interval we will use the
      Extreme Value Theorem (<xref ref="THEOREMmax-min">Theorem~\</xref>).
      To find the POTPs we will need <m>\dfdx{A}{x}</m>. From

      <xref ref="EQFixedPerimeterObjective">Equation~</xref>) we see that
      <men  xml:id="EQUATIONMaxAreaDiffeq1">      
      <!-- \label{eq:MaxAreaDiffeq1} -->
      \dx{A}=x\dx{y}+y\dx{x}.
    </men>
    </p>
<p>
    From <xref ref="EQFixedPerimeterConstraint">Equation~</xref>) we have
<men  xml:id="EQUATIONFixedPerimeterDiffConstraint1">
      <!-- \label{eq:FixedPerimeterDiffConstraint1} -->
      \dx{y}=-\dx{x}
    </men>
    and also
    <men  xml:id="EQUATIONFixedPerimeterConstraintDiffeq1">     
 <!-- \label{EQUATIONFixedPerimeterConstraintDiffeq1} -->
      y=\frac12\left(P-2x\right)    
    </men>
</p>
<p>
    Combining
<xref ref="EQFixedPerimeterConstraint"></xref>,
<xref ref="EQMaxAreaDiffeq">xref>),~</xref>,
and
<xref ref="EQFixedPerimeterConstraintDiffeq"></xref>
we see that    <me>    \dfdx{A}{x}=\frac{P}{2}-2x.    </me>    The only solution of <m>\dfdx{A}{x}=0</m> is <m>x=\frac{P}{4}</m>, so the    POTPs for this problem are the end points, <m>x=0</m> and    <m>x=\frac{P}{2}</m>, and <m>x=\frac{P}{4}</m>.
    </p>
  </li>
  <li>
    <p>
      The area, <m>A=xy</m>, will be zero when <m>x=0</m> and when    <m>x=\frac{P}{2}</m> (why?) so by the Extreme Value Theorem the maximum    occurs when <m>x=\frac{P}{4}</m>.
    </p>
  </li>
  <li>
    <p>
      This problem asks us to show that the maximal rectangle must    be a square, so we need to show that <m>x=y</m>. We know that the    maximum occurs when <m>x=\frac{P}{4}</m>. Plugging this value into    <xref ref="EQFixedPerimeterConstraintDiffeq">Equation~\</xref> we see that <m>y</m>    is also equal to <m>\frac{P}{4}</m>. Thus the maximal rectangle is a    square as stated.
    </p>
  </li>
</ol>
</p>
<p>
  <ol>
    <li>
      <p>
        The objective function is
        <men  xml:id="EQUATIONFixedPerimeterObjective">
          <!-- \label{eq:FixedPerimeterObjective} -->
          A=xy,
        </men>
      </p>
    </li>
    <li>
      <p>
        The only constraint is
    <men  xml:id="EQUATIONFixedPerimeterConstraint2">
      <!-- \label{EQUATIONFixedPerimeterConstraint2} -->
      P=2x+2y
    </men>
    where <m>P</m> is constant.
      </p>
    </li>
    <li>
      <p>
        Since we are talking about a length it must be that
    <m>x\ge0</m>. From <xref ref="EQFixedPerimeterConstraint">Equation~</xref>) we see
    that <m>x</m> must be less that or equal to <m>\frac{P}{2}</m>. Otherwise
    the perimeter will be greater than <m>P</m>. So the
    domain\aside{Strictly speaking if <m>x=0</m> or <m>x=\frac{P}{2}</m> we
    don't actually have a rectangle. But it is simpler to use the
    Extreme Value Theorem (<xref ref="THEOREMmax-min">Theorem~\</xref>) than to find the
    increasing and decreasing intervals using the First Derivative
    Test. Since the Extreme Value Theorem requires a closed domain we make
    things simpler by allowing <q>zero width</q> rectangles.} of our
    problem is <m>0\le x\le \frac{P}{2}</m>.
      </p>
    </li>
    <li>
      <p>
        Since the problem domain is a closed interval we will use the
    Extreme Value Theorem (<xref ref="THEOREMmax-min">Theorem~\</xref>).
    To find the POTPs we will need <m>\dfdx{A}{x}</m>. From
    <xref ref="EQFixedPerimeterObjective">Equation~</xref>) we see that
    <men  xml:id="EQUATIONMaxAreaDiffeq2">
      <!-- \label{eq:MaxAreaDiffeq2} -->
      \dx{A}=x\dx{y}+y\dx{x}.
    </men>
    From <xref ref="EQFixedPerimeterConstraint">Equation~</xref>) we have
    <men  xml:id="EQUATIONFixedPerimeterDiffConstraint2">
      <!-- \label{eq:FixedPerimeterDiffConstraint2} -->
      \dx{y}=-\dx{x}
    </men>
    and also
    <men  xml:id="EQUATIONFixedPerimeterConstraintDiffeq2">
      <!-- \label{EQUATIONFixedPerimeterConstraintDiffeq2} -->
      y=\frac12\left(P-2x\right)
    </men>
    Combining
    <xref ref="EQFixedPerimeterConstraint"></xref>
    <xref ref="EQMaxAreaDiffeq"></xref>),
    and
    <xref ref="EQFixedPerimeterConstraintDiffeq"></xref>) we see that
    <me>
    \dfdx{A}{x}=\frac{P}{2}-2x.
    </me>
    The only solution of <m>\dfdx{A}{x}=0</m> is <m>x=\frac{P}{4}</m>, so the
    POTPs for this problem are the end points, <m>x=0</m> and
    <m>x=\frac{P}{2}</m>, and <m>x=\frac{P}{4}</m>.
      </p>
    </li>
    <li>
      <p>
        The area, <m>A=xy</m>, will be zero when <m>x=0</m> and when
    <m>x=\frac{P}{2}</m> (why?) so by the Extreme Value Theorem the maximum
    occurs when <m>x=\frac{P}{4}</m>.
      </p>
    </li>
    <li>
      <p>
        This problem asks us to show that the maximal rectangle must
    be a square, so we need to show that <m>x=y</m>. We know that the
    maximum occurs when <m>x=\frac{P}{4}</m>. Plugging this value into
    <xref ref="EQFixedPerimeterConstraintDiffeq">Equation~\</xref> we see that <m>y</m>
    is also equal to <m>\frac{P}{4}</m>. Thus the maximal rectangle is a
    square as stated.
      </p>
    </li>
  </ol>
</p>

</example>
<p>
In <xref ref="EXAMPLERectangleFixedPerimeter">Example~\</xref> we were careful to
follow the steps we listed at the beginning of this section in the
sequence given. That list is helpful. That's why we wrote it
out. However, it would be a mistake to think of it as a recipe to be
followed blindly. Think of it as an outline. An outline is a guide,
not a recipe and it is not necessary to follow it rigidly,
step-by-step. If you find it simpler to do these steps in a different
order for some problem there is no reason that you shouldn't. But
before you declare the problem solved look back at this outline and
make sure that you have done everything that needs to be done. This is
what an outline is for.
</p>
<p>
In <xref ref="EXAMPLESquareMinimalPerimeter">Example~\</xref> in
<xref ref="CHAPTERScienceBeforeCalc">Chapter</xref> we considered the related
problem of minimizing the perimeter when the area is fixed. The
following problem asks you to solve this problem using
Calculus. Notice that just as above we have
<me>A=xy</me> and <me>P=2x+2y</me> but this time <m>A</m> is constant, not <m>P</m>.
</p>

<problem xml:id="PROBLEMMaxPerimeter">
<introduction>
<p>
  Out of all rectangles with a fixed area, find the dimensions of the
  one with the smallest perimeter.
</p>
</introduction>
<task>
<statement>
<p>
 Identify the objective function and the constraint for this
    problem.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Find the natural domain of this problem and show that it is
    not a closed interval.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that we have a POTP when <m>x=y</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that when <m>x=y</m> we have a minimum by:
  
  <ol>
    <li>
      <p>
        Using the first derivative test.
      </p>
    </li>
    <li>
      <p>
        Using the second derivative test.
      </p>
    </li>
  </ol>

    Note that both tests will require you to use the constraint to
    reduce the number of variables in the objective to one.

    Which test was easier to use?
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem}  ;;; MULTILEVEL PROBLEM -->
<!--   <!-\- <!-\\- <!-\\\- \label{problem:MaxPerimeter} -\\\-> -\\-> -\-> -->
<!--   Out of all rectangles with a fixed area, find the dimensions of the -->
<!--   one with the smallest perimeter. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Identify the objective function and the constraint for this -->
<!--     problem. -->
<!--   \item Find the natural domain of this problem and show that it is -->
<!--     not a closed interval. -->
<!--   \item Show that we have a POTP when <m>x=y</m>. -->
<!--   \item Show that when <m>x=y</m> we have a minimum by: -->
  
<!--   <ol> -->
<!--     <li> -->
<!--       <p> -->
<!--         Using the first derivative test. -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Using the second derivative test. -->
<!--       </p> -->
<!--     </li> -->
<!--   </ol> -->

<!--     Note that both tests will require you to use the constraint to -->
<!--     reduce the number of variables in the objective to one. -->

<!--     Which test was easier to use? -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->

<problem>
<statement>
<p>
  Redo <xref ref="PROBLEMscience-before-calc-1"></xref> from
  <xref ref="CHAPTERScienceBeforeCalc">Chapter</xref> using Calculus. Verify that
  you get the same answer as before.
</p>
</statement>
</problem>
<p>
The following example demonstrates how different approaches to the
same problem can lead to different challenges. In this case just
changing the labels on the diagram makes a big difference.
</p>
<example xml:id="EXAMPLEPageOfText">
<introduction>
<p>

  The pages of a book are to have an area of <m>90</m> square
  centimeters. The side and bottom margins are to be <m>1</m> centimeter in
  width and the top margin is to be <m>1/2</m> centimeter in width.
</p>
<p>

  Find the dimensions of the page that has the largest possible
  printed area, <m>P_A</m>.
</p>
</introduction>

<task>
<title>First Solution:</title>
<!--   <figure> -->
<!-- <caption> -->
<!-- <url href="https://en.wikipedia.org/wiki/Candela" visual="https://en.wikipedia.org/wiki/Candela">This figure needs a caption.</url> -->
<!-- </caption> -->
<image source="images/LoremIpsum1.png" width="50%"/>
<!-- </figure> -->

<p>
  This problem can be visualized as in the diagram above.  Since
  it is the printed area that is to be maximized it seems natural to
  label the width of the printed area, <m>x</m>, and the height, <m>y</m>, as
  shown. If we call the printed area <m>P_A</m> then our objective function
  is,
  <me>
    P_A=xy.\label{eq:BookPage1}
</me>
</p>
<p>
  The width of the entire page will be <m>x+2</m>, and the height will be
  <m>y+3/2</m>. The area of each page is constrained to be <m>90</m> square
  centimeters so our constraint is,
  <me>
    \label{eq:BookPage2}
    (x+2)(y+3/2)=90.
  </me>
  Differentiating <xref ref="EQBookPage1">Equation~</xref>) we see
  that
  <me>
    \label{eq:BookPage5}
    \dx{(P_A)}=x{\color{red}{\dx{y}}}+{\color{blue}{y}}\dx{x}
  </me>
  Solving <xref ref="EQBookPage2">Equation~</xref>) for <m>y</m> we have
  <me>
    \label{eq:BookPage3}
    {\color{blue}{y=\frac{90}{x+2}-3/2}}
  </me>
  Differentiating <xref ref="EQBookPage2">Equation~\</xref> and solving for
  <m>\dx{y}</m> gives
<me>
{\color{red}{\dx{y}}=-\left(\frac{\textcolor{blue}{y}+3/2}{x+2}\right)\dx{x}}.
</me>
Substituting these into <xref ref="EQBookPage5">Equation~\</xref> we have
\begin{align*}
      \dx{(P_A)}\amp =-x\textcolor{red}{\left(\frac{\textcolor{blue}{\frac{90}{x+2}-3/2}+3/2}{x+2}\right)}\dx{x}+\left(\textcolor{blue}{\frac{90}{x+2}-3/2}\right)\dx{x}.
    \end{align*}
Since we'll have to set this equal to zero and to find any POTPs it is
clearly in our interest to reduce this algebraically to
\begin{align}
  \dfdx{(P_A)}{x}\amp =\frac{-90x}{(x+2)^2}+\frac{90}{x+2}-3/2.\label{eq:BookPage4}
\end{align}
Adding the fractions we see that we must solve
<me>
\dfdx{(P_A)}{x}=\frac{-90x+90(x+2)-3/2(x+2)^2}{(x+2)^2}=\frac{180-3/2(x+2)^2}{(x+2)^2}=0.
</me>
At this point it is tempting to expand <m>(x+2)^2</m>, but recall that our
goal is to solve for <m>x</m>. Multiplying through by <m>(x+2)^2</m> gives
<me>
0=180-\frac{3}{2}(x+2)^2
  </me>
  so that
  <me>
  (x+2)^2=120.
</me>
Solving this gives\aside{You can <q>simplify</q> <m>x=\pm\sqrt{120}-2</m> to
  <m>x=\pm2\sqrt{30}-2</m> if you like, but there is no real advantage to
  doing so. We prefer to leave it as <m>x=\pm\sqrt{120}-2</m>.  }
<m>x=\pm\sqrt{120}-2</m>. But the width of a page can't be negative so a
negative solution is meaningless for this problem.  Thus
<m>x=\sqrt{120}-2</m> is our one and only POTP, and we conclude that we can
maximize the printed area by taking <m>x=\sqrt{120}-2\approx 8.95</m>
centimeters.
</p>
<p>

That was a lot of work but we are not finished The problem asks us to
find the dimensions (plural) of the page.  To find <m>y</m> we use
<xref ref="EQBookPage3">Equation~</xref>) to compute
<me>y\approx\frac{90}{\sqrt{120}-2+2}-3/2
=\frac{90}{\sqrt{120}}-3/2\approx 8.08.</me>
</p>
<p>

But we're still not finished. The problem asks for the dimensions of
the page, but we've only  found the dimensions of the printed
  area. The dimensions of the page are
<md>
<mrow>
  \text{Width of page} \amp  = \text{\textcolor{blue}{width of text}} + \text{\textcolor{red}{margins}} =\textcolor{blue}{\sqrt{120} -2} +\textcolor{red}{2} =\sqrt{120} \approx 10.95 \text{ cm}\\
</mrow>
<mrow>
  \text{Height of page} \amp = \text{\textcolor{blue}{height of  text}} + \text{\textcolor{red}{margins}}
  =\textcolor{blue}{\frac{90}{\sqrt{120}}-3/2} + \textcolor{red}{3/2}  = \frac{90}{\sqrt{120}}\approx 8.22 \text{ cm}.
</mrow>
</md>

</p>
<p>

Finally, the last item in our outline says to make sure we have done
everything that needs to be done to solve the problem. Have we?
</p>
<p>

No, clearly not. We never did step \#3: Identify the natural domain of
the problem. As a result we don't know for certain that we have a
maximum. It may be that the critical point we've identified is not in
the problem domain. It may be that it is in the domain, but that we
have a minimum instead of a maximum. Or that we have neither. The
point is that we can't know until we have found the natural domain of
the objective function, and verified that there is a global maximum at
<m>x=\sqrt{120}-2\approx8.95</m> centimeters.
</p>
<p>

We mentioned earlier that the width of the page can't be negative so
the smallest possible value of <m>x</m>, the left endpoint of our interval,
is zero.
</p>
</task>
</example>

<problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 Show that the largest possible value of <m>x</m> is <m>x=58</m> and thus
    the natural domain for this problem is the closed interval
    <m>[0,58]</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Show that the maximal printed area occurs when
    <m>x=2\sqrt{30}-2</m>.
  </p>
</statement>
</task>
</problem>
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Show that the largest possible value of <m>x</m> is <m>x=58</m> and thus -->
<!--     the natural domain for this problem is the closed interval -->
<!--     <m>[0,58]</m>. -->
<!--   \item Show that the maximal printed area occurs when -->
<!--     <m>x=2\sqrt{30}-2</m>. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->


</introduction>


<subsection xml:id="SUBSECTIONOptSecondSolution">
<title>Second Solution:</title>

<p>
There is often more than one objective function that will work for any
given problem. If your first attempt does not seem to be working ---
even if you are sure you have an objective that will work --- you
always have the option of going back to the beginning and trying to
find another valid objective function.
</p>
<p>
For our second solution we will use the same diagram, but with
different labeling.  As you
can see at the left, this time we've let <m>x</m> and <m>y</m> represent,
respectively, the width and height of the page rather than of
the printed area.
</p>
<image source="images/LoremIpsum2.png" width="50%"/>
<!-- \begin{wrapfigure}[21]{l}{2.5in} -->
<!--     \captionsetup{labelformat=empty} -->
<!--   \centerline{\includegraphics*[height=3in,width=2.5in]{../Figures/LoremIpsum2}} -->
<!--   \label{fig:LoremIpsum2} -->
<!-- \end{wrapfigure} -->

<p>
Our objective function is still the area of the printed portion of the
page, but with the updated labeling this becomes
<me>
  P_A=(x-2)(y-3/2).\label{eq:LoremIpsum3}
</me>
</p>
<p>
Differentiating this we have
<me>
  \dx{(P_A)}=(x-2)\dx{y}+(y-3/2)\dx{x}.\label{eq:LoremIpsum4}
</me>
The constraint is still that the area of the page is <m>90</m> square
centimeters, but this is now given by
<me>
  90=xy.\label{eq:LoremIpsum5}
</me>
Differentiating the constraint gives
<me>
x\dx{y}+y\dx{x}=0,
</me>
from which we see that <m>\dx{y}=-\frac{y}{x}\dx{x}</m>.  From
<xref ref="EQLoremIpsum5">Equation~</xref>) we see that <m>y=\frac{90}{x}</m>.
Substituting these into <xref ref="EQLoremIpsum4">Equation~</xref>) we get
<md>
<mrow>
  \dx{(P_A)}\amp =(x-2)\left(-\frac{y}{x}\right)\dx{x}+\left(\frac{90}{x}-\frac32\right)\dx{x}\\
</mrow>
<mrow>
  \amp =\left[-(x-2)\left(\frac{90}{x^2}\right)+\frac{90}{x}-\frac32\right]\dx{x}\\
</mrow>
<mrow>
 \dfdx{(P_A)}{x} \amp =-(x-2)\left(\frac{90}{x^2}\right)+\frac{90}{x}-\frac32
</mrow>
</md>
</p>

<p>
Setting this equal to zero and solving for <m>x</m> gives
<md>
  <mrow>
    -(x-2)\left(\frac{90}{x^2}\right)+\frac{90}{x}-\frac32 \amp =0\\
  </mrow>
  <mrow>
    \textcolor{red}{-\frac{90}{x}} -\frac{180}{x^2}+\textcolor{red}{\frac{90}{x}}-\frac32\amp =0\\
  </mrow>
  <mrow>
    \frac{180}{x^2}-\frac32 \amp =0\\
  </mrow>
  <mrow>
    \frac23\cdot180\amp =x^2 \text{ or}\\
  </mrow>
  <mrow>
    x\amp =\pm\sqrt{120}.
  </mrow>
</md>
As before, we know that the width of a page cannot be negative so the
only POTP is <m>x=\sqrt{120}</m>.
</p>
<p>
This time <m>x</m> and <m>y</m> represent the width and height of the page, so
the width of the printed text is will be <m>\sqrt{120}-2</m> as
before. Similarly the height of the printed text will be
<m>\frac{90}{\sqrt{120}}-\frac32</m>.
</p>
<exercise>
<statement>
<p>
  Determine the natural domain of <m>P_A(x)</m> and show that <m>P_A(x)</m> is a
  global maximum when <m>x=\sqrt{120}</m>.  Do you get the same page
  dimensions as before?
</p>
</statement>
</exercise>


<p>
You will find that, quite often, simplifying complex expressions as
much as possible with Algebra, Geometry, or Trigonometry will lead to
easier Calculus computations. Conversely less non-Calculus work often
leads to more challenging differentiations.  But this is not a
hard-and-fast rule. Sometimes you will find that leaving the formulas
you generate unsimplified gives better insight into the problem,
making things a little simpler overall, even if it makes the
differentiation quite onerous.
</p>

<p>
Which parts of a given problem you find easy or difficult will depend
on your skill level with your tools. With experience comes the ability
to balance the workload across your skills. When you realize that one
approach will lead to a complication that you know you will find
difficult to handle, it can be beneficial to stop and look for another
approach.  If you find one, stop and try again from the beginning.
</p>

<p>
Then identify where your skill is lacking and give yourself some
practice with that particular skill to improve your skills
overall. Review, practice, and improve your Algebra, Geometry, and
Trigonometry skills as needed.
</p>

<p>
A common mistake when abandoning a first attempt is to try to preserve
and reuse computations left over from your first try. But that attempt
didn't work. You need to try something new.
</p>

<problem>
<title>Variations on a Theme</title>

<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
  
  <ol>
    <li>
      <p>
        Find two positive numbers whose sum is 10, and whose product      is a maximum. What is the maximum?  \solution{ The two numbers        are both <m>5</m>, so the maximum product is <m>25</m>.}
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers whose sum is <m>8</m>, and whose      product is a maximum. What is the maximum?  \solution{ The two        numbers are both <m>4</m>, so the maximum product is <m>16</m>.  }
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers whose sum is <m>K</m>, and whose      product is a maximum. What is the maximum?  \solution{ The two        numbers are both <m>\frac{K}{2}</m>, so the maximum product is        <m>\frac{K^2}{4}</m>.  }
      </p>
    </li>
  </ol>

  </p>
</statement>
</task>
<task>
<statement>
<p>

  
  <ol>
    <li>
      <p>
        Find two positive numbers such that the sum of one of them and
        twice the other is 10, and whose product is a maximum. What is
        the maximum?  \solution{ One of the numbers is <m>5</m>, and the
        other is <m>\frac52</m> so the maximum product is <m>\frac{25}{4}</m>.
        }
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers such that the sum of one of them and
        three times the other is 10, and whose product is a
        maximum. What is the maximum?  \solution{ One of the numbers
        is <m>5</m>, and the other is <m>\frac53</m> so the maximum product is
        <m>\frac{25}{6}</m>.  }
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers such that the sum of one of them and
        five times the other is 10, and whose product is a
        maximum. What is the maximum?  \solution{ One of the numbers
        is <m>5</m>, and the other is <m>1</m> so the maximum product is <m>5</m>.}
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers such that the sum of one of them and
        <m>n</m> times the other is K, and whose product is a maximum. What
        is the maximum?
      </p>
    </li>
  </ol>

  </p>
</statement>
</task>
<task>
<statement>
<p>

  
  <ol>
    <li>
      <p>
        Find two positive numbers whose product is <m>10</m>, and whose      sum is a minimum. What is the minimum?  \solution{ The two        numbers are both <m>\sqrt{10}</m>, so the minimum sum is        <m>\frac{2}{\sqrt{10}}</m>.  }
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers whose product is <m>M</m>, and whose      sum is a minimum. What is the minimum?  \solution{ The two        numbers are both <m>\sqrt{M}</m>, so the minimum sum is        <m>\frac{2}{\sqrt{M}}</m>.  }
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers whose product is <m>M</m>, and the sum      one number and three times the other is a minimum. What is the      minimum?  \solution{ One number is <m>\sqrt{3M}</m>, and the other is        <m>\sqrt{\frac{M}{3}}</m> so the minimum sum is        <m>4\sqrt{\frac{M}{3}}</m>.}
      </p>
    </li>
    <li>
      <p>
        Find two positive numbers whose product is <m>M</m>, and the sum      one number and <m>n</m> times the other is a minimum. What is the      minimum?
      </p>
    </li>
  </ol>

  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate}[Variations on a Theme] -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item -->
  
<!--   <ol> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers whose sum is 10, and whose product      is a maximum. What is the maximum?  \solution{ The two numbers        are both <m>5</m>, so the maximum product is <m>25</m>.} -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers whose sum is <m>8</m>, and whose      product is a maximum. What is the maximum?  \solution{ The two        numbers are both <m>4</m>, so the maximum product is <m>16</m>.  } -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers whose sum is <m>K</m>, and whose      product is a maximum. What is the maximum?  \solution{ The two        numbers are both <m>\frac{K}{2}</m>, so the maximum product is        <m>\frac{K^2}{4}</m>.  } -->
<!--       </p> -->
<!--     </li> -->
<!--   </ol> -->

<!--   \item -->
  
<!--   <ol> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers such that the sum of one of them and -->
<!--         twice the other is 10, and whose product is a maximum. What is -->
<!--         the maximum?  \solution{ One of the numbers is <m>5</m>, and the -->
<!--         other is <m>\frac52</m> so the maximum product is <m>\frac{25}{4}</m>. -->
<!--         } -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers such that the sum of one of them and -->
<!--         three times the other is 10, and whose product is a -->
<!--         maximum. What is the maximum?  \solution{ One of the numbers -->
<!--         is <m>5</m>, and the other is <m>\frac53</m> so the maximum product is -->
<!--         <m>\frac{25}{6}</m>.  } -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers such that the sum of one of them and -->
<!--         five times the other is 10, and whose product is a -->
<!--         maximum. What is the maximum?  \solution{ One of the numbers -->
<!--         is <m>5</m>, and the other is <m>1</m> so the maximum product is <m>5</m>.} -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers such that the sum of one of them and -->
<!--         <m>n</m> times the other is K, and whose product is a maximum. What -->
<!--         is the maximum? -->
<!--       </p> -->
<!--     </li> -->
<!--   </ol> -->

<!--   \item -->
  
<!--   <ol> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers whose product is <m>10</m>, and whose      sum is a minimum. What is the minimum?  \solution{ The two        numbers are both <m>\sqrt{10}</m>, so the minimum sum is        <m>\frac{2}{\sqrt{10}}</m>.  } -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers whose product is <m>M</m>, and whose      sum is a minimum. What is the minimum?  \solution{ The two        numbers are both <m>\sqrt{M}</m>, so the minimum sum is        <m>\frac{2}{\sqrt{M}}</m>.  } -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers whose product is <m>M</m>, and the sum      one number and three times the other is a minimum. What is the      minimum?  \solution{ One number is <m>\sqrt{3M}</m>, and the other is        <m>\sqrt{\frac{M}{3}}</m> so the minimum sum is        <m>4\sqrt{\frac{M}{3}}</m>.} -->
<!--       </p> -->
<!--     </li> -->
<!--     <li> -->
<!--       <p> -->
<!--         Find two positive numbers whose product is <m>M</m>, and the sum      one number and <m>n</m> times the other is a minimum. What is the      minimum? -->
<!--       </p> -->
<!--     </li> -->
<!--   </ol> -->

<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->


<problem>
<title>Variations on a Theme</title>

<introduction>
<p>
  You have <m>500</m> meters of fencing with which to build an animal pen.
</p>
</introduction>
<task>
<statement>
<p>

    
<ol>
    <li>
<p>
 What is the largest area you can enclose with a freestanding      rectangular pen?  \solution{ <m>250^2/4</m> square feet }
</p>
</li>
    <li>
<p>
 You want to build a pen with a fence across the center to      divide the large pen into two equally sized internal pens. What      is the largest area you can enclose?  \solution{ <m>(250^2/6</m>         square feet }
</p>
</li>
    <li>
<p>
 You want to build a pen with two parallel fences across the      center to divide the large pen into three equally sized internal      pens. What is the largest area you can enclose?  \solution{        <m>\frac{250^2}{8}</m> square feet }
</p>
</li>
    <li>
<p>
 You want to build a pen with parallel fences across the      center which divide the large pen into <m>n</m> equally sized      internal pens. What is the largest area you can enclose?  If <m>w</m>      is the width and <m>l</m> is the length of the external pen what is      <m>\frac{w}{l}</m>. \solution{ <m>\frac{250^2}{2(n+1)}</m> square feet.  }
</p>
</li>
    </ol>

  </p>
</statement>
</task>
<task>
<statement>
<p>

    
<ol>
    <li>
<p>
 You want to use one side of a building as one full side of      your pen as shown in the sketch below. What is the largest area      you      can enclose? What are the dimensions of the pen? \solution{ <m>250^2/2</m> square feet }\\      \centerline{\includegraphics*[height=1.5in,width=2in]{../Figures/Corral1}}
</p>
</li>
    <li>
<p>
 You want to use one side of a building as one partial side      of your pen as shown in the sketch below. What is the largest      area you      can enclose? What are the dimensions of the pen?  \solution{ <m>250^2/2</m> square feet }\\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral7}}
</p>
</li>
    <li>
<p>
 You want to build your pen as shown in the sketch below.      What is the largest area you can enclose? What are the      dimensions of the pen?      \\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral3}}
</p>
</li>
    <li>
<p>
 You want to build your pen as shown in the      sketch below.     What is the largest area you can enclose? What are the dimensions of the pen?\\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral4}}
</p>
</li>
    <li>
<p>
 You want to your pen to be subdivided into three parts as      shown in the      sketch below.     What is the largest area you can enclose? What are the dimensions of the pen?\\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral5}}
</p>
</li>
    <li>
<p>
 You want to build your pen as shown in the      sketch below.     What is the largest area you can enclose? What are the dimensions of the pen?\\      \centerline{\includegraphics*[height=1.6in,width=2in]{../Figures/Corral6}}
</p>
</li>
    </ol>

  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem}[Variations on a Theme]  ;;; MULTILEVEL PROBLEM -->
<!--   You have <m>500</m> meters of fencing with which to build an animal pen. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item -->
    
<!-- <ol> -->
<!--     <li> -->
<!-- <p> -->
<!--  What is the largest area you can enclose with a freestanding      rectangular pen?  \solution{ <m>250^2/4</m> square feet } -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to build a pen with a fence across the center to      divide the large pen into two equally sized internal pens. What      is the largest area you can enclose?  \solution{ <m>(250^2/6</m>         square feet } -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to build a pen with two parallel fences across the      center to divide the large pen into three equally sized internal      pens. What is the largest area you can enclose?  \solution{        <m>\frac{250^2}{8}</m> square feet } -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to build a pen with parallel fences across the      center which divide the large pen into <m>n</m> equally sized      internal pens. What is the largest area you can enclose?  If <m>w</m>      is the width and <m>l</m> is the length of the external pen what is      <m>\frac{w}{l}</m>. \solution{ <m>\frac{250^2}{2(n+1)}</m> square feet.  } -->
<!-- </p> -->
<!-- </li> -->
<!--     </ol> -->

<!--   \item -->
    
<!-- <ol> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to use one side of a building as one full side of      your pen as shown in the sketch below. What is the largest area      you      can enclose? What are the dimensions of the pen? \solution{ <m>250^2/2</m> square feet }\\      \centerline{\includegraphics*[height=1.5in,width=2in]{../Figures/Corral1}} -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to use one side of a building as one partial side      of your pen as shown in the sketch below. What is the largest      area you      can enclose? What are the dimensions of the pen?  \solution{ <m>250^2/2</m> square feet }\\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral7}} -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to build your pen as shown in the sketch below.      What is the largest area you can enclose? What are the      dimensions of the pen?      \\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral3}} -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to build your pen as shown in the      sketch below.     What is the largest area you can enclose? What are the dimensions of the pen?\\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral4}} -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to your pen to be subdivided into three parts as      shown in the      sketch below.     What is the largest area you can enclose? What are the dimensions of the pen?\\      \centerline{\includegraphics*[height=1.2in,width=2in]{../Figures/Corral5}} -->
<!-- </p> -->
<!-- </li> -->
<!--     <li> -->
<!-- <p> -->
<!--  You want to build your pen as shown in the      sketch below.     What is the largest area you can enclose? What are the dimensions of the pen?\\      \centerline{\includegraphics*[height=1.6in,width=2in]{../Figures/Corral6}} -->
<!-- </p> -->
<!-- </li> -->
<!--     </ol> -->

<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->

<aside>
<title>Note to self</title>
<p>
multilevel problem missing here
</p>
</aside>

<!-- \begin{embeddedproblem}[Variations on a Theme]  ;;; MULTILEVEL PROBLEM -->
<!--   You have a piece of wire <m>100</m> inches long. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item You cut the wire into pieces.  Find the length of each piece -->
<!--     of the wire that yields the least total area bounded by the pieces -->
<!--     when: -->
<!--     \begin{enumerate}[label={  (\roman*)}] -->
<!--     \item You cut the wire into two pieces and bend each piece to form -->
<!--       a square. -->
<!--     \item You cut the wire into two pieces and bend each piece to form -->
<!--       a circle. -->
<!--     \item You cut the wire into two pieces and bend one piece to form -->
<!--       a square and the second to form a circle. -->
<!--     \item You cut the wire into two pieces and bend one piece to form -->
<!--       a rectangle with one side three times as long as the other. Then -->
<!--       bend the second piece to form a square. -->
<!--     \item You cut the wire into three pieces and two pieces are each -->
<!--       bent to form squares and the third is bent to form a circle. -->
<!--     \end{enumerate} -->
<!--   \item Repeat each problem in part (a), but this time find the length -->
<!--     of each piece of the wire that yields the most total area bounded -->
<!--     by the pieces. -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem} -->

<!-- <problem xml:id="no-label"> -->
<!-- <introduction> -->
<!-- <p> -->
<!--   \begin{wrapfigure}[]{r}{2.2in} -->
<!--     \vskip-10mm  \captionsetup{labelformat=empty} -->
<!--     \centerline{\includegraphics*[height=1.5in,width=2.2in]{../Figures/BillBoardProblem}} -->
<!--     \label{fig:BillBoardProblem} -->
<!--   \end{wrapfigure} Consider the side view of a person at point <m>P</m> -->
<!--   looking at a <m>20</m> foot tall billboard sign that is <m>10</m> feet off of -->
<!--   the ground as shown in the diagram below. -->
<!-- </p> -->
<!-- </introduction> -->
<!-- <task> -->
<!-- <statement> -->
<!-- <p> -->
<!--  Find a formula for the viewing angle <m>\theta</m> in terms of <m>x.</m> -->
<!--     Don't forget to put in the range for possible values for <m>x.</m> -->
<!--   </p> -->
<!-- </statement> -->
<!-- </task> -->
<!-- <task> -->
<!-- <statement> -->
<!-- <p> -->
<!--  Find the value of <m>x</m> that will maximize the viewing angle -->
<!--     <m>\theta</m>. -->
<!--   </p> -->
<!-- </statement> -->
<!-- </task> -->
<!-- </problem> -->
<!-- <!-\- \begin{embeddedproblem}  -\-> -->
<!-- <!-\-   \begin{wrapfigure}[]{r}{2.2in} -\-> -->
<!-- <!-\-     \vskip-10mm  \captionsetup{labelformat=empty} -\-> -->
<!-- <!-\-     \centerline{\includegraphics*[height=1.5in,width=2.2in]{../Figures/BillBoardProblem}} -\-> -->
<!-- <!-\-     \label{fig:BillBoardProblem} -\-> -->
<!-- <!-\-   \end{wrapfigure} Consider the side view of a person at point <m>P</m> -\-> -->
<!-- <!-\-   looking at a <m>20</m> foot tall billboard sign that is <m>10</m> feet off of -\-> -->
<!-- <!-\-   the ground as shown in the diagram below. -\-> -->
<!-- <!-\-   \begin{enumerate}[label={  (\alph*)}] -\-> -->
<!-- <!-\-   \item Find a formula for the viewing angle <m>\theta</m> in terms of <m>x.</m> -\-> -->
<!-- <!-\-     Don't forget to put in the range for possible values for <m>x.</m> -\-> -->
<!-- <!-\-   \item Find the value of <m>x</m> that will maximize the viewing angle -\-> -->
<!-- <!-\-     <m>\theta</m>. -\-> -->
<!-- <!-\-   \end{enumerate} -\-> -->
<!-- <!-\- \end{embeddedproblem} -\-> -->


<problem>
<statement>
<p>
  Find the value of <m>r</m> that maximizes the blue shaded area, <m>A(r)</m>,
  in the following
  diagram:
</p>

<image source="images/ArchimedPump1.png" width="60%" />
<!-- \centerline{\includegraphics*[height=1.2in,width=1.2in]{../Figures/ArchimedPump1}} -->

</statement>
</problem>


<problem>
<introduction>
<p>
</p>
</introduction>
<task>
<statement>
<p>
 The \term{strength} of a rectangular wooden beam is
    proportional to its width times the square of its height.  What is
    the ratio of the height to width of the strongest beam that can be
    cut from a cylindrical log?
  </p>
</statement>
</task>
<task>
<statement>
<p>
 The \term{stiffness} of a rectangular wooden beam is
    proportional to its width times the cube of its height.  What is
    the ratio of the height to width of the stiffest beam that can be
    cut from a cylindrical log?  Compare this to the answer in the
    previous problem.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 Suppose we have an objective function which is proportional to
    the width times the <m>n</m>th power of the height? What would the
    optimal ratio be now?
  </p>
</statement>
</task>
</problem>
<!-- \begin{embeddedproblem-enumerate}[(Variations on a theme)] -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item The \term{strength} of a rectangular wooden beam is -->
<!--     proportional to its width times the square of its height.  What is -->
<!--     the ratio of the height to width of the strongest beam that can be -->
<!--     cut from a cylindrical log? -->
<!--   \item The \term{stiffness} of a rectangular wooden beam is -->
<!--     proportional to its width times the cube of its height.  What is -->
<!--     the ratio of the height to width of the stiffest beam that can be -->
<!--     cut from a cylindrical log?  Compare this to the answer in the -->
<!--     previous problem. -->
<!--   \item Suppose we have an objective function which is proportional to -->
<!--     the width times the <m>n</m>th power of the height? What would the -->
<!--     optimal ratio be now? -->
<!--   \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->

<problem>
<statement>
<p>
  A box with a square base and an open top must have a volume
  of <m>32,000</m> square centimeters.\\
</p>
<image source="images/LidlessBox.png" width="60%" />
<!-- \centerline{\includegraphics*[height=1.1in,width=1in]{../Figures/LidlessBox}} -->
 
<p>
Find the dimensions of the box that minimize the amount of material
  used to make the box.
</p>
</statement>
</problem>



<problem xml:id="PROBLEMRodAroundACorner">
<introduction>
<p>
  \begin{wrapfigure}[5]{r}{2.5in}
    \vskip-10mm  \captionsetup{labelformat=empty}
    \centerline{\includegraphics*[height=1in,width=2.5in]{../Figures/RodRoundCorner5}}
    \label{fig:RodRoundCorner5}
  \end{wrapfigure}
  The diagram at the right depicts the view from above a pole of
  length <m>L</m> being maneuvered horizontally around the
  <m>90^\circ</m> corner of two hallways of widths <m>a</m>, and <m>b</m>.  Find the
  longest pole which can be turned around the corner.
</p>
</introduction>
<task>
<statement>
<p>
 Show that the maximum value of <m>L</m> is
    <m>\left(a^\frac23+b^\frac23\right)^\frac32</m>.
  </p>
</statement>
</task>
<task>
<statement>
<p>
 What would the maximum of <m>L</m> be in the special case where
    <m>a=b</m>?  Does this answer make sense geometrically?
  </p>
</statement>
</task>
<task>
<statement>
<p>
 In the problem statement we specified that the pole was being
    maneuvered horizontally, meaning that the pole is kept
    parallel to the ground at all times. Suppose we remove that
    constraint and that the height of the hallway is <m>h</m>. What is the
    longest pole we can get around the corner now?
  </p>
</statement>
</task>
</problem>
<!-- <!-\- \begin{embeddedproblem} -\-> -->
<!-- <!-\-   <!-\\- \label{problem:RodAroundACorner} -\\-> -\-> -->
<!-- <!-\-   \begin{wrapfigure}[5]{r}{2.5in} -\-> -->
<!-- <!-\-     \vskip-10mm  \captionsetup{labelformat=empty} -\-> -->
<!-- <!-\-     \centerline{\includegraphics*[height=1in,width=2.5in]{../Figures/RodRoundCorner5}} -\-> -->
<!-- <!-\-     \label{fig:RodRoundCorner5} -\-> -->
<!-- <!-\-   \end{wrapfigure} -\-> -->
<!-- <!-\-   The diagram at the right depicts the view from above a pole of -\-> -->
<!-- <!-\-   length <m>L</m> being maneuvered horizontally around the -\-> -->
<!-- <!-\-   <m>90^\circ</m> corner of two hallways of widths <m>a</m>, and <m>b</m>.  Find the -\-> -->
<!-- <!-\-   longest pole which can be turned around the corner. -\-> -->
<!-- <!-\-   \begin{enumerate}[label={  (\alph*)}] -\-> -->
<!-- <!-\-   \item Show that the maximum value of <m>L</m> is -\-> -->
<!-- <!-\-     <m>\left(a^\frac23+b^\frac23\right)^\frac32</m>. -\-> -->
<!-- <!-\-   \item What would the maximum of <m>L</m> be in the special case where -\-> -->
<!-- <!-\-     <m>a=b</m>?  Does this answer make sense geometrically? -\-> -->
<!-- <!-\-   \item In the problem statement we specified that the pole was being -\-> -->
<!-- <!-\-     maneuvered horizontally, meaning that the pole is kept -\-> -->
<!-- <!-\-     parallel to the ground at all times. Suppose we remove that -\-> -->
<!-- <!-\-     constraint and that the height of the hallway is <m>h</m>. What is the -\-> -->
<!-- <!-\-     longest pole we can get around the corner now? -\-> -->
<!-- <!-\-   \end{enumerate} -\-> -->
<!-- <!-\- </p> -->
<!-- </statement> -->
<!-- </problem> -->
<!--   Find the area of the smallest triangle formed by the <m>x</m> and <m>y</m> -->
<!--   axes and a line passing through the point <m>(2,1).</m> -->
<!-- \end{embeddedproblem-1line} -->

<aside>
<title>Note to self</title>
<p>
Missing Multilevel problem
</p>
</aside>

<!-- \begin{embeddedproblem-enumerate}[Variations on a Theme]  ;;; MULTILEVEL PROBLEM -->
<!--   <!-\- \label{problem:WitchTri1} -\-> -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item We draw the right triangle whose hypotenuse starts at the -->
<!--     origin, <m>(0,0)</m> and ends on the Witch of Agnesi, -->
<!--     <m>W(x)=\frac{1}{1+x^2}</m>.  The other legs are as shown in the figure -->
<!--     below:\\ -->
<!--             \centerline{\includegraphics*[height=2.1in,width=3.7in]{../Figures/MaxTri}} -->
<!--     Of all possible such triangles for which <m>\alpha</m> is in the -->
<!--     interval <m>[0,\infty)</m> which one has the largest area? -->
<!--   \item Now suppose that for each function given below a triangle is -->
<!--     constructed in the same manner used in part (a). Assume <m>a</m>, <m>b</m>, -->
<!--     <m>c</m>, and <m>k</m> are constants. Of all possible such triangles for -->
<!--     which <m>\alpha</m> is in the interval <m>[0,\infty)</m> which one has the -->
<!--     largest area? -->
<!--     \begin{enumerate}[label={  (\roman*)}] -->
<!--       \item <m>f(x) = \frac{k}{x^2+1}</m> -->
<!--       \item <m>f(x) = \frac{1}{x^2+3}</m> -->
<!--       \item <m>f(x) = \frac{1}{5x^2+1}</m> -->
<!--       \item <m>f(x) = \frac{a}{bx^2+c}</m> -->
<!--     \end{enumerate} -->
<!--               \end{enumerate} -->
<!-- \end{embeddedproblem-enumerate} -->

<aside>
<title>Note to self</title>
<p>
Missing Multilevel problem
</p>
</aside>

<!-- \begin{embeddedproblem}[Variations on a Theme] -->
<!--   <figure> -->
<!-- <caption> -->
<!-- <url href="https://en.wikipedia.org/wiki/Candela" visual="https://en.wikipedia.org/wiki/Candela">This figure needs a caption.</url> -->
<!-- </caption> -->
<!-- <image source="images/Birdfeeder.png" width="50%"/> -->
<!-- </figure> -->
<!-- <!-\- \begin{wrapfigure}[]{r}{3in} -\-> -->
<!-- <!-\-     \captionsetup{labelformat=empty} -\-> -->
<!-- <!-\-     \vskip-10mm  -\-> -->
<!-- <!-\-     \centerline{\includegraphics*[height=4in,width=3in]{../Figures/Birdfeeder}} -\-> -->
<!-- <!-\-     \label{fig:Birdfeeder} -\-> -->
<!-- <!-\-   \end{wrapfigure} -\-> -->
<!--   To prevent squirrels from eating her birdseed a -->
<!--   mathematician\footnote{This problem is adapted from -->
<!--     <pubtitle>Hanging a Bird feeder: Food for Thought</pubtitle>, by John -->
<!--     W. Dawson, Jr. <pubtitle>The College Mathematics Journal</pubtitle>, Mar., -->
<!--     1990, Vol. 21, No. 2, pp. 129-130} wants to hang a bird feeder so -->
<!--   that its top is <m>5</m> feet above the ground. To do this she attaches -->
<!--   each end of a wire between two trees at a height of <m>8</m> feet above -->
<!--   the ground, with the feeder hanging from a second wire, <m>x</m>, -->
<!--   attached at the midpoint of the first as seen in the sketch at the -->
<!--   right. -->
<!--   \begin{enumerate}[label={  (\alph*)}] -->
<!--   \item Find the value of <m>x</m> that requires the least amount of wire -->
<!--     if the trees are <m>10</m> feet apart. -->
<!--     \begin{enumerate}[label={  (\roman*)}] -->
<!--     \item What will the total length of the wire be? -->
<!--     \item Show that <m>\theta_1=\theta_2=\theta_3</m>. -->
<!--     \end{enumerate} -->
<!--   \item Find the value of <m>x</m> that requires the least amount of wire -->
<!--     if the trees are <m>12</m> feet apart. -->
<!--     \begin{enumerate}[label={  (\roman*)}] -->
<!--     \item What will the total length of the wire be? -->
<!--     \item Show also that <m>\theta_1=\theta_2=\theta_3</m>. -->
<!--     \end{enumerate} -->
<!--   \end{enumerate} -->
<!-- </p> -->
<!-- </statement> -->
<!-- </problem> -->

<!-- \begin{embeddedproblem} -->
<!--   \begin{wrapfigure}[10]{r}{2in} -->
<!--     \vskip-8mm  \captionsetup{labelformat=empty} -->
<!--     \centerline{\includegraphics*[height=1.7in,width=2in]{../Figures/IllumCandela}} -->
<!--     \label{fig:IllumCandela} -->
<!--   \end{wrapfigure} -->
<!--   Suppose we have a light source whose  intensity is <m>I</m> -->
<!--   \href{https://en.wikipedia.org/wiki/Candela}{candela} at a point <m>H</m> -->
<!--   meters above a surface, as seen in the sketch at the right.  Then -->
<!--   the illuminance (how brightly the surface is illuminated) <m>E</m> (in -->
<!--   \href{https://en.wikipedia.org/wiki/Lux}{lux}) at the point <m>P</m> on -->
<!--   the surface  is -->
<!--   given by the formula -->
<!--     <me> -->
<!--     E = \frac{I\cos(\theta)}{r^2} -->
<!--     </me> -->
<!--     where <m>r</m> is the distance from the light source to <m>P</m> and -->
<!--     <m>\theta</m> is the angle the ray of light makes with the line normal -->
<!--     to the surface\aside{The cosine allows for the fact that the -->
<!--       illuminance diminishes if the surface is tilted at an angle, -->
<!--       <m>\theta</m>, to the light source, even if the distance remains -->
<!--       fixed.\\ -->
<!--       We (the authors) found the presence of <m>\cos(\theta)</m> troubling -->
<!--       when we first encountered it. But this is the correct formula. -->
<!--       If you also find this troubling, think about the extreme case -->
<!--       where <m>\theta=\frac\pi2</m>. In this case the illuminance must be -->
<!--       zero (<m>=\cos(\pi/2)</m>) since the surface is then parallel to the -->
<!--       light beam}. -->
<!--     \begin{enumerate}[label={  (\alph*)}] -->
<!--     \item Find a formula for the illuminance at the point <m>P</m> -->
<!--              \begin{enumerate}[label={  (\roman*)}] -->
<!--         \begin{multicols}{2} -->
<!--          \item in terms -->
<!--       of <m>I</m>, <m>H</m>, and <m>x</m>, and -->
<!--     \item in terms -->
<!--       of <m>I</m>, <m>H</m>, and <m>r</m>. -->
<!--         \end{multicols} -->
<!--        \end{enumerate} -->
<!--      \item Consider two streetlamps, each with an intensity of -->
<!--        <m>I = 1300</m> candela mounted on <m>5</m> meter poles at -->
<!--        a distance of <m>15</m> meters apart.\\ -->
<!--        \centerline{\includegraphics*[height=1.7in,width=5in]{../Figures/Streetlights3}} -->
<!--        Find the approximate positions of the points between the light -->
<!--        poles where the illuminance <m>E</m> is minimimal and where it is -->
<!--        maximal.\\ -->
<!--        \comment{Recall from <xref ref="EXAMPLEexample:DiffvsDer"></xref> that you -->
<!--          have two choices here. (1) Use the constraints of the problem -->
<!--          to find a formula for the illuminance in terms of a single -->
<!--          variable and compute <m>\dfdx{E}{\xi}</m> where <m>\xi</m> is whichever -->
<!--          variable you chose to use. (2) Write down <m>E</m> and all of the -->
<!--          constraints, differentiate them, and rearrange the results to -->
<!--          form either <m>\dfdx{E}{x}=0</m> or <m>\dfdx{E}{y}=0</m> and solve for -->
<!--          <m>x</m> or <m>y</m>.\\ -->
<!--          We had you -->
<!--        find two different formulas in part (a) because one of them is -->
<!--        more helpful if you choose (1) and the other helps with choice -->
<!--        (2).} -->
<!--     \item You may have noticed in part (b) that the maximum -->
<!--       illuminance was near but not at either endpoint.  Show that, in -->
<!--       general, if the intensity is <m>I</m>, the height is <m>H</m> and the -->
<!--       distance between the poles is <m>L</m>, then -->
<!--       <m>\eval{\dfdx{E}{x}}{x}{0}\gt 0</m> and -->
<!--       <m>\eval{\dfdx{E}{x}}{x}{L}\lt 0</m> and use this to explain why the -->
<!--       maximum illuminance will never occur directly under one of the -->
<!--       streetlamps. -->
<!--     \item Use your favorite graphing tool and Newton's Method to -->
<!--       repeat this problem with three streetlamps <m>15</m> meters apart in -->
<!--       a straight line, with <m>I=1300</m>, and <m>H=5</m>. Approximately where -->
<!--       is the illuminance a maximum?  Approximately where is it -->
<!--       minimum? -->
<!--     \end{enumerate} -->
<!--   \end{embeddedproblem} -->




</subsection>
</section>
</chapter>
